<view class="container" data-theme="light">
  <!-- èˆªç©ºä¸»é¢˜åŠ¨ç”»èƒŒæ™¯ -->
  <view class="animated-bg">
    <view class="aviation-glow aviation-glow1"></view>
    <view class="aviation-glow aviation-glow2"></view>
    <view class="aviation-pulse"></view>
    <view class="radar-sweep"></view>
    <view class="floating-particles"></view>
  </view>

  <!-- è‹±é›„åŒºåŸŸ -->
  <view class="hero-section">
    <view class="hero-content">
      <view class="hero-icon">âœˆï¸</view>
      <view class="hero-title">ä¸ªäººæ£€æŸ¥å•</view>
      <view class="hero-subtitle">ä¸“ä¸šé£è¡Œæ£€æŸ¥æ¸…å•ç®¡ç†ç³»ç»Ÿ</view>
      <view class="hero-features">
        <view class="feature-item">
          <view class="feature-icon">ğŸ“‹</view>
          <text>æ™ºèƒ½ç®¡ç†</text>
        </view>
        <view class="feature-item">
          <view class="feature-icon">âš¡</view>
          <text>å¿«é€Ÿæ£€æŸ¥</text>
        </view>
        <view class="feature-item">
          <view class="feature-icon">ğŸ¯</view>
          <text>ç²¾ç¡®è¿½è¸ª</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
  <view class="main-content">
    <!-- ç»Ÿè®¡å¡ç‰‡ -->
    <view class="stats-card" wx:if="{{ checklists.length > 0 }}">
      <view class="stats-grid">
        <view class="stat-item completed">
          <view class="stat-icon">âœ…</view>
          <view class="stat-content">
            <view class="stat-number">{{ completedChecklistsCount }}</view>
            <view class="stat-label">å·²å®Œæˆ</view>
          </view>
        </view>
        <view class="stat-item progress">
          <view class="stat-icon">â³</view>
          <view class="stat-content">
            <view class="stat-number">{{ inProgressChecklistsCount }}</view>
            <view class="stat-label">è¿›è¡Œä¸­</view>
          </view>
        </view>
        <view class="stat-item total">
          <view class="stat-icon">ğŸ“Š</view>
          <view class="stat-content">
            <view class="stat-number">{{ checklists.length }}</view>
            <view class="stat-label">æ€»è®¡</view>
          </view>
        </view>
      </view>
    </view>

    <!-- æ£€æŸ¥å•ç½‘æ ¼ -->
    <view class="checklist-grid" wx:if="{{ checklists.length > 0 }}">
      <view 
        class="checklist-card {{ item.isCompleted ? 'completed' : 'in-progress' }}"
        wx:for="{{ checklists }}" 
        wx:key="id"
        bind:tap="openChecklist"
        data-id="{{ item.id }}"
      >
        <!-- å¡ç‰‡çŠ¶æ€æŒ‡ç¤ºå™¨ -->
        <view class="card-status-indicator"></view>
        
        <view class="card-header">
          <view class="card-title">{{ item.name }}</view>
          <view class="card-actions">
            <view 
              class="action-btn edit-btn"
              catch:tap="editChecklist"
              data-id="{{ item.id }}"
            >
              <view class="btn-icon">âœï¸</view>
            </view>
            <view 
              class="action-btn delete-btn"
              catch:tap="deleteChecklist"
              data-id="{{ item.id }}"
            >
              <view class="btn-icon">ğŸ—‘ï¸</view>
            </view>
          </view>
        </view>
        
        <view class="card-content">
          <!-- è¿›åº¦ç¯å½¢å›¾ -->
          <view class="progress-circle-container">
            <view class="progress-circle">
              <view class="circle-bg"></view>
              <view 
                class="circle-progress" 
                style="--progress: {{ item.progressPercentage || 0 }}%"
              ></view>
              <view class="circle-content">
                <view class="progress-percentage">{{ item.progressPercentage || 0 }}%</view>
                <view class="progress-label">å®Œæˆåº¦</view>
              </view>
            </view>
          </view>
          
          <!-- è¯¦ç»†è¿›åº¦ä¿¡æ¯ -->
          <view class="progress-details">
            <view class="progress-numbers">
              <view class="progress-current">{{ item.completedCount || 0 }}</view>
              <view class="progress-divider">/</view>
              <view class="progress-total">{{ item.items ? item.items.length : 0 }}</view>
            </view>
            <view class="progress-text">é¡¹ç›®å®Œæˆ</view>
            
            <view class="completion-badge {{ item.isCompleted ? 'completed' : 'in-progress' }}">
              <view class="badge-icon">{{ item.isCompleted ? 'âœ…' : 'â³' }}</view>
              <view class="badge-text">{{ item.isCompleted ? 'å·²å®Œæˆ' : 'è¿›è¡Œä¸­' }}</view>
            </view>
          </view>
        </view>
        
        <!-- æ‚¬æµ®æ“ä½œæŒ‰é’® -->
        <view class="card-quick-actions">
          <view class="quick-action-btn" catch:tap="openChecklist" data-id="{{ item.id }}">
            <view class="quick-action-icon">â–¶ï¸</view>
          </view>
        </view>
      </view>
    </view>

    <!-- åˆ›å»ºæ–°æ£€æŸ¥å•å¡ç‰‡ -->
    <view class="create-card" bind:tap="createCustomChecklist">
      <view class="create-card-bg"></view>
      <view class="create-content">
        <view class="create-icon-container">
          <view class="create-icon">â•</view>
          <view class="create-glow"></view>
        </view>
        <view class="create-text">
          <view class="create-title">åˆ›å»ºæ£€æŸ¥å•</view>
          <view class="create-subtitle">æ·»åŠ æ‚¨çš„ä¸“å±é£è¡Œæ£€æŸ¥æ¸…å•</view>
        </view>
      </view>
      <view class="create-particles">
        <view class="particle particle1"></view>
        <view class="particle particle2"></view>
        <view class="particle particle3"></view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{ checklists.length === 0 }}">
      <view class="empty-animation">
        <view class="empty-icon">ğŸ“‹</view>
        <view class="empty-pulse"></view>
      </view>
      <view class="empty-content">
        <view class="empty-title">å¼€å§‹æ‚¨çš„é£è¡Œæ£€æŸ¥</view>
        <view class="empty-description">åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªæ£€æŸ¥å•ï¼Œç¡®ä¿æ¯æ¬¡é£è¡Œçš„å®‰å…¨ä¸å‡†ç¡®</view>
      </view>
    </view>
  </view>

  <!-- æ£€æŸ¥å•è¯¦æƒ…å¼¹çª— -->
  <van-popup 
    show="{{ showChecklistDetail }}" 
    position="bottom" 
    round
    bind:close="closeChecklistDetail"
    custom-style="height: 85%; background: transparent;"
  >
    <view class="detail-container">
      <!-- è¯¦æƒ…å¤´éƒ¨ -->
      <view class="detail-header">
        <view class="detail-bg-animation"></view>
        <view class="header-content">
          <view class="header-top">
            <view class="detail-title">{{ currentChecklist.name }}</view>
            <view class="close-btn" bind:tap="closeChecklistDetail">
              <view class="close-icon">âœ•</view>
            </view>
          </view>
          
          <view class="progress-overview">
            <!-- å¤§å‹è¿›åº¦ç¯ -->
            <view class="large-progress-circle">
              <view class="large-circle-bg"></view>
              <view 
                class="large-circle-progress" 
                style="--progress: {{ currentChecklist.progressPercentage || 0 }}%"
              ></view>
              <view class="large-circle-content">
                <view class="large-progress-percentage">{{ currentChecklist.progressPercentage || 0 }}%</view>
                <view class="large-progress-label">å®Œæˆåº¦</view>
              </view>
            </view>
            
            <!-- ç»Ÿè®¡ä¿¡æ¯ -->
            <view class="progress-stats">
              <view class="stat-item">
                <view class="stat-number">{{ currentChecklist.completedCount || 0 }}</view>
                <view class="stat-label">å·²å®Œæˆ</view>
              </view>
              <view class="stat-divider"></view>
              <view class="stat-item">
                <view class="stat-number">{{ currentChecklist.items ? currentChecklist.items.length : 0 }}</view>
                <view class="stat-label">æ€»è®¡</view>
              </view>
            </view>
          </view>
          
          <!-- æ“ä½œæŒ‰é’® -->
          <view class="header-actions">
            <view class="header-action-btn" bind:tap="editCurrentChecklist">
              <view class="header-btn-icon">âœï¸</view>
              <view class="header-btn-text">ç¼–è¾‘</view>
            </view>
          </view>
        </view>
      </view>

      <!-- æ£€æŸ¥é¡¹ç›®åˆ—è¡¨ -->
      <view class="detail-content">
        <van-checkbox-group value="{{ checkedItems }}" bind:change="onCheckboxChange">
          <view class="items-list">
            <view 
              class="item-card {{ (checkedItems && checkedItems.includes(item.id)) ? 'completed' : '' }}"
              wx:for="{{ currentChecklist.items }}" 
              wx:key="id"
              bind:tap="toggleCheckbox"
              data-item-id="{{ item.id }}"
            >
              <view class="item-status-line"></view>
              
              <view class="item-checkbox">
                <van-checkbox 
                  name="{{ item.id }}" 
                  checked="{{ checkedItems && checkedItems.includes(item.id) }}"
                  disabled="{{ false }}"
                  shape="square"
                />
              </view>
              
              <view class="item-content">
                <view class="item-text">{{ item.text }}</view>
                <view class="item-completion" wx:if="{{ checkedItems && checkedItems.includes(item.id) }}">
                  <view class="completion-icon">âœ“</view>
                  <view class="completion-text">å·²å®Œæˆ</view>
                </view>
              </view>
              
              <view class="item-indicator {{ (checkedItems && checkedItems.includes(item.id)) ? 'checked' : '' }}">
                <view class="indicator-dot"></view>
              </view>
            </view>
          </view>
        </van-checkbox-group>
      </view>

      <!-- åº•éƒ¨æ“ä½œæ  -->
      <view class="detail-actions">
        <view class="detail-action-btn reset-btn" bind:tap="resetChecklist">
          <view class="detail-action-icon">ğŸ”„</view>
          <view class="detail-action-text">é‡ç½®æ£€æŸ¥å•</view>
        </view>
      </view>
    </view>
  </van-popup>

  <!-- æ–°å»º/ç¼–è¾‘æ£€æŸ¥å•å¼¹çª— -->
  <van-popup 
    show="{{ showEditDialog }}" 
    position="bottom" 
    round
    bind:close="closeEditDialog"
    custom-style="height: 85%; background: transparent;"
  >
    <view class="edit-container">
      <!-- ç¼–è¾‘å¤´éƒ¨ -->
      <view class="edit-header">
        <view class="edit-bg-animation"></view>
        <view class="edit-header-content">
          <view class="header-top">
            <view class="edit-title">
              {{ editMode === 'create' ? 'åˆ›å»ºæ£€æŸ¥å•' : 'ç¼–è¾‘æ£€æŸ¥å•' }}
            </view>
            <view class="close-btn" bind:tap="closeEditDialog">
              <view class="close-icon">âœ•</view>
            </view>
          </view>
        </view>
      </view>

      <!-- ç¼–è¾‘å†…å®¹ -->
      <view class="edit-content">
        <!-- åŸºæœ¬ä¿¡æ¯å¡ç‰‡ -->
        <view class="edit-card">
          <view class="edit-card-header">
            <view class="edit-card-icon">ğŸ“</view>
            <view class="edit-card-title">åŸºæœ¬ä¿¡æ¯</view>
          </view>
          <view class="edit-card-content">
            <van-field
              label="æ£€æŸ¥å•åç§°"
              placeholder="è¯·è¾“å…¥æ£€æŸ¥å•åç§°"
              value="{{ editingChecklist.name }}"
              bind:input="onNameChange"
              class="custom-field"
            />
          </view>
        </view>

        <!-- æ£€æŸ¥é¡¹ç›®å¡ç‰‡ -->
        <view class="edit-card">
          <view class="edit-card-header">
            <view class="edit-card-icon">ğŸ“‹</view>
            <view class="edit-card-title">æ£€æŸ¥é¡¹ç›®</view>
            <view class="item-count-badge">{{ editingChecklist.items.length }} é¡¹</view>
          </view>
          
          <!-- å¿«é€Ÿæ·»åŠ åŒºåŸŸ -->
          <view class="quick-add-section">
            <van-field
              placeholder="è¾“å…¥æ–°çš„æ£€æŸ¥é¡¹ç›®"
              value="{{ newItemText }}"
              bind:input="onNewItemChange"
              bind:confirm="addNewItem"
              confirm-type="done"
              class="quick-add-field"
              focus="{{ focusAddInput }}"
            >
              <view slot="button" class="add-btn" bind:tap="addNewItem">
                <view class="add-btn-icon">â•</view>
              </view>
            </van-field>
          </view>
          
          <!-- é¡¹ç›®åˆ—è¡¨ -->
          <view class="edit-items-list">
            <view 
              class="edit-item-card {{ editingItemIndex === index ? 'editing' : '' }}"
              wx:for="{{ editingChecklist.items }}" 
              wx:key="index"
              data-index="{{ index }}"
            >
              <view class="item-number">{{ index + 1 }}</view>
              
              <view class="item-edit-content">
                <van-field
                  wx:if="{{ editingItemIndex === index }}"
                  value="{{ editingItemText }}"
                  placeholder="è¯·è¾“å…¥é¡¹ç›®åç§°"
                  bind:input="onEditingItemTextChange"
                  bind:confirm="saveItemText"
                  bind:blur="cancelEditItem"
                  confirm-type="done"
                  focus="{{ true }}"
                  class="editing-field"
                />
                <view wx:else class="item-display" bind:tap="editItemText" data-index="{{ index }}">
                  <view class="item-text">{{ item.text }}</view>
                  <view class="edit-hint">ç‚¹å‡»ç¼–è¾‘</view>
                </view>
              </view>
              
              <view class="item-actions">
                <view class="item-action-btn move-btn" bind:tap="moveItemUp" data-index="{{ index }}" wx:if="{{ index > 0 }}">
                  <view class="action-icon">â†‘</view>
                </view>
                <view class="item-action-btn move-btn" bind:tap="moveItemDown" data-index="{{ index }}" wx:if="{{ index < editingChecklist.items.length - 1 }}">
                  <view class="action-icon">â†“</view>
                </view>
                <view class="item-action-btn delete-btn" bind:tap="deleteItem" data-index="{{ index }}">
                  <view class="action-icon">ğŸ—‘ï¸</view>
                </view>
              </view>
            </view>
          </view>
          
          <!-- ç©ºçŠ¶æ€ -->
          <view class="empty-items" wx:if="{{ editingChecklist.items.length === 0 }}">
            <view class="empty-items-icon">ğŸ“‹</view>
            <view class="empty-items-text">è¿˜æ²¡æœ‰æ£€æŸ¥é¡¹ç›®</view>
            <view class="empty-items-hint">åœ¨ä¸Šæ–¹è¾“å…¥æ¡†ä¸­æ·»åŠ æ‚¨çš„ç¬¬ä¸€ä¸ªæ£€æŸ¥é¡¹ç›®</view>
          </view>
        </view>
      </view>

      <!-- åº•éƒ¨æ“ä½œæ  -->
      <view class="edit-actions">
        <view class="edit-action-group">
          <view class="edit-action-btn primary-btn" bind:tap="saveChecklist">
            <view class="edit-action-icon">ğŸ’¾</view>
            <view class="edit-action-text">{{ editMode === 'create' ? 'åˆ›å»ºæ£€æŸ¥å•' : 'ä¿å­˜æ›´æ”¹' }}</view>
          </view>
          
          <view class="edit-action-btn secondary-btn" bind:tap="closeEditDialog">
            <view class="edit-action-icon">âŒ</view>
            <view class="edit-action-text">å–æ¶ˆ</view>
          </view>
        </view>
      </view>
    </view>
  </van-popup>

  <!-- Toast ç»„ä»¶ -->
  <van-toast id="van-toast" />
  
  <!-- Dialog ç»„ä»¶ -->
  <van-dialog id="van-dialog" />
</view>