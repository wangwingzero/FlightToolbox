<view class="container">
  <!-- æœºåœºä¿¡æ¯è¾“å…¥å¡ç‰‡ -->
  <view class="airport-input-card">
    <view class="card-header">
      <view class="header-left">
        <text class="emoji-icon">ğŸ¢</text>
        <text class="card-title">æœºåœºä¿¡æ¯</text>
      </view>
      <!-- æ—¶åŒºåˆ‡æ¢å™¨ï¼ˆç´§å‡‘å‹ï¼‰ -->
      <view class="timezone-switcher-compact" bind:tap="toggleTimeZone">
        <view class="timezone-toggle-compact {{ useBeijingTime ? 'beijing' : 'utc' }}">
          <view class="toggle-track-compact">
            <view class="toggle-thumb-compact"></view>
          </view>
        </view>
        <text class="timezone-text-compact">{{ useBeijingTime ? 'åŒ—äº¬æ—¶' : 'UTC' }}</text>
      </view>
    </view>
    <view class="input-section">
      <view class="input-wrapper">
        <input 
          class="airport-input"
          value="{{ icaoCode }}"
          placeholder="è¾“å…¥ICAO/IATAä»£ç æˆ–ä¸­æ–‡å"
          bindinput="onIcaoInput"
          maxlength="20"
          type="text"
          confirm-type="done"
        />
        <view class="input-clear" wx:if="{{ icaoCode }}" bind:tap="clearIcaoInput">
          <text class="emoji-icon small">âŒ</text>
        </view>
      </view>
      <view class="input-hint">æ”¯æŒICAO(ZSSS)ã€IATA(PVG)æˆ–ä¸­æ–‡(ä¸Šæµ·æµ¦ä¸œ)</view>
    </view>
    
    <!-- æ˜¾ç¤ºæŸ¥æ‰¾åˆ°çš„æœºåœºä¿¡æ¯ -->
    <view class="airport-info" wx:if="{{ airportInfo }}">
      <view class="info-item">
        <text class="info-label">æœºåœºåç§°</text>
        <text class="info-value">{{ airportInfo.name }}</text>
      </view>
      <view class="info-item">
        <text class="info-label">ICAO/IATA</text>
        <text class="info-value">{{ airportInfo.icaoCode }}{{ airportInfo.iataCode ? '/' + airportInfo.iataCode : '' }}</text>
      </view>
      <view class="info-item">
        <text class="info-label">åœ°åŒº</text>
        <text class="info-value">{{ airportInfo.countryName }}</text>
      </view>
      <view class="info-item">
        <text class="info-label">åæ ‡</text>
        <text class="info-value">{{ airportInfo.coordinateDisplay }}</text>
      </view>
    </view>
    
    <view class="date-selector" bind:tap="showDatePicker">
      <text class="date-label">æŸ¥è¯¢æ—¥æœŸ</text>
      <text class="date-value">{{ selectedDateStr || 'ç‚¹å‡»é€‰æ‹©æ—¥æœŸ' }}</text>
      <text class="emoji-icon small">ğŸ“…</text>
    </view>
  </view>

  <!-- æ—¥å‡ºæ—¥è½æŸ¥è¯¢ç»“æœå¡ç‰‡ -->
  <view class="results-card" wx:if="{{ sunResults }}">
    <view class="results-header">
      <text class="emoji-icon">ğŸŒ„</text>
      <text class="results-title">æ—¥å‡ºæ—¥è½æ—¶é—´</text>
    </view>
    
    <!-- åŸºæœ¬ä¿¡æ¯ç½‘æ ¼ -->
    <view class="basic-info-grid">
      <view class="info-item-card">
        <text class="info-card-label">æ—¥æœŸ</text>
        <text class="info-card-value">{{ sunResults.date }}</text>
      </view>
      <view class="info-item-card">
        <text class="info-card-label">æœºåœº</text>
        <text class="info-card-value">{{ sunResults.airport }}</text>
      </view>
      <view class="info-item-card">
        <text class="info-card-label">åœ°åŒº</text>
        <text class="info-card-value">{{ sunResults.country }}</text>
      </view>
      <view class="info-item-card">
        <text class="info-card-label">åæ ‡</text>
        <text class="info-card-value">{{ sunResults.coordinates }}</text>
      </view>
    </view>
    
    <!-- æ—¥å‡ºæ—¥è½æ—¶é—´ä¸»è¦ç»“æœ -->
    <view class="sun-times-main">
      <view class="sun-time-card sunrise">
        <view class="sun-icon">ğŸŒ…</view>
        <view class="sun-info">
          <text class="sun-title">æ—¥å‡ºæ—¶é—´</text>
          <text class="sun-time">{{ sunResults.sunrise }}</text>
          <text class="sun-subtitle">{{ useBeijingTime ? 'åŒ—äº¬æ—¶é—´' : 'UTCæ—¶é—´' }}</text>
        </view>
      </view>
      <view class="sun-time-card sunset">
        <view class="sun-icon">ğŸŒ‡</view>
        <view class="sun-info">
          <text class="sun-title">æ—¥è½æ—¶é—´</text>
          <text class="sun-time">{{ sunResults.sunset }}</text>
          <text class="sun-subtitle">{{ useBeijingTime ? 'åŒ—äº¬æ—¶é—´' : 'UTCæ—¶é—´' }}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æ¨ªå¹…å¹¿å‘Š -->
  <view class="ad-banner-container">
    <ad unit-id="adunit-3a1bf3800fa937a2" ad-type="banner" ad-intervals="30"></ad>
  </view>

  <!-- æ—¥æœŸé€‰æ‹©å™¨ -->
  <van-popup
    show="{{ showCalendar }}"
    bind:close="closeDatePicker"
    position="bottom"
    round="{{ true }}"
  >
    <van-datetime-picker
      type="date"
      value="{{ selectedDate.getTime() }}"
      min-date="{{ minDate }}"
      max-date="{{ maxDate }}"
      bind:confirm="selectDate"
      bind:cancel="closeDatePicker"
      title="é€‰æ‹©æ—¥æœŸ"
    />
  </van-popup>
</view> 