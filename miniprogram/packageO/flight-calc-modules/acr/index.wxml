<view class="container">
  <!-- åŠ¨ç”»èƒŒæ™¯ -->
  <view class="animated-bg">
    <view class="runway-light runway-light1"></view>
    <view class="runway-light runway-light2"></view>
    <view class="runway-light runway-light3"></view>
    <view class="aircraft-shadow"></view>
  </view>

  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="hero-section">
    <view class="hero-content">
      <view class="hero-icon">âœˆï¸</view>
      <view class="hero-title">ACRè®¡ç®—å™¨</view>
      <view class="hero-subtitle">èˆªç©ºå™¨åˆ†ç±»ç­‰çº§ä¸“ä¸šè®¡ç®—</view>
    </view>
  </view>

  <!-- æ­¥éª¤æŒ‡ç¤ºå™¨ -->
  <view class="step-indicator">
    <view class="step-item {{ currentStep >= 1 ? 'active' : '' }}" bind:tap="jumpToStep" data-step="1">
      <view class="step-number">1</view>
      <view class="step-label">åˆ¶é€ å•†</view>
    </view>
    <view class="step-line {{ currentStep > 1 ? 'active' : '' }}"></view>

    <view class="step-item {{ currentStep >= 2 ? 'active' : '' }}" bind:tap="jumpToStep" data-step="2">
      <view class="step-number">2</view>
      <view class="step-label">{{ showSeriesStep ? 'ç³»åˆ—/æœºå‹' : 'æœºå‹' }}</view>
    </view>
    <view class="step-line {{ currentStep > 2 ? 'active' : '' }}"></view>

    <view class="step-item {{ currentStep >= 3 ? 'active' : '' }}" bind:tap="jumpToStep" data-step="3">
      <view class="step-number">3</view>
      <view class="step-label">æ”¹å‹</view>
    </view>
    <view class="step-line {{ currentStep > 3 ? 'active' : '' }}"></view>

    <view class="step-item {{ currentStep >= 4 ? 'active' : '' }}" bind:tap="jumpToStep" data-step="4">
      <view class="step-number">4</view>
      <view class="step-label">é‡é‡</view>
    </view>
    <view class="step-line {{ currentStep > 4 ? 'active' : '' }}"></view>

    <view class="step-item {{ currentStep >= 5 ? 'active' : '' }}" bind:tap="jumpToStep" data-step="5">
      <view class="step-number">5</view>
      <view class="step-label">å‚æ•°&ç»“æœ</view>
    </view>
  </view>

  <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
  <view class="main-content">

    <!-- æ­¥éª¤1ï¼šé€‰æ‹©åˆ¶é€ å•† -->
    <view wx:if="{{ currentStep === 1 }}" class="step-card">
      <view class="card-header">
        <view class="card-title">ğŸ­ é€‰æ‹©åˆ¶é€ å•†</view>
        <view class="card-desc">{{ dataLoaded ? 'è¯·é€‰æ‹©é£æœºåˆ¶é€ å•†' : 'æ•°æ®åŠ è½½ä¸­...' }}</view>
      </view>
      <view class="manufacturer-grid">
        <view
          class="manufacturer-item {{ selectedManufacturer === 'Airbus' ? 'selected' : '' }} {{ !dataLoaded ? 'disabled' : '' }}"
          bind:tap="selectManufacturer"
          data-manufacturer="Airbus"
        >
          <view class="mfr-icon airbus">A</view>
          <view class="mfr-name">Airbus</view>
          <view class="mfr-desc">ç©ºä¸­å®¢è½¦</view>
        </view>

        <view
          class="manufacturer-item {{ selectedManufacturer === 'Boeing' ? 'selected' : '' }} {{ !dataLoaded ? 'disabled' : '' }}"
          bind:tap="selectManufacturer"
          data-manufacturer="Boeing"
        >
          <view class="mfr-icon boeing">B</view>
          <view class="mfr-name">Boeing</view>
          <view class="mfr-desc">æ³¢éŸ³å…¬å¸</view>
        </view>

        <view
          class="manufacturer-item {{ selectedManufacturer === 'COMAC' ? 'selected' : '' }} {{ !dataLoaded ? 'disabled' : '' }}"
          bind:tap="selectManufacturer"
          data-manufacturer="COMAC"
        >
          <view class="mfr-icon comac">C</view>
          <view class="mfr-name">COMAC</view>
          <view class="mfr-desc">ä¸­å›½å•†é£</view>
        </view>

        <view
          class="manufacturer-item {{ selectedManufacturer === 'Others' ? 'selected' : '' }} {{ !dataLoaded ? 'disabled' : '' }}"
          bind:tap="selectManufacturer"
          data-manufacturer="Others"
        >
          <view class="mfr-icon others">O</view>
          <view class="mfr-name">Others</view>
          <view class="mfr-desc">å…¶ä»–åˆ¶é€ å•†</view>
        </view>
      </view>
    </view>

    <!-- æ­¥éª¤2ï¼šé€‰æ‹©ç³»åˆ—ï¼ˆå¦‚æœéœ€è¦ï¼‰ -->
    <view wx:if="{{ currentStep === 2 && showSeriesStep && seriesList.length > 0 }}" class="step-card" id="series-card">
      <view class="card-header">
        <view class="card-title">ğŸ“‹ é€‰æ‹©ç³»åˆ—</view>
        <view class="card-desc">{{ selectedManufacturer }} ç³»åˆ—åˆ—è¡¨</view>
      </view>
      <view class="series-list">
        <view
          wx:for="{{ seriesList }}"
          wx:key="*this"
          class="series-item {{ selectedSeries === item ? 'selected' : '' }}"
          bind:tap="selectSeries"
          data-series="{{ item }}"
        >
          <view class="series-icon">ğŸ“</view>
          <view class="series-name">{{ item }}</view>
        </view>
      </view>
    </view>

    <!-- æ­¥éª¤2ï¼šé€‰æ‹©æœºå‹ -->
    <view wx:if="{{ currentStep === 2 && modelList.length > 0 && (!showSeriesStep || selectedSeries) }}" class="step-card" id="model-card">
      <view class="card-header">
        <view class="card-title">âœˆï¸ é€‰æ‹©æœºå‹</view>
        <view class="card-desc">{{ selectedSeries || selectedManufacturer }} æœºå‹åˆ—è¡¨</view>
      </view>
      <view class="model-list">
        <view
          wx:for="{{ modelList }}"
          wx:key="*this"
          class="model-item {{ selectedModel === item ? 'selected' : '' }}"
          bind:tap="selectModel"
          data-model="{{ item }}"
        >
          <view class="model-icon">âœˆï¸</view>
          <view class="model-name">{{ item }}</view>
        </view>
      </view>
    </view>

    <!-- æ­¥éª¤3ï¼šé€‰æ‹©æ”¹å‹ -->
    <view wx:if="{{ currentStep === 3 }}" class="step-card" id="variant-card">
      <view class="card-header">
        <view class="card-title">ğŸ”§ é€‰æ‹©æ”¹å‹</view>
        <view class="card-desc">{{ selectedModel }} æ”¹å‹åˆ—è¡¨</view>
      </view>
      <view class="variant-list">
        <view
          wx:for="{{ variantList }}"
          wx:key="name"
          class="variant-item {{ selectedVariant === item.name ? 'selected' : '' }}"
          bind:tap="selectVariant"
          data-variant="{{ item.name }}"
        >
          <view class="variant-icon">âš™ï¸</view>
          <view class="variant-name">{{ item.display }}</view>
        </view>
      </view>
    </view>

    <!-- æ­¥éª¤4ï¼šè¾“å…¥é‡é‡ -->
    <view wx:if="{{ currentStep === 4 }}" class="step-card" id="weight-card">
      <view class="card-header">
        <view class="card-title">âš–ï¸ é£æœºé‡é‡</view>
        <view class="card-desc">{{ selectedVariant }}</view>
      </view>
      <view class="weight-input">
        <view class="input-label">é£æœºé‡é‡ (kg)</view>
        <view class="weight-range-hint">{{ massRange.min }} kg - {{ massRange.max }} kg</view>
        <van-field
          model:value="{{ aircraftMass }}"
          placeholder="è¯·è¾“å…¥é£æœºé‡é‡"
          type="digit"
          bind:change="onMassInput"
          input-align="center"
          class="custom-input"
        />
      </view>
      <view class="nav-buttons">
        <view class="nav-btn secondary" bind:tap="prevStep">â¬…ï¸ ä¸Šä¸€æ­¥</view>
        <view class="nav-btn primary" bind:tap="nextStep">ä¸‹ä¸€æ­¥ â¡ï¸</view>
      </view>
    </view>

    <!-- æ­¥éª¤5ï¼šå‚æ•°é€‰æ‹©å’ŒACRç»“æœ -->
    <view wx:if="{{ currentStep === 5 }}" class="step-card" id="params-card">
      <view class="card-header">
        <view class="card-title">ğŸ“Š é€‰æ‹©å‚æ•°å¹¶æŸ¥çœ‹ACR</view>
        <view class="card-desc">{{ selectedModel }} - {{ selectedVariant }}</view>
      </view>

      <!-- å‚æ•°é€‰æ‹©åŒºåŸŸ -->
      <view class="params-section">
        <!-- é“é¢ç±»å‹ -->
        <view class="param-group">
          <view class="param-label">ğŸ›£ï¸ é“é¢ç±»å‹</view>
          <view class="param-options">
            <view
              class="param-btn {{ pavementType === 'F' ? 'selected' : '' }}"
              bind:tap="onPavementTypeSelect"
              data-value="F"
            >
              <view class="btn-icon">F</view>
              <view class="btn-text">æŸ”æ€§é“é¢</view>
            </view>
            <view
              class="param-btn {{ pavementType === 'R' ? 'selected' : '' }}"
              bind:tap="onPavementTypeSelect"
              data-value="R"
            >
              <view class="btn-icon">R</view>
              <view class="btn-text">åˆšæ€§é“é¢</view>
            </view>
          </view>
        </view>

        <!-- é“åŸºå¼ºåº¦ -->
        <view class="param-group">
          <view class="param-label">ğŸ—ï¸ é“åŸºå¼ºåº¦</view>
          <view class="param-options grid">
            <view
              class="param-btn small {{ subgradeStrength === 'A' ? 'selected' : '' }}"
              bind:tap="onSubgradeStrengthSelect"
              data-value="A"
            >
              <view class="btn-icon">A</view>
              <view class="btn-text">é«˜å¼ºåº¦</view>
            </view>
            <view
              class="param-btn small {{ subgradeStrength === 'B' ? 'selected' : '' }}"
              bind:tap="onSubgradeStrengthSelect"
              data-value="B"
            >
              <view class="btn-icon">B</view>
              <view class="btn-text">ä¸­å¼ºåº¦</view>
            </view>
            <view
              class="param-btn small {{ subgradeStrength === 'C' ? 'selected' : '' }}"
              bind:tap="onSubgradeStrengthSelect"
              data-value="C"
            >
              <view class="btn-icon">C</view>
              <view class="btn-text">ä½å¼ºåº¦</view>
            </view>
            <view
              class="param-btn small {{ subgradeStrength === 'D' ? 'selected' : '' }}"
              bind:tap="onSubgradeStrengthSelect"
              data-value="D"
            >
              <view class="btn-icon">D</view>
              <view class="btn-text">è¶…ä½å¼ºåº¦</view>
            </view>
          </view>
        </view>

        <!-- èƒå‹é™åˆ¶ -->
        <view class="param-group">
          <view class="param-label">ğŸ› èƒå‹é™åˆ¶</view>
          <view class="param-options grid">
            <view
              class="param-btn small {{ tirePressure === 'W' ? 'selected' : '' }}"
              bind:tap="onTirePressureSelect"
              data-value="W"
            >
              <view class="btn-icon">W</view>
              <view class="btn-text">æ— é™åˆ¶</view>
            </view>
            <view
              class="param-btn small {{ tirePressure === 'X' ? 'selected' : '' }}"
              bind:tap="onTirePressureSelect"
              data-value="X"
            >
              <view class="btn-icon">X</view>
              <view class="btn-text">é«˜å‹é™åˆ¶</view>
            </view>
            <view
              class="param-btn small {{ tirePressure === 'Y' ? 'selected' : '' }}"
              bind:tap="onTirePressureSelect"
              data-value="Y"
            >
              <view class="btn-icon">Y</view>
              <view class="btn-text">ä¸­å‹é™åˆ¶</view>
            </view>
            <view
              class="param-btn small {{ tirePressure === 'Z' ? 'selected' : '' }}"
              bind:tap="onTirePressureSelect"
              data-value="Z"
            >
              <view class="btn-icon">Z</view>
              <view class="btn-text">ä½å‹é™åˆ¶</view>
            </view>
          </view>
        </view>

        <!-- è¯„ä¼°æ–¹æ³• -->
        <view class="param-group">
          <view class="param-label">ğŸ” è¯„ä¼°æ–¹æ³•</view>
          <view class="param-options">
            <view
              class="param-btn {{ evaluationMethod === 'T' ? 'selected' : '' }}"
              bind:tap="onEvaluationMethodSelect"
              data-value="T"
            >
              <view class="btn-icon">T</view>
              <view class="btn-text">æŠ€æœ¯è¯„ä¼°</view>
            </view>
            <view
              class="param-btn {{ evaluationMethod === 'U' ? 'selected' : '' }}"
              bind:tap="onEvaluationMethodSelect"
              data-value="U"
            >
              <view class="btn-icon">U</view>
              <view class="btn-text">ä½¿ç”¨ç»éªŒ</view>
            </view>
          </view>
        </view>
      </view>

      <!-- ACRç»“æœæ˜¾ç¤º -->
      <view wx:if="{{ acrValue !== null }}" class="acr-result">
        <view class="result-header">
          <view class="result-icon">ğŸ“</view>
          <view class="result-label">ACRå€¼</view>
        </view>
        <view class="result-value">{{ acrValue }}</view>
        <view class="result-info">
          <text>é£æœºé‡é‡: {{ aircraftMass }} kg</text>
          <text>é“é¢ç±»å‹: {{ pavementType === 'F' ? 'æŸ”æ€§' : 'åˆšæ€§' }}</text>
          <text>é“åŸºå¼ºåº¦: {{ subgradeStrength }}</text>
        </view>
      </view>

      <!-- æŒ‰é’® -->
      <view class="nav-buttons">
        <view class="nav-btn secondary" bind:tap="prevStep">â¬…ï¸ ä¸Šä¸€æ­¥</view>
        <view class="nav-btn restart" bind:tap="restart">ğŸ”„ é‡æ–°å¼€å§‹</view>
      </view>
    </view>

  </view>
</view>
