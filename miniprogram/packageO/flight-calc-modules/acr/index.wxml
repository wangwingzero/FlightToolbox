<view class="container">
  <!-- é“é¢æ‰¿è½½ä¸»é¢˜åŠ¨ç”»èƒŒæ™¯ -->
  <view class="animated-bg">
    <view class="runway-light runway-light1"></view>
    <view class="runway-light runway-light2"></view>
    <view class="runway-light runway-light3"></view>
    <view class="aircraft-shadow"></view>
    <view class="bearing-indicator"></view>
  </view>

  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="hero-section">
    <view class="hero-content">
      <view class="hero-icon">ğŸ›¬</view>
      <view class="hero-title">ACR-PCRåˆ†æ</view>
      <view class="hero-subtitle">èˆªç©ºå™¨é“é¢æ‰¿è½½èƒ½åŠ›ä¸“ä¸šè¯„ä¼°</view>
      <view class="hero-features">
        <view class="feature-item">
          <view class="feature-icon">âœˆï¸</view>
          <text>å¤šæœºå‹</text>
        </view>
        <view class="feature-item">
          <view class="feature-icon">ğŸ›£ï¸</view>
          <text>é“é¢åˆ†æ</text>
        </view>
        <view class="feature-item">
          <view class="feature-icon">âš–ï¸</view>
          <text>æ‰¿è½½è¯„ä¼°</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æ­¥éª¤æŒ‡ç¤ºå™¨ -->
  <view class="step-indicator">
    <view class="step-item {{ currentStep >= 1 ? 'active' : '' }} {{ currentStep > 1 ? 'completed' : '' }}">
      <view class="step-number">1</view>
      <view class="step-label">åˆ¶é€ å•†</view>
    </view>
    <view class="step-line {{ currentStep > 1 ? 'completed' : '' }}"></view>
    <view class="step-item {{ currentStep >= 2 ? 'active' : '' }} {{ currentStep > 2 ? 'completed' : '' }}">
      <view class="step-number">2</view>
      <view class="step-label">æœºå‹</view>
    </view>
    <view class="step-line {{ currentStep > 2 ? 'completed' : '' }}"></view>
    <view class="step-item {{ currentStep >= 3 ? 'active' : '' }} {{ currentStep > 3 ? 'completed' : '' }}">
      <view class="step-number">3</view>
      <view class="step-label">æ”¹å‹</view>
    </view>
    <view class="step-line {{ currentStep > 3 ? 'completed' : '' }}"></view>
    <view class="step-item {{ currentStep >= 4 ? 'active' : '' }} {{ currentStep > 4 ? 'completed' : '' }}">
      <view class="step-number">4</view>
      <view class="step-label">é‡é‡</view>
    </view>
    <view class="step-line {{ currentStep > 4 ? 'completed' : '' }}"></view>
    <view class="step-item {{ currentStep >= 5 ? 'active' : '' }} {{ currentStep > 5 ? 'completed' : '' }}">
      <view class="step-number">5</view>
      <view class="step-label">PCRå‚æ•°</view>
    </view>
  </view>

  <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
  <view class="main-content">
    <!-- æ­¥éª¤1ï¼šé€‰æ‹©åˆ¶é€ å•† -->
    <view wx:if="{{ currentStep === 1 }}" class="step-card">
      <view class="card-header">
        <view class="card-title">ğŸ­ é€‰æ‹©åˆ¶é€ å•†</view>
        <view class="card-desc">é€‰æ‹©é£æœºåˆ¶é€ å•†</view>
      </view>
      <view class="manufacturer-selector">
        <view 
          class="manufacturer-option {{ acr.selectedManufacturer === 'Airbus' ? 'selected' : '' }}"
          bind:tap="selectManufacturer"
          data-manufacturer="Airbus"
        >
          <view class="manufacturer-icon airbus">A</view>
          <view class="manufacturer-info">
            <view class="manufacturer-name">Airbus</view>
            <view class="manufacturer-desc">ç©ºä¸­å®¢è½¦é›†å›¢</view>
          </view>
        </view>
        
        <view 
          class="manufacturer-option {{ acr.selectedManufacturer === 'Boeing' ? 'selected' : '' }}"
          bind:tap="selectManufacturer"
          data-manufacturer="Boeing"
        >
          <view class="manufacturer-icon boeing">B</view>
          <view class="manufacturer-info">
            <view class="manufacturer-name">Boeing</view>
            <view class="manufacturer-desc">æ³¢éŸ³å…¬å¸</view>
          </view>
        </view>

        <view 
          class="manufacturer-option {{ acr.selectedManufacturer === 'COMAC' ? 'selected' : '' }}"
          bind:tap="selectManufacturer"
          data-manufacturer="COMAC"
        >
          <view class="manufacturer-icon comac">C</view>
          <view class="manufacturer-info">
            <view class="manufacturer-name">COMAC</view>
            <view class="manufacturer-desc">ä¸­å›½å•†ç”¨é£æœº</view>
          </view>
        </view>

        <view 
          class="manufacturer-option {{ acr.selectedManufacturer === 'Others' ? 'selected' : '' }}"
          bind:tap="selectManufacturer"
          data-manufacturer="Others"
        >
          <view class="manufacturer-icon others">O</view>
          <view class="manufacturer-info">
            <view class="manufacturer-name">Others</view>
            <view class="manufacturer-desc">å…¶ä»–åˆ¶é€ å•†</view>
          </view>
        </view>
      </view>
    </view>

    <!-- æ­¥éª¤2ï¼šé€‰æ‹©æœºå‹ -->
    <view wx:if="{{ currentStep === 2 }}" class="step-card">
      <view class="card-header">
        <view class="card-title">âœˆï¸ é€‰æ‹©æœºå‹</view>
        <view class="card-desc">{{ acr.selectedManufacturer }} æœºå‹åˆ—è¡¨</view>
      </view>
      <view class="model-selector">
        <view 
          wx:for="{{ acrModelActions }}" 
          wx:key="value"
          class="model-option {{ acr.selectedModel === item.value ? 'selected' : '' }}"
          bind:tap="selectModel"
          data-model="{{ item.value }}"
        >
          <view class="model-icon">{{ item.value }}</view>
          <view class="model-name">{{ item.name }}</view>
        </view>
      </view>
    </view>

    <!-- æ­¥éª¤3ï¼šé€‰æ‹©æ”¹å‹ -->
    <view wx:if="{{ currentStep === 3 }}" class="step-card">
      <view class="card-header">
        <view class="card-title">ğŸ”§ é€‰æ‹©æ”¹å‹</view>
        <view class="card-desc">{{ acr.selectedModel }} æ”¹å‹åˆ—è¡¨</view>
      </view>
      <view class="variant-selector">
        <view 
          wx:for="{{ acrVariantActions }}" 
          wx:key="value"
          class="variant-option {{ acr.selectedVariant === item.value ? 'selected' : '' }}"
          bind:tap="selectVariant"
          data-variant="{{ item.value }}"
          data-display="{{ item.name }}"
        >
          <view class="variant-info">
            <view class="variant-name">{{ item.name }}</view>
          </view>
        </view>
      </view>
    </view>

    <!-- æ­¥éª¤4ï¼šè¾“å…¥é‡é‡ -->
    <view wx:if="{{ currentStep === 4 }}" class="step-card">
      <view class="card-header">
        <view class="card-title">âš–ï¸ é£æœºé‡é‡</view>
        <view class="card-desc">{{ acr.selectedVariantDisplay }}</view>
      </view>
      <view class="weight-input">
        <view class="input-header">
          <view class="input-icon weight-icon">âš–ï¸</view>
          <view class="input-info">
            <text class="input-label">{{ acr.massDisplayLabel }}</text>
            <text class="input-unit">åƒå…‹ (kg)</text>
          </view>
        </view>
        <van-field
          value="{{ acr.aircraftMass }}"
          placeholder="{{ acr.massInputEnabled ? 'è¯·è¾“å…¥é£æœºé‡é‡' : 'è‡ªåŠ¨è®¾ç½®' }}"
          type="digit"
          bind:change="onAcrAircraftMassChange"
          disabled="{{ !acr.massInputEnabled }}"
          input-align="center"
          class="custom-input"
        />
      </view>
    </view>

    <!-- æ­¥éª¤5ï¼šPCRå‚æ•° -->
    <view wx:if="{{ currentStep === 5 }}" class="step-card">
      <view class="card-header">
        <view class="card-title">ğŸ“Š PCRå‚æ•°</view>
        <view class="card-desc">é“é¢æ‰¿è½½å‚æ•°è®¾ç½®</view>
      </view>
      <!-- PCRä»£ç é¢„è§ˆ -->
      <view class="pcr-preview">
        <view class="preview-header">
          <view class="preview-icon">ğŸ“‹</view>
          <view class="preview-title">PCRä»£ç é¢„è§ˆ</view>
        </view>
        <view class="preview-code">
          <text class="code-segment pcr-num">{{ acr.pcrNumber || '___' }}</text>
          <text class="code-separator">/</text>
          <text class="code-segment pavement">{{ acr.pavementType || '_' }}</text>
          <text class="code-separator">/</text>
          <text class="code-segment strength">{{ acr.subgradeStrength || '_' }}</text>
          <text class="code-separator">/</text>
          <text class="code-segment tire">{{ acr.tirePressure || '_' }}</text>
          <text class="code-separator">/</text>
          <text class="code-segment method">{{ acr.evaluationMethod || '_' }}</text>
        </view>
        <view class="preview-example">ç¤ºä¾‹: 720/R/A/W/T</view>
      </view>

      <view class="pcr-params">
        <view class="param-group">
          <view class="param-header">
            <view class="param-icon pcr-icon">ğŸ“Š</view>
            <text class="param-label">PCRæ•°å€¼</text>
          </view>
          <van-field
            value="{{ acr.pcrNumber }}"
            placeholder="è¯·è¾“å…¥PCRæ•°å€¼"
            type="digit"
            bind:change="onAcrPcrNumberChange"
            input-align="center"
            class="custom-input"
          />
        </view>

        <view class="param-group">
          <view class="param-header">
            <view class="param-icon pavement-icon">ğŸ›£ï¸</view>
            <text class="param-label">é“é¢ç±»å‹</text>
          </view>
          <view class="param-selector">
            <view 
              class="param-option {{ acr.pavementType === 'F' ? 'selected' : '' }}"
              bind:tap="onAcrPavementTypeSelect"
              data-value="F"
            >
              <view class="option-icon">F</view>
              <view class="option-text">æŸ”æ€§é“é¢</view>
            </view>
            <view 
              class="param-option {{ acr.pavementType === 'R' ? 'selected' : '' }}"
              bind:tap="onAcrPavementTypeSelect"
              data-value="R"
            >
              <view class="option-icon">R</view>
              <view class="option-text">åˆšæ€§é“é¢</view>
            </view>
          </view>
        </view>

        <view class="param-group">
          <view class="param-header">
            <view class="param-icon strength-icon">ğŸ—ï¸</view>
            <text class="param-label">é“åŸºå¼ºåº¦</text>
          </view>
          <view class="param-selector grid">
            <view 
              class="param-option {{ acr.subgradeStrength === 'A' ? 'selected' : '' }}"
              bind:tap="onAcrSubgradeStrengthSelect"
              data-value="A"
            >
              <view class="option-icon">A</view>
              <view class="option-text">é«˜å¼ºåº¦</view>
            </view>
            <view 
              class="param-option {{ acr.subgradeStrength === 'B' ? 'selected' : '' }}"
              bind:tap="onAcrSubgradeStrengthSelect"
              data-value="B"
            >
              <view class="option-icon">B</view>
              <view class="option-text">ä¸­å¼ºåº¦</view>
            </view>
            <view 
              class="param-option {{ acr.subgradeStrength === 'C' ? 'selected' : '' }}"
              bind:tap="onAcrSubgradeStrengthSelect"
              data-value="C"
            >
              <view class="option-icon">C</view>
              <view class="option-text">ä½å¼ºåº¦</view>
            </view>
            <view 
              class="param-option {{ acr.subgradeStrength === 'D' ? 'selected' : '' }}"
              bind:tap="onAcrSubgradeStrengthSelect"
              data-value="D"
            >
              <view class="option-icon">D</view>
              <view class="option-text">è¶…ä½å¼ºåº¦</view>
            </view>
          </view>
        </view>

        <view class="param-group">
          <view class="param-header">
            <view class="param-icon tire-icon">ğŸ›</view>
            <text class="param-label">èƒå‹é™åˆ¶</text>
          </view>
          <view class="param-selector grid">
            <view 
              class="param-option {{ acr.tirePressure === 'W' ? 'selected' : '' }}"
              bind:tap="onAcrTirePressureSelect"
              data-value="W"
            >
              <view class="option-icon">W</view>
              <view class="option-text">æ— é™åˆ¶</view>
            </view>
            <view 
              class="param-option {{ acr.tirePressure === 'X' ? 'selected' : '' }}"
              bind:tap="onAcrTirePressureSelect"
              data-value="X"
            >
              <view class="option-icon">X</view>
              <view class="option-text">é«˜å‹é™åˆ¶</view>
            </view>
            <view 
              class="param-option {{ acr.tirePressure === 'Y' ? 'selected' : '' }}"
              bind:tap="onAcrTirePressureSelect"
              data-value="Y"
            >
              <view class="option-icon">Y</view>
              <view class="option-text">ä¸­å‹é™åˆ¶</view>
            </view>
            <view 
              class="param-option {{ acr.tirePressure === 'Z' ? 'selected' : '' }}"
              bind:tap="onAcrTirePressureSelect"
              data-value="Z"
            >
              <view class="option-icon">Z</view>
              <view class="option-text">ä½å‹é™åˆ¶</view>
            </view>
          </view>
        </view>

        <view class="param-group">
          <view class="param-header">
            <view class="param-icon eval-icon">ğŸ”</view>
            <text class="param-label">è¯„ä¼°æ–¹æ³•</text>
          </view>
          <view class="param-selector">
            <view 
              class="param-option {{ acr.evaluationMethod === 'T' ? 'selected' : '' }}"
              bind:tap="onAcrEvaluationMethodSelect"
              data-value="T"
            >
              <view class="option-icon">T</view>
              <view class="option-text">æŠ€æœ¯è¯„ä¼°</view>
            </view>
            <view 
              class="param-option {{ acr.evaluationMethod === 'U' ? 'selected' : '' }}"
              bind:tap="onAcrEvaluationMethodSelect"
              data-value="U"
            >
              <view class="option-icon">U</view>
              <view class="option-text">ä½¿ç”¨ç»éªŒ</view>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- å¯¼èˆªæŒ‰é’® -->
    <view wx:if="{{ currentStep < 6 }}" class="navigation-section">
      <view wx:if="{{ currentStep > 1 }}" class="nav-button secondary" bind:tap="prevStep">
        <view class="nav-icon">â¬…ï¸</view>
        <view class="nav-text">ä¸Šä¸€æ­¥</view>
      </view>
      <view class="nav-button primary" bind:tap="nextStep">
        <view class="nav-text">{{ currentStep === 5 ? 'å¼€å§‹åˆ†æ' : 'ä¸‹ä¸€æ­¥' }}</view>
        <view class="nav-icon">{{ currentStep === 5 ? 'ğŸ”' : 'â¡ï¸' }}</view>
      </view>
    </view>

    <!-- è®¡ç®—ç»“æœ -->
    <view wx:if="{{ acr.result && currentStep === 6 }}" class="result-card">
      <view class="result-header">
        <view class="result-status {{ acr.result.canOperate ? 'safe' : 'warning' }}">
          <view class="status-icon">{{ acr.result.canOperate ? 'âœ…' : 'âš ï¸' }}</view>
          <view class="status-text">{{ acr.result.operationStatus }}</view>
        </view>
      </view>

      <!-- å…³é”®å¯¹æ¯”æ•°æ® -->
      <view class="comparison-data">
        <view class="data-item">
          <view class="data-header">
            <view class="data-icon acr-icon">ğŸ“</view>
            <view class="data-label">ACRå€¼</view>
          </view>
          <view class="data-value acr-value">{{ acr.result.acr }}</view>
        </view>
        
        <view class="data-item">
          <view class="data-header">
            <view class="data-icon pcr-icon">ğŸ›£ï¸</view>
            <view class="data-label">PCRå€¼</view>
          </view>
          <view class="data-value pcr-value">{{ acr.result.pcr }}</view>
        </view>
        
        <view class="data-item">
          <view class="data-header">
            <view class="data-icon margin-icon">ğŸ“</view>
            <view class="data-label">å®‰å…¨ä½™é‡</view>
          </view>
          <view class="data-value {{ acr.result.safetyMargin >= 0 ? 'positive' : 'negative' }}">
            {{ acr.result.safetyMargin > 0 ? '+' : '' }}{{ acr.result.safetyMargin }}
          </view>
        </view>
      </view>

      <!-- è¯¦ç»†ç»“æœ -->
      <view class="detailed-results">
        <view class="detail-section">
          <view class="section-title">ğŸ“„ é£æœºä¿¡æ¯</view>
          <view class="detail-grid">
            <view class="detail-item">
              <text class="detail-label">å‹å·</text>
              <text class="detail-value">{{ acr.result.aircraftInfo }}</text>
            </view>
            <view class="detail-item">
              <text class="detail-label">æ”¹å‹</text>
              <text class="detail-value">{{ acr.result.variantName }}</text>
            </view>
            <view class="detail-item">
              <text class="detail-label">é‡é‡</text>
              <text class="detail-value">{{ acr.result.actualMass }} kg</text>
            </view>
          </view>
        </view>

        <view class="detail-section">
          <view class="section-title">ğŸ›£ï¸ é“é¢æ¡ä»¶</view>
          <view class="detail-grid">
            <view class="detail-item">
              <text class="detail-label">PCRä»£ç </text>
              <text class="detail-value pcr-code">{{ acr.result.pcrCode }}</text>
            </view>
            <view class="detail-item">
              <text class="detail-label">é“é¢ç±»å‹</text>
              <text class="detail-value">{{ acr.result.pavementTypeName }}</text>
            </view>
            <view class="detail-item">
              <text class="detail-label">é“åŸºå¼ºåº¦</text>
              <text class="detail-value">{{ acr.result.subgradeName }}</text>
            </view>
          </view>
        </view>
      </view>

      <!-- ç»“è®º -->
      <view class="conclusion-section">
        <view class="conclusion-header">
          <view class="conclusion-icon">{{ acr.result.canOperate ? 'âœ…' : 'âš ï¸' }}</view>
          <view class="conclusion-title">è¿è¡Œç»“è®º</view>
        </view>
        <view class="conclusion-text">{{ acr.result.operationReason }}</view>
      </view>

      <!-- é‡æ–°åˆ†ææŒ‰é’® -->
      <view class="restart-section">
        <view class="restart-button" bind:tap="restart">
          <view class="restart-icon">ğŸ”„</view>
          <view class="restart-text">é‡æ–°åˆ†æ</view>
        </view>
      </view>
    </view>
  </view>
</view>