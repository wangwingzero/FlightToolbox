<view class="container">
  <!-- 分类菜单 -->
  <view class="category-tabs-container">
    <scroll-view class="category-tabs-scroll" scroll-x scroll-with-animation enhanced show-scrollbar="{{ false }}">
      <view class="category-tabs-wrapper">
        <view 
          wx:for="{{ categoryList }}" 
          wx:key="name"
          class="category-tab-item {{ activeTab === item.name ? 'active' : '' }}"
          bind:tap="onTabChange"
          data-name="{{ item.name }}"
        >
          <view class="category-badge">{{ item.count }}</view>
          <view class="category-title">{{ item.title }}</view>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- 搜索框 -->
  <view class="search-section">
    <van-search
      value="{{ searchValue }}"
      placeholder="搜索事件、征候、术语..."
      bind:change="onSearchChange"
      bind:clear="onSearchClear"
      shape="round"
      background="transparent"
    />
  </view>


  <!-- 分类内容 -->
  <view wx:if="{{ activeTab === 'all' }}" class="tab-content">
    <!-- 全部内容 -->
      
      <view wx:if="{{ loading }}" class="loading-section">
        <van-loading size="24px" vertical>数据加载中...</van-loading>
      </view>
      
      <view wx:else class="all-section">
        <view wx:if="{{ displayedAll.length > 0 }}" class="results-section">
          <block wx:for="{{ displayedAll }}" wx:key="index" wx:for-index="idx">
            <!-- 分割标识：当当前项和前一项的subType不同时显示 -->
            <view wx:if="{{ idx === 0 || displayedAll[idx - 1].subType !== item.subType }}" class="type-divider">
              <view class="divider-text {{ item.subType === 'serious_incident' ? 'divider-serious' : item.subType === 'general_incident' ? 'divider-warning' : item.subType === 'category_one' ? 'divider-category-one' : item.subType === 'category_two' ? 'divider-category-two' : item.subType === 'urgent_event' ? 'divider-urgent' : item.subType === 'non_urgent_event' ? 'divider-non-urgent' : 'divider-other' }}">
                {{ item.subType === 'serious_incident' ? '严重征候' :
                   item.subType === 'general_incident' ? '一般征候' :
                   item.subType === 'category_one' ? '一类事件' :
                   item.subType === 'category_two' ? '二类事件' :
                   item.subType === 'urgent_event' ? '紧急事件' :
                   item.subType === 'non_urgent_event' ? '非紧急事件' : '其他' }}
              </view>
            </view>

            <van-cell-group inset>
              <van-cell
                title="{{ item.title }}"
                label="{{ item.content }}"
                is-link
                center
                bind:click="viewAllItemDetail"
                data-item="{{ item }}"
                class="all-cell {{ item.type }}-cell"
              >
                <view slot="icon" class="cell-icon-wrapper">
                  <van-icon 
                    name="{{ item.type === 'incident' ? 'warning-o' : (item.type === 'emergency_event' ? 'fire-o' : (item.type === 'general_event' ? 'info-o' : 'records')) }}" 
                    class="cell-icon cell-icon-{{ item.type }}"
                    size="40rpx"
                  />
                </view>
                <view slot="right-icon" class="all-category">
                  <van-tag
                    type="{{ item.type === 'accident' ? 'danger' : (item.type === 'incident' ? 'warning' : (item.type === 'emergency_event' ? 'danger' : 'success')) }}"
                    size="medium"
                  >
                    {{ item.type === 'accident' ? '事故' : (item.type === 'incident' ? '征候' : (item.type === 'emergency_event' ? '事件样例' : '一般事件')) }}
                  </van-tag>
                </view>
              </van-cell>
            </van-cell-group>

            <!-- 在第1个和第2个结果之间插入格子广告 -->
            <view wx:if="{{ idx === 0 && displayedAll.length > 1 && !isAdFree }}" class="ad-grid-container">
              <ad unit-id="adunit-3a1bf3800fa937a2" ad-type="grid"></ad>
            </view>
          </block>
          
          <!-- 加载更多按钮 -->
          <view wx:if="{{ hasMoreAll && !isLoadingMore }}" class="load-more-section">
            <button class="load-more-btn" bind:tap="loadMore" hover-class="button-hover">
              <text class="load-more-text">加载更多</text>
            </button>
            <view class="load-more-tip">还有 {{ filteredAll.length - displayedAll.length }} 条数据</view>
          </view>
          
          <!-- 加载中状态 -->
          <view wx:if="{{ isLoadingMore }}" class="loading-section">
            <view class="loading-spinner"></view>
            <text class="loading-text">加载中...</text>
          </view>
          
          <!-- 没有更多数据 -->
          <view wx:if="{{ !hasMoreAll && displayedAll.length > 0 }}" class="no-more-section">
            <text class="no-more-text">已显示全部 {{ displayedAll.length }} 条数据</text>
          </view>
        </view>

        <van-empty
          wx:if="{{ displayedAll.length === 0 && searchValue }}"
          description="未找到相关信息"
        />
      </view>
  </view>

  <view wx:if="{{ activeTab === 'incidents' }}" class="tab-content">
    <!-- 征候内容 -->
      
      <view wx:if="{{ loading }}" class="loading-section">
        <van-loading size="24px" vertical>数据加载中...</van-loading>
      </view>
      
      <view wx:else class="incidents-section">
        <view wx:if="{{ displayedIncidents.length > 0 }}" class="results-section">
          <van-cell-group inset title="征候分类 ({{ filteredIncidents.length }}条)">
            <block wx:for="{{ displayedIncidents }}" wx:key="code" wx:for-index="idx">
              <van-cell 
                title="{{ item.title }}"
                label="{{ item.content }}"
                is-link
                center
                bind:click="viewIncidentDetail"
                data-item="{{ item }}"
                class="incident-cell"
              >
                <view slot="icon" class="cell-icon-wrapper">
                  <van-icon name="warning-o" class="cell-icon cell-icon-incident" size="40rpx" />
                </view>
                <view slot="right-icon" class="incident-category">
                  <van-tag type="warning" size="medium">{{ item.category || '征候' }}</van-tag>
                </view>
              </van-cell>

              <!-- 在第1个和第2个结果之间插入格子广告 -->
              <view wx:if="{{ idx === 0 && displayedIncidents.length > 1 && !isAdFree }}" class="ad-grid-container">
                <ad unit-id="adunit-3a1bf3800fa937a2" ad-type="grid"></ad>
              </view>
            </block>
          </van-cell-group>
          
          <!-- 加载更多按钮 -->
          <view wx:if="{{ hasMoreIncidents && !isLoadingMore }}" class="load-more-section">
            <button class="load-more-btn" bind:tap="loadMore" hover-class="button-hover">
              <text class="load-more-text">加载更多</text>
            </button>
            <view class="load-more-tip">还有 {{ filteredIncidents.length - displayedIncidents.length }} 条数据</view>
          </view>
          
          <!-- 加载中状态 -->
          <view wx:if="{{ isLoadingMore }}" class="loading-section">
            <view class="loading-spinner"></view>
            <text class="loading-text">加载中...</text>
          </view>
          
          <!-- 没有更多数据 -->
          <view wx:if="{{ !hasMoreIncidents && displayedIncidents.length > 0 }}" class="no-more-section">
            <text class="no-more-text">已显示全部 {{ displayedIncidents.length }} 条数据</text>
          </view>
        </view>

        <van-empty
          wx:if="{{ displayedIncidents.length === 0 && searchValue }}"
          description="未找到相关征候信息"
        />
      </view>
  </view>

  <view wx:if="{{ activeTab === 'general_events' }}" class="tab-content">
    <!-- 一般事件内容 -->
      
      <view wx:if="{{ loading }}" class="loading-section">
        <van-loading size="24px" vertical>数据加载中...</van-loading>
      </view>
      
      <view wx:else class="general-events-section">
        <view wx:if="{{ displayedGeneralEvents.length > 0 }}" class="results-section">
          <van-cell-group inset title="一般事件分类 ({{ filteredGeneralEvents.length }}条)">
            <block wx:for="{{ displayedGeneralEvents }}" wx:key="code" wx:for-index="idx">
              <van-cell 
                title="{{ item.title }}"
                label="{{ item.content }}"
                is-link
                center
                bind:click="viewGeneralEventDetail"
                data-item="{{ item }}"
                class="general-event-cell"
              >
                <view slot="icon" class="cell-icon-wrapper">
                  <van-icon name="info-o" class="cell-icon cell-icon-general_event" size="40rpx" />
                </view>
                <view slot="right-icon" class="general-event-category">
                  <van-tag type="success" size="medium">{{ item.category || '一般' }}</van-tag>
                </view>
              </van-cell>

              <!-- 在第1个和第2个结果之间插入格子广告 -->
              <view wx:if="{{ idx === 0 && displayedGeneralEvents.length > 1 && !isAdFree }}" class="ad-grid-container">
                <ad unit-id="adunit-3a1bf3800fa937a2" ad-type="grid"></ad>
              </view>
            </block>
          </van-cell-group>
          
          <!-- 加载更多按钮 -->
          <view wx:if="{{ hasMoreGeneralEvents && !isLoadingMore }}" class="load-more-section">
            <button class="load-more-btn" bind:tap="loadMore" hover-class="button-hover">
              <text class="load-more-text">加载更多</text>
            </button>
            <view class="load-more-tip">还有 {{ filteredGeneralEvents.length - displayedGeneralEvents.length }} 条数据</view>
          </view>
          
          <!-- 加载中状态 -->
          <view wx:if="{{ isLoadingMore }}" class="loading-section">
            <view class="loading-spinner"></view>
            <text class="loading-text">加载中...</text>
          </view>
          
          <!-- 没有更多数据 -->
          <view wx:if="{{ !hasMoreGeneralEvents && displayedGeneralEvents.length > 0 }}" class="no-more-section">
            <text class="no-more-text">已显示全部 {{ displayedGeneralEvents.length }} 条数据</text>
          </view>
        </view>

        <van-empty
          wx:if="{{ displayedGeneralEvents.length === 0 && searchValue }}"
          description="未找到相关一般事件信息"
        />
      </view>
  </view>

  <view wx:if="{{ activeTab === 'emergency_events' }}" class="tab-content">
    <!-- 事件样例内容 -->
      
      <view wx:if="{{ loading }}" class="loading-section">
        <van-loading size="24px" vertical>数据加载中...</van-loading>
      </view>
      
      <view wx:else class="emergency-events-section">
        <view wx:if="{{ displayedEmergencyEvents.length > 0 }}" class="results-section">
          <van-cell-group inset title="事件样例分类 ({{ filteredEmergencyEvents.length }}条)">
            <block wx:for="{{ displayedEmergencyEvents }}" wx:key="code" wx:for-index="idx">
              <van-cell 
                title="{{ item.title }}"
                label="{{ item.content }}"
                is-link
                center
                bind:click="viewEmergencyEventDetail"
                data-item="{{ item }}"
                class="emergency-event-cell"
              >
                <view slot="icon" class="cell-icon-wrapper">
                  <van-icon name="fire-o" class="cell-icon cell-icon-emergency_event" size="40rpx" />
                </view>
                <view slot="right-icon" class="emergency-event-category">
                  <van-tag type="danger" size="medium">{{ item.category || '事件样例' }}</van-tag>
                </view>
              </van-cell>

              <!-- 在第1个和第2个结果之间插入格子广告 -->
              <view wx:if="{{ idx === 0 && displayedEmergencyEvents.length > 1 && !isAdFree }}" class="ad-grid-container">
                <ad unit-id="adunit-3a1bf3800fa937a2" ad-type="grid"></ad>
              </view>
            </block>
          </van-cell-group>
          
          <!-- 加载更多按钮 -->
          <view wx:if="{{ hasMoreEmergencyEvents && !isLoadingMore }}" class="load-more-section">
            <button class="load-more-btn" bind:tap="loadMore" hover-class="button-hover">
              <text class="load-more-text">加载更多</text>
            </button>
            <view class="load-more-tip">还有 {{ filteredEmergencyEvents.length - displayedEmergencyEvents.length }} 条数据</view>
          </view>
          
          <!-- 加载中状态 -->
          <view wx:if="{{ isLoadingMore }}" class="loading-section">
            <view class="loading-spinner"></view>
            <text class="loading-text">加载中...</text>
          </view>
          
          <!-- 没有更多数据 -->
          <view wx:if="{{ !hasMoreEmergencyEvents && displayedEmergencyEvents.length > 0 }}" class="no-more-section">
            <text class="no-more-text">已显示全部 {{ displayedEmergencyEvents.length }} 条数据</text>
          </view>
        </view>

        <van-empty
          wx:if="{{ displayedEmergencyEvents.length === 0 && searchValue }}"
          description="未找到相关事件样例信息"
        />
        
        <van-empty
          wx:if="{{ displayedEmergencyEvents.length === 0 && !searchValue }}"
          description="暂无事件样例数据"
          image="search"
        />
      </view>
  </view>

  <view wx:if="{{ activeTab === 'definitions' }}" class="tab-content">
    <!-- 术语定义内容 -->
      
      <view wx:if="{{ loading }}" class="loading-section">
        <van-loading size="24px" vertical>数据加载中...</van-loading>
      </view>
      
      <view wx:else class="definitions-section">
        <view wx:if="{{ displayedDefinitions.length > 0 }}" class="results-section">
          <van-cell-group inset title="术语定义 ({{ filteredDefinitions.length }}条)">
            <block wx:for="{{ displayedDefinitions }}" wx:key="term" wx:for-index="idx">
              <van-cell 
                title="{{ item.title }}"
                label="{{ item.shortDefinition }}"
                is-link
                center
                bind:click="viewDefinitionDetail"
                data-item="{{ item }}"
                class="definition-cell"
              >
                <view slot="icon" class="cell-icon-wrapper">
                  <van-icon name="records" class="cell-icon cell-icon-definition" size="40rpx" />
                </view>
                <view slot="right-icon" class="definition-category">
                  <van-tag type="primary" size="medium">术语</van-tag>
                </view>
              </van-cell>

              <!-- 在第1个和第2个结果之间插入格子广告 -->
              <view wx:if="{{ idx === 0 && displayedDefinitions.length > 1 && !isAdFree }}" class="ad-grid-container">
                <ad unit-id="adunit-3a1bf3800fa937a2" ad-type="grid"></ad>
              </view>
            </block>
          </van-cell-group>
          
          <!-- 加载更多按钮 -->
          <view wx:if="{{ hasMoreDefinitions && !isLoadingMore }}" class="load-more-section">
            <button class="load-more-btn" bind:tap="loadMore" hover-class="button-hover">
              <text class="load-more-text">加载更多</text>
            </button>
            <view class="load-more-tip">还有 {{ filteredDefinitions.length - displayedDefinitions.length }} 条数据</view>
          </view>
          
          <!-- 加载中状态 -->
          <view wx:if="{{ isLoadingMore }}" class="loading-section">
            <view class="loading-spinner"></view>
            <text class="loading-text">加载中...</text>
          </view>
          
          <!-- 没有更多数据 -->
          <view wx:if="{{ !hasMoreDefinitions && displayedDefinitions.length > 0 }}" class="no-more-section">
            <text class="no-more-text">已显示全部 {{ displayedDefinitions.length }} 条数据</text>
          </view>
        </view>

        <van-empty
          wx:if="{{ displayedDefinitions.length === 0 && searchValue }}"
          description="未找到相关术语定义"
        />
      </view>
  </view>

  <!-- 详情弹窗 -->
  <van-popup
    show="{{ showDetailPopup }}"
    bind:close="closeDetailPopup"
    position="bottom"
    round="{{ true }}"
    close-on-click-overlay="{{ true }}"
  >
    <view class="detail-popup-container">
      <!-- 弹窗标题栏 -->
      <view class="detail-header">
        <view class="header-left">
          <view wx:if="{{ canGoBack }}" class="back-btn" bind:tap="goBackInHistory" catchtap="goBackInHistory">
            <van-icon name="arrow-left" class="back-icon" />
          </view>
        </view>
        <view class="detail-title">{{ detailData.title }}</view>
        <view class="header-right">
          <view class="close-btn" bind:tap="closeDetailPopup" catchtap="closeDetailPopup">
            <van-icon name="cross" class="close-icon" />
          </view>
        </view>
      </view>

      <!-- 滚动内容区域 -->
      <scroll-view scroll-y class="detail-content" enable-flex enhanced show-scrollbar="{{ false }}">
        <!-- 事故详情 -->
        <view wx:if="{{ detailType === 'accident' }}" class="accident-detail">
          <van-cell-group inset class="detail-section compact-section">
            <van-cell title="事故类型" value="{{ detailData.title }}" />
            <van-cell title="严重程度">
              <view slot="right-icon" class="cell-right-value {{ detailData.severityClass }}">{{ detailData.level || '事故' }}</view>
            </van-cell>
            <van-cell title="分类">
              <view slot="right-icon" class="cell-right-value {{ detailData.severityClass }}">{{ detailData.category }}</view>
            </van-cell>
          </van-cell-group>

          <van-cell-group inset title="详细内容" class="detail-section">
            <view class="description-content">
              <view class="description-text">
                <block wx:if="{{ detailData.termData && detailData.termData.hasTerms }}">
                  <block wx:for="{{ detailData.contentParts }}" wx:key="index">
                    <text wx:if="{{ item.type === 'text' }}">{{ item.text }}</text>
                    <text wx:elif="{{ item.type === 'term' }}" 
                          class="term-highlight clickable-term" 
                          bind:tap="onTermClick"
                          data-term="{{ item.termKey }}">{{ item.text }}</text>
                  </block>
                </block>
                <text wx:else>{{ detailData.content }}</text>
              </view>
            </view>
          </van-cell-group>

          <van-cell-group inset wx:if="{{ detailData.examples && detailData.examples.length > 0 }}" title="典型示例" class="detail-section">
            <view class="examples-content">
              <view wx:for="{{ detailData.examples }}" wx:key="index" class="example-item">
                <text class="example-text">{{ index + 1 }}. {{ item }}</text>
              </view>
            </view>
          </van-cell-group>

          <van-cell-group inset wx:if="{{ detailData.reference }}" title="法规依据" class="detail-section">
            <view class="reference-content">
              <text class="reference-text">{{ detailData.reference }}</text>
            </view>
          </van-cell-group>
        </view>

        <!-- 征候详情 -->
        <view wx:if="{{ detailType === 'incident' }}" class="incident-detail">
          <van-cell-group inset class="detail-section compact-section">
            <van-cell title="征候类型" value="{{ detailData.title }}" />
            <van-cell title="分类">
              <view slot="right-icon" class="cell-right-value {{ detailData.severityClass }}">{{ detailData.category || '征候' }}</view>
            </van-cell>
          </van-cell-group>

          <van-cell-group inset title="详细内容" class="detail-section">
            <view class="description-content">
              <view class="description-text">
                <block wx:if="{{ detailData.termData && detailData.termData.hasTerms }}">
                  <block wx:for="{{ detailData.contentParts }}" wx:key="index">
                    <text wx:if="{{ item.type === 'text' }}">{{ item.text }}</text>
                    <text wx:elif="{{ item.type === 'term' }}" 
                          class="term-highlight clickable-term" 
                          bind:tap="onTermClick"
                          data-term="{{ item.termKey }}">{{ item.text }}</text>
                  </block>
                </block>
                <text wx:else>{{ detailData.content }}</text>
              </view>
            </view>
          </van-cell-group>

          <van-cell-group inset wx:if="{{ detailData.examples && detailData.examples.length > 0 }}" title="典型示例" class="detail-section">
            <view class="examples-content">
              <view wx:for="{{ detailData.examples }}" wx:key="index" class="example-item">
                <text class="example-text">{{ index + 1 }}. {{ item }}</text>
              </view>
            </view>
          </van-cell-group>

          <van-cell-group inset wx:if="{{ detailData.reference }}" title="法规依据" class="detail-section">
            <view class="reference-content">
              <text class="reference-text">{{ detailData.reference }}</text>
            </view>
          </van-cell-group>
        </view>

        <!-- 一般事件详情 -->
        <view wx:if="{{ detailType === 'general_event' }}" class="general-event-detail">
          <van-cell-group inset class="detail-section compact-section">
            <van-cell title="事件类型" value="{{ detailData.title }}" />
            <van-cell title="分类">
              <view slot="right-icon" class="cell-right-value {{ detailData.severityClass }}">{{ detailData.category || '一般事件' }}</view>
            </van-cell>
          </van-cell-group>

          <van-cell-group inset title="详细内容" class="detail-section">
            <view class="description-content">
              <view class="description-text">
                <block wx:if="{{ detailData.termData && detailData.termData.hasTerms }}">
                  <block wx:for="{{ detailData.contentParts }}" wx:key="index">
                    <text wx:if="{{ item.type === 'text' }}">{{ item.text }}</text>
                    <text wx:elif="{{ item.type === 'term' }}" 
                          class="term-highlight clickable-term" 
                          bind:tap="onTermClick"
                          data-term="{{ item.termKey }}">{{ item.text }}</text>
                  </block>
                </block>
                <text wx:else>{{ detailData.content }}</text>
              </view>
            </view>
          </van-cell-group>

          <van-cell-group inset wx:if="{{ detailData.examples && detailData.examples.length > 0 }}" title="典型示例" class="detail-section">
            <view class="examples-content">
              <view wx:for="{{ detailData.examples }}" wx:key="index" class="example-item">
                <text class="example-text">{{ index + 1 }}. {{ item }}</text>
              </view>
            </view>
          </van-cell-group>

          <van-cell-group inset wx:if="{{ detailData.reference }}" title="法规依据" class="detail-section">
            <view class="reference-content">
              <text class="reference-text">{{ detailData.reference }}</text>
            </view>
          </van-cell-group>
        </view>

        <!-- 事件样例详情 -->
        <view wx:if="{{ detailType === 'emergency_event' }}" class="emergency-event-detail">
          <van-cell-group inset class="detail-section compact-section">
            <van-cell title="事件类型" value="{{ detailData.title }}" />
            <van-cell title="紧急级别">
              <view slot="right-icon" class="cell-right-value {{ detailData.severityClass }}">{{ detailData.urgencyLevel || '未知' }}</view>
            </van-cell>
            <van-cell title="分类">
              <view slot="right-icon" class="cell-right-value {{ detailData.severityClass }}">{{ detailData.category || '事件样例' }}</view>
            </van-cell>
            <van-cell wx:if="{{ detailData.code }}" title="编号" value="{{ detailData.code }}" />
          </van-cell-group>

          <van-cell-group inset title="详细内容" class="detail-section">
            <view class="description-content">
              <view class="description-text">
                <block wx:if="{{ detailData.termData && detailData.termData.hasTerms }}">
                  <block wx:for="{{ detailData.contentParts }}" wx:key="index">
                    <text wx:if="{{ item.type === 'text' }}">{{ item.text }}</text>
                    <text wx:elif="{{ item.type === 'term' }}" 
                          class="term-highlight clickable-term" 
                          bind:tap="onTermClick"
                          data-term="{{ item.termKey }}">{{ item.text }}</text>
                  </block>
                </block>
                <text wx:else>{{ detailData.content }}</text>
              </view>
            </view>
          </van-cell-group>

          <van-cell-group inset wx:if="{{ detailData.examples && detailData.examples.length > 0 }}" title="典型示例" class="detail-section">
            <view class="examples-content">
              <view wx:for="{{ detailData.examples }}" wx:key="index" class="example-item">
                <text class="example-text">{{ index + 1 }}. {{ item }}</text>
              </view>
            </view>
          </van-cell-group>


          <van-cell-group inset wx:if="{{ detailData.note }}" title="备注说明" class="detail-section">
            <view class="description-content">
              <view class="description-text">{{ detailData.note }}</view>
            </view>
          </van-cell-group>

          <van-cell-group inset wx:if="{{ detailData.reference }}" title="法规依据" class="detail-section">
            <view class="reference-content">
              <text class="reference-text">{{ detailData.reference }}</text>
            </view>
          </van-cell-group>
        </view>

        <!-- 术语定义详情 -->
        <view wx:if="{{ detailType === 'definition' }}" class="definition-detail">
          <van-cell-group inset class="detail-section compact-section">
            <van-cell title="术语" value="{{ detailData.title }}" />
          </van-cell-group>

          <van-cell-group inset title="定义内容" class="detail-section">
            <view class="description-content">
              <view class="description-text">
                <block wx:if="{{ detailData.definitionTermData && detailData.definitionTermData.hasTerms }}">
                  <block wx:for="{{ detailData.definitionParts }}" wx:key="index">
                    <text wx:if="{{ item.type === 'text' }}">{{ item.text }}</text>
                    <text wx:elif="{{ item.type === 'term' }}" 
                          class="term-highlight clickable-term" 
                          bind:tap="onTermClick"
                          data-term="{{ item.termKey }}">{{ item.text }}</text>
                  </block>
                </block>
                <text wx:else>{{ detailData.definition }}</text>
              </view>
            </view>
          </van-cell-group>

          <van-cell-group inset wx:if="{{ detailData.reference }}" title="法规依据" class="detail-section">
            <view class="reference-content">
              <text class="reference-text">{{ detailData.reference }}</text>
            </view>
          </van-cell-group>
        </view>
      </scroll-view>

      <!-- 底部操作栏 -->
      <view class="detail-footer">
        <view wx:if="{{ canGoBack }}" class="footer-buttons">
          <van-button type="default" bind:click="goBackInHistory" class="back-button">
            <van-icon name="arrow-left" class="button-icon" />
            返回
          </van-button>
          <van-button type="primary" bind:click="closeDetailPopup" class="close-button">
            <van-icon name="cross" class="button-icon" />
            关闭
          </van-button>
        </view>
        <van-button wx:else type="primary" block bind:click="closeDetailPopup" class="close-button">
          <van-icon name="success" class="button-icon" />
          知道了
        </van-button>
      </view>
    </view>
  </van-popup>

  <!-- 页面底部广告 -->
  <view wx:if="{{ !isAdFree }}" class="ad-banner-container">
    <ad unit-id="adunit-d6c8a55bd3cb4fd1" ad-type="banner" ad-intervals="30"></ad>
  </view>

</view>
