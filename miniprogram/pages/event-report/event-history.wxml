<view class="container">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="page-header">
    <view class="header-title">ğŸ“š å†å²è®°å½•</view>
    <view class="header-subtitle">æŸ¥çœ‹å’Œç®¡ç†å·²ä¿å­˜çš„æŠ¥å‘Š</view>
    <view class="header-count" wx:if="{{reports.length > 0}}">å…± {{reports.length}} æ¡è®°å½•</view>
  </view>

  <!-- å†å²è®°å½•åˆ—è¡¨ -->
  <van-cell-group title="å†å²è®°å½•" wx:if="{{reports.length > 0}}">
    <van-cell 
      wx:for="{{reports}}" 
      wx:key="timestamp"
      title="{{item.eventType.name}}"
      is-link
      bind:click="viewReport"
      data-index="{{index}}"
    >
      <view slot="label" class="report-info">
        <view class="urgency-tag {{item.eventType.urgency === 'ç´§æ€¥' ? 'urgent' : 'non-urgent'}}">
          {{item.eventType.urgency}}
        </view>
        <view class="time-text">{{formatTime(item.timestamp)}}</view>
      </view>
      <view slot="right-icon">
        <van-icon name="delete" bind:click="deleteReport" data-index="{{index}}" />
      </view>
    </van-cell>
  </van-cell-group>

  <!-- ç©ºçŠ¶æ€ -->
  <view wx:if="{{reports.length === 0}}" class="empty-state">
    <van-empty description="æš‚æ— å†å²è®°å½•" />
    <van-button type="primary" bind:click="goToCreate">
      å¼€å§‹å¡«æŠ¥
    </van-button>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <van-cell-group title="æ“ä½œ" wx:if="{{reports.length > 0}}">
    <van-cell>
      <van-button type="warning" block bind:click="clearAllReports">
        æ¸…ç©ºæ‰€æœ‰è®°å½•
      </van-button>
    </van-cell>
  </van-cell-group>

  <!-- æŠ¥å‘Šè¯¦æƒ…å¼¹çª— -->
  <van-popup show="{{showReportDetail}}" position="bottom" bind:close="closeReportDetail">
    <view class="report-detail" wx:if="{{selectedReport}}">
      <view class="detail-header">
        <view class="detail-title">{{selectedReport.eventType.name}}</view>
        <view class="detail-time">{{formatTime(selectedReport.timestamp)}}</view>
      </view>
      <view class="detail-content">
        <text class="detail-text" user-select>{{selectedReport.generatedText}}</text>
      </view>
      <view class="detail-actions">
        <van-button type="default" bind:click="copySelectedReport">å¤åˆ¶</van-button>
        <van-button type="danger" bind:click="deleteSelectedReport">åˆ é™¤</van-button>
        <van-button type="info" bind:click="closeReportDetail">å…³é—­</van-button>
      </view>
    </view>
  </van-popup>
</view> 