<view class="bento-container">
  <!-- é¡¶éƒ¨çŠ¶æ€æ  -->
  <view class="status-bar">
    <view class="status-content">
      <view class="status-left">
        <text class="status-icon">ğŸ“‹</text>
        <text class="status-title">äº‹ä»¶æŠ¥å‘Š</text>
      </view>
      <view class="status-right">
        <view class="status-btn" bind:tap="openHistory">
          <text class="btn-icon">ğŸ“š</text>
        </view>
        <view class="status-btn" bind:tap="openProfile">
          <text class="btn-icon">âš™ï¸</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
  <scroll-view class="bento-content" scroll-y enhanced>
    <!-- æ¬¢è¿ä¾¿å½“ç›’ -->
    <view class="bento-box welcome-box">
      <view class="box-header">
        <view class="header-icon">âœˆï¸</view>
        <view class="header-text">
          <view class="header-title">èˆªç©ºäº‹ä»¶æŠ¥å‘ŠåŠ©æ‰‹</view>
          <view class="header-subtitle">ä¸“ä¸š Â· é«˜æ•ˆ Â· æ ‡å‡†åŒ–</view>
        </view>
      </view>
      <view class="stats-grid">
        <view class="stat-card">
          <view class="stat-number">40+</view>
          <view class="stat-label">äº‹ä»¶ç±»å‹</view>
        </view>
        <view class="stat-divider"></view>
        <view class="stat-card">
          <view class="stat-number">100%</view>
          <view class="stat-label">æ ‡å‡†åŒ–</view>
        </view>
        <view class="stat-divider"></view>
        <view class="stat-card">
          <view class="stat-number">å¿«é€Ÿ</view>
          <view class="stat-label">ç”ŸæˆæŠ¥å‘Š</view>
        </view>
      </view>
    </view>

    <!-- æœç´¢ä¾¿å½“ç›’ -->
    <view class="bento-box search-box">
      <view class="search-header">
        <text class="search-title">ğŸ” æ™ºèƒ½æœç´¢</text>
        <text class="search-subtitle">å¿«é€Ÿå®šä½äº‹ä»¶ç±»å‹</text>
      </view>
      <view class="search-input-wrapper">
        <van-search 
          value="{{searchValue}}" 
          placeholder="æœç´¢äº‹ä»¶ç±»å‹ï¼Œå¦‚ï¼šå¤±æ§ã€èµ·ç«ã€è·‘é“ä¾µå…¥..." 
          bind:search="onSearch"
          bind:change="onSearchChange"
          bind:clear="onSearchClear"
          shape="round"
          background="transparent"
          custom-class="bento-search"
        />
      </view>
      
      <!-- çƒ­é—¨æ ‡ç­¾ä¾¿å½“æ ¼ -->
      <view class="tags-section" wx:if="{{!searchValue}}">
        <view class="tags-header">
          <text class="tags-title">ğŸ”¥ çƒ­é—¨æœç´¢</text>
        </view>
        <view class="tags-bento">
          <view class="tag-item" bind:tap="quickSearch" data-keyword="å¤±æ§">
            <text class="tag-icon">âš ï¸</text>
            <text class="tag-text">å¤±æ§</text>
          </view>
          <view class="tag-item" bind:tap="quickSearch" data-keyword="èµ·ç«">
            <text class="tag-icon">ğŸ”¥</text>
            <text class="tag-text">èµ·ç«</text>
          </view>
          <view class="tag-item" bind:tap="quickSearch" data-keyword="è·‘é“ä¾µå…¥">
            <text class="tag-icon">ğŸ›¬</text>
            <text class="tag-text">è·‘é“ä¾µå…¥</text>
          </view>
          <view class="tag-item" bind:tap="quickSearch" data-keyword="æœºæ¢°æ•…éšœ">
            <text class="tag-icon">ğŸ”§</text>
            <text class="tag-text">æœºæ¢°æ•…éšœ</text>
          </view>
          <view class="tag-item" bind:tap="quickSearch" data-keyword="å¤©æ°”">
            <text class="tag-icon">ğŸŒ©ï¸</text>
            <text class="tag-text">å¤©æ°”</text>
          </view>
          <view class="tag-item" bind:tap="quickSearch" data-keyword="é¸Ÿå‡»">
            <text class="tag-icon">ğŸ¦</text>
            <text class="tag-text">é¸Ÿå‡»</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æœç´¢ç»“æœä¾¿å½“ç›’ -->
    <view class="bento-box results-box" wx:if="{{searchValue && filteredEventTypes.length > 0}}">
      <view class="results-header">
        <text class="results-title">æœç´¢ç»“æœ</text>
        <view class="results-count">{{filteredEventTypes.length}} ä¸ªç»“æœ</view>
      </view>
      <view class="results-bento">
        <view 
          class="result-card" 
          wx:for="{{filteredEventTypes}}" 
          wx:key="id"
          bind:tap="selectEventType"
          data-event-type-id="{{item.id}}"
        >
          <view class="result-header">
            <view class="result-icon">ğŸ“</view>
            <view class="urgency-dot {{item.urgency === 'ç´§æ€¥' ? 'urgent' : 'normal'}}"></view>
          </view>
          <view class="result-content">
            <view class="result-title">{{item.name}}</view>
            <view class="result-meta">
              <text class="result-urgency {{item.urgency === 'ç´§æ€¥' ? 'urgent' : 'normal'}}">
                {{item.urgency}}
              </text>
              <text class="result-deadline">{{item.deadline.domestic}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- æ— æœç´¢ç»“æœä¾¿å½“ç›’ -->
    <view class="bento-box empty-box" wx:if="{{searchValue && filteredEventTypes.length === 0}}">
      <view class="empty-content">
        <view class="empty-icon">ğŸ”</view>
        <view class="empty-title">æœªæ‰¾åˆ°ç›¸å…³äº‹ä»¶ç±»å‹</view>
        <view class="empty-subtitle">è¯·å°è¯•å…¶ä»–å…³é”®è¯</view>
      </view>
    </view>

    <!-- äº‹ä»¶åˆ†ç±»ä¾¿å½“ç›’ -->
    <view class="bento-box categories-box" wx:if="{{!searchValue}}">
      <view class="categories-header">
        <text class="categories-title">ğŸ“‚ äº‹ä»¶åˆ†ç±»</text>
        <text class="categories-subtitle">é€‰æ‹©å¯¹åº”çš„äº‹ä»¶ç±»å‹è¿›è¡Œå¡«æŠ¥</text>
      </view>
      
      <view class="categories-bento">
        <view 
          class="category-card" 
          wx:for="{{categories}}" 
          wx:key="id"
          bind:tap="selectCategory"
          data-category-id="{{item.id}}"
        >
          <view class="card-header">
            <view class="card-icon-wrapper">
              <text class="card-icon">{{getCategoryIcon(item.id)}}</text>
            </view>
            <view class="card-badge">{{item.eventTypes.length}}</view>
          </view>
          <view class="card-body">
            <view class="card-title">{{item.name}}</view>
            <view class="card-description">
              <text class="urgent-info">ç´§æ€¥äº‹ä»¶: {{getUrgentCount(item.eventTypes)}}</text>
            </view>
          </view>
          <view class="card-footer">
            <view class="card-preview">
              <text wx:for="{{item.eventTypes.slice(0, 2)}}" wx:key="id" wx:for-item="event" class="preview-item">
                â€¢ {{event.name.length > 12 ? event.name.substring(0, 12) + '...' : event.name}}
              </text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- å¿«é€Ÿæ“ä½œä¾¿å½“ç›’ -->
    <view class="bento-box actions-box" wx:if="{{!searchValue}}">
      <view class="actions-header">
        <text class="actions-title">âš¡ å¿«é€Ÿæ“ä½œ</text>
      </view>
      <view class="actions-bento">
        <view class="action-card" bind:tap="openHistory">
          <view class="action-icon-wrapper">
            <text class="action-icon">ğŸ“š</text>
          </view>
          <view class="action-content">
            <view class="action-title">å†å²è®°å½•</view>
            <view class="action-desc">æŸ¥çœ‹å·²å¡«å†™çš„æŠ¥å‘Š</view>
          </view>
        </view>
        <view class="action-card" bind:tap="openProfile">
          <view class="action-icon-wrapper">
            <text class="action-icon">âš™ï¸</text>
          </view>
          <view class="action-content">
            <view class="action-title">ä¸ªäººè®¾ç½®</view>
            <view class="action-desc">é…ç½®ä¸ªäººä¿¡æ¯</view>
          </view>
        </view>
      </view>
    </view>

    <!-- åº•éƒ¨å®‰å…¨è·ç¦» -->
    <view class="bottom-safe-area"></view>
  </scroll-view>
</view>