<view class="{{ containerClass || 'container' }} page-content">
  <!-- 用户状态卡片 - 简化版本 -->
  <view class="user-status-card">
    <view class="status-header">
      <view class="user-avatar">
        <text class="emoji-icon">👨‍✈️</text>
        <view class="avatar-ring"></view>
      </view>
      <view class="user-info">
        <view class="greeting">{{ greeting }}</view>
        <view class="welcome-text">欢迎使用飞行工具箱</view>
      </view>
    </view>
  </view>

  <!-- 资质提醒卡片 -->
  <!-- 有资质数据时显示 -->
  <view wx:if="{{ qualifications.length > 0 }}" class="qualification-alert-card">
    <view class="alert-header">
      <view class="alert-icon">
        <text class="emoji-icon">🛡️</text>
      </view>
      <view class="alert-content">
        <text class="alert-title">资质提醒</text>
        <text class="alert-subtitle" wx:if="{{ expiringSoonCount > 0 }}">{{ expiringSoonCount }}项即将到期</text>
        <text class="alert-subtitle all-valid" wx:else>全部有效</text>
      </view>
      <view class="alert-action" bind:tap="openQualificationManager">
        <text class="emoji-icon">→</text>
      </view>
    </view>
    
    <scroll-view class="qualification-scroll" scroll-x="{{ true }}" show-scrollbar="{{ false }}">
      <view class="qualification-items">
        <view 
          wx:for="{{ qualifications }}" 
          wx:key="id"
          class="qualification-item qualification-{{ item.status }}"
          bind:tap="openQualificationManager"
        >
          <view class="qual-status-dot"></view>
          <view class="qual-content">
            <view class="qual-name">{{ item.name }}</view>
            <view class="qual-status">
              <text wx:if="{{ item.daysRemaining > 0 }}">{{ item.daysRemaining }}天后到期</text>
              <text wx:elif="{{ item.daysRemaining === 0 }}">今日到期</text>
              <text wx:else>已过期</text>
            </view>
          </view>
          <view class="qual-icon">
            <text class="emoji-icon">
              {{ item.status === 'expired' ? '❌' : item.status === 'warning' ? '⚠️' : '✅' }}
            </text>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- 新用户空状态：引导使用资质管理 -->
  <view wx:else class="qualification-empty-state">
    <view class="empty-state-content">
      <view class="empty-state-icon">
        <text class="emoji-icon">📜</text>
        <view class="icon-sparkle">✨</view>
      </view>
      <view class="empty-state-text">
        <text class="empty-title">开始管理您的飞行资质</text>
        <text class="empty-subtitle">证照到期提醒，让飞行更安心</text>
      </view>
      <view class="empty-state-action" bind:tap="openQualificationManager">
        <text class="action-text">添加第一个资质</text>
        <text class="emoji-icon">→</text>
      </view>
    </view>
  </view>

  <!-- 工具分类区域 -->
  <view class="tools-categories feature-buttons">
    <!-- 飞行计算工具 -->
    <view class="category-section">
      <view class="category-header">
        <view class="category-icon">
          <text class="emoji-icon">🧮</text>
          <view class="icon-bg flight-calc-bg"></view>
        </view>
        <view class="category-info">
          <text class="category-title">飞行计算</text>
          <text class="category-desc">精确计算，安全飞行</text>
        </view>
      </view>
      <van-row gutter="32">
        <van-col span="12">
          <view class="tool-card flight-calc" bind:tap="openSunriseOnly">
            <view class="tool-icon">
              <text class="emoji-icon">🌅</text>
              <view class="tool-icon-bg"></view>
            </view>
            <view class="tool-content">
              <view class="tool-name">日出日落</view>
              <view class="tool-desc">时间查询</view>
            </view>
          </view>
        </van-col>
        <van-col span="12">
          <view class="tool-card flight-calc" bind:tap="openSunriseSunset">
            <view class="tool-icon">
              <text class="emoji-icon">🌙</text>
              <view class="tool-icon-bg"></view>
            </view>
            <view class="tool-content">
              <view class="tool-name">夜航时间</view>
              <view class="tool-desc">夜间计算</view>
            </view>
          </view>
        </van-col>
      </van-row>
    </view>

    <!-- 安全管理工具 -->
    <view class="category-section">
      <view class="category-header">
        <view class="category-icon">
          <text class="emoji-icon">🛡️</text>
          <view class="icon-bg safety-bg"></view>
        </view>
        <view class="category-info">
          <text class="category-title">安全管理</text>
          <text class="category-desc">安全第一，规范操作</text>
        </view>
      </view>
      <van-row gutter="32">
        <van-col span="12">
          <view class="tool-card safety" bind:tap="openEventReport">
            <view class="tool-icon">
              <text class="emoji-icon">📝</text>
              <view class="tool-icon-bg"></view>
            </view>
            <view class="tool-content">
              <view class="tool-name">事件报告</view>
              <view class="tool-desc">样例填写指导</view>
            </view>
          </view>
        </van-col>
        <van-col span="12">
          <view class="tool-card safety" bind:tap="openIncidentInvestigation">
            <view class="tool-icon">
              <text class="emoji-icon">🔍</text>
              <view class="tool-icon-bg"></view>
            </view>
            <view class="tool-content">
              <view class="tool-name">事件调查</view>
              <view class="tool-desc">征候事件查询</view>
            </view>
          </view>
        </van-col>
      </van-row>
    </view>

    <!-- 飞行管理工具 -->
    <view class="category-section">
      <view class="category-header">
        <view class="category-icon">
          <text class="emoji-icon">📋</text>
          <view class="icon-bg management-bg"></view>
        </view>
        <view class="category-info">
          <text class="category-title">飞行管理</text>
          <text class="category-desc">规范管理，高效运行</text>
        </view>
      </view>
      <!-- 第一行：分飞行时间和个人检查单 -->
      <van-row gutter="32">
        <van-col span="12">
          <view class="tool-card management" bind:tap="openFlightTimeShare">
            <view class="tool-icon">
              <text class="emoji-icon">⏰</text>
              <view class="tool-icon-bg"></view>
            </view>
            <view class="tool-content">
              <view class="tool-name">分飞行时间</view>
              <view class="tool-desc">计算分享</view>
            </view>
          </view>
        </van-col>
        <van-col span="12">
          <view class="tool-card management" bind:tap="openPersonalChecklist">
            <view class="tool-icon">
              <text class="emoji-icon">✅</text>
              <view class="tool-icon-bg"></view>
            </view>
            <view class="tool-content">
              <view class="tool-name">个人检查单</view>
              <view class="tool-desc">自定义清单</view>
            </view>
          </view>
        </van-col>
      </van-row>
      
      <!-- 第二行：资质管理和长航线换班 -->
      <van-row gutter="32">
        <van-col span="12">
          <view class="tool-card management" bind:tap="openQualificationManager">
            <view class="tool-icon">
              <text class="emoji-icon">📜</text>
              <view class="tool-icon-bg"></view>
            </view>
            <view class="tool-content">
              <view class="tool-name">资质管理</view>
              <view class="tool-desc">证照管理</view>
            </view>
          </view>
        </van-col>
        <van-col span="12">
          <view class="tool-card management" bind:tap="openLongFlightCrewRotation">
            <view class="tool-icon">
              <text class="emoji-icon">🔄</text>
              <view class="tool-icon-bg"></view>
            </view>
            <view class="tool-content">
              <view class="tool-name">长航线换班</view>
              <view class="tool-desc">机组换班计算</view>
            </view>
          </view>
        </van-col>
      </van-row>
    </view>

    <!-- 飞行健康工具 -->
    <view class="category-section">
      <view class="category-header">
        <view class="category-icon">
          <text class="emoji-icon">🏥</text>
          <view class="icon-bg health-bg"></view>
        </view>
        <view class="category-info">
          <text class="category-title">飞行健康</text>
          <text class="category-desc">健康标准，安全飞行</text>
        </view>
      </view>
      <van-row gutter="32">
        <van-col span="12">
          <view class="tool-card health" bind:tap="openMedicalStandards">
            <view class="tool-icon">
              <text class="emoji-icon">📋</text>
              <view class="tool-icon-bg"></view>
            </view>
            <view class="tool-content">
              <view class="tool-name">体检标准</view>
              <view class="tool-desc">民航体检标准查询</view>
            </view>
          </view>
        </van-col>
        <van-col span="12">
          <view class="tool-card health" bind:tap="openMedicalStandards" data-target="health">
            <view class="tool-icon">
              <text class="emoji-icon">🩺</text>
              <view class="tool-icon-bg"></view>
            </view>
            <view class="tool-content">
              <view class="tool-name">健康管理</view>
              <view class="tool-desc">健康标准，安全飞行</view>
            </view>
          </view>
        </van-col>
      </van-row>
    </view>

    <!-- 特殊工具 -->
    <view class="category-section">
      <view class="category-header">
        <view class="category-icon">
          <text class="emoji-icon">🔧</text>
          <view class="icon-bg special-bg"></view>
        </view>
        <view class="category-info">
          <text class="category-title">特殊工具</text>
          <text class="category-desc">专业功能，高级应用</text>
        </view>
      </view>
      <van-row gutter="32">
        <van-col span="12">
          <view class="tool-card special" bind:tap="openSnowtamDecoder">
            <view class="tool-icon">
              <text class="emoji-icon">❄️</text>
              <view class="tool-icon-bg"></view>
            </view>
            <view class="tool-content">
              <view class="tool-name">雪情解码</view>
              <view class="tool-desc">SNOWTAM解码</view>
            </view>
          </view>
        </van-col>
        <van-col span="12">
          <view class="tool-card special" bind:tap="openSnowtamEncoder">
            <view class="tool-icon">
              <text class="emoji-icon">🌨️</text>
              <view class="tool-icon-bg"></view>
            </view>
            <view class="tool-content">
              <view class="tool-name">雪情编码</view>
              <view class="tool-desc">SNOWTAM编码</view>
            </view>
          </view>
        </van-col>
      </van-row>
    </view>

  </view>

  <!-- 关注公众号区域 -->
  <view class="category-section wechat-section">
    <view class="category-header">
      <view class="category-icon">
        <text class="emoji-icon">💬</text>
        <view class="icon-bg wechat-bg"></view>
      </view>
      <view class="category-info">
        <text class="category-title">飞行播客</text>
        <text class="category-desc">让我们用一种新的方式来学飞行</text>
      </view>
      <view class="category-badge">NEW</view>
    </view>
    
    <view class="wechat-content">
      <!-- 直接跳转按钮（使用最新API） -->
      <view class="direct-jump-action">
        <van-button 
          type="primary" 
          size="normal"
          class="jump-button"
          bind:click="jumpToOfficialAccount">
          进入飞行播客
        </van-button>
      </view>
    
      <!-- 直接显示二维码图片 -->
      <view class="qr-display">
        <image 
          class="qr-code-image" 
          src="/images/OfficialAccount.png"
          mode="aspectFit"
          bind:tap="previewQRCode"
          show-menu-by-longpress="{{true}}"
        />
        <text class="qr-hint">长按识别二维码关注"飞行播客"</text>
      </view>
    </view>
  </view>

  <!-- 应用信息卡片 -->
  <view class="app-info-card">
    <view class="info-header">
      <view class="info-icon">
        <text class="emoji-icon">ℹ️</text>
      </view>
      <text class="info-title">应用信息</text>
    </view>
    
    <van-cell-group class="info-group" border="{{ false }}">
      <van-cell 
        title="版本信息" 
        value="v2.0.0"
        icon="upgrade"
        class="info-cell"
        bind:click="onVersionTap"
      />

      <van-cell 
        title="意见反馈" 
        is-link 
        bind:click="feedback"
        icon="chat-o"
        class="info-cell"
      />
      <van-cell 
        title="关于作者" 
        is-link 
        bind:click="aboutUs"
        icon="contact"
        class="info-cell"
      />
    </van-cell-group>
  </view>

  <!-- 应用信息卡片 -->
  <view class="warning-notice">
    <view class="warning-icon">
      <text class="emoji-icon">⚠️</text>
    </view>
    <view class="warning-content">
      本小程序旨在帮助飞行员学习航空理论知识，包括性能计算、概念理解、规章条例等内容。但请注意：所有计算逻辑均基于作者个人理解编写，可能存在错误且未经官方验证。因此，本小程序所有数据仅供学习参考，严禁用于实际飞行操作！
    </view>
  </view>

  <!-- 公众号二维码弹窗 -->
  <van-popup
    show="{{ showQRCodeModal }}"
    bind:close="closeQRCodeModal"
    closeable="{{ true }}"
    close-icon-position="top-right"
    round="{{ true }}"
    custom-style="padding: 40rpx; background: linear-gradient(135deg, #f0f9ff 0%, #e0f7fa 100%);"
  >
    <view class="qr-modal-content">
      <text class="modal-title">关注公众号</text>
      <view class="qr-container">
        <image 
          class="qr-modal-image" 
          src="/images/OfficialAccount.png"
          mode="aspectFit"
          bind:tap="showQRCodeImage"
        />
        <text class="qr-title">飞行播客</text>
        <text class="qr-id">公众号：飞行播客</text>
        <text class="qr-modal-hint">长按识别二维码或点击查看大图</text>
        
        <view class="qr-benefits">
          <text class="benefits-title">关注后您将获得：</text>
          <view class="benefit-list">
            <view class="benefit-row">
              <text class="emoji-icon small">🎵</text>
              <text>精品飞行音频节目</text>
            </view>
            <view class="benefit-row">
              <text class="emoji-icon small">🔊</text>
              <text>创新的飞行学习方式</text>
            </view>
            <view class="benefit-row">
              <text class="emoji-icon small">👥</text>
              <text>飞行知识互动交流</text>
            </view>
          </view>
        </view>
        
        <view class="qr-actions">
          <van-button 
            type="primary" 
            size="normal"
            bind:click="copyOfficialAccountId"
            custom-style="margin-right: 20rpx;"
          >
            复制公众号ID
          </van-button>
          <van-button 
            type="default" 
            size="normal"
            bind:click="searchOfficialAccount"
          >
            搜索关注
          </van-button>
        </view>
      </view>
    </view>
  </van-popup>
</view>