<view class="container page-content">
  <!-- 主页面 - 所有功能模块一级展示 -->
  <view wx:if="{{ !selectedModule }}" class="main-page">
    
    <!-- 💡 机场打卡卡片 - 蓝色渐变风格 -->
    <view class="airport-checkin-card" bind:tap="openAirportFootprint">
      <view class="checkin-card-header">
        <view class="checkin-title-section">
          <text class="checkin-title">机场打卡</text>
          <text class="checkin-count">已打卡 {{ airportCheckins.length }} 个机场</text>
        </view>
        <text class="checkin-arrow">›</text>
      </view>
      
      <!-- 随机展示1个打卡机场 -->
      <view wx:if="{{ randomCheckins.length > 0 }}" class="checkin-airports-list">
        <view wx:for="{{ randomCheckins }}" wx:key="icao" class="checkin-airport-item">
          <view class="airport-main-info">
            <text class="airport-icao">{{ item.icao }}</text>
            <text class="airport-name">{{ item.shortName }}</text>
          </view>
          <text class="airport-date">{{ item.firstVisitDateText }}</text>
        </view>
      </view>
      
      <!-- 无打卡记录时的占位 -->
      <view wx:if="{{ !randomCheckins || randomCheckins.length === 0 }}" class="checkin-empty">
        <text class="checkin-empty-text">点击开始你的机场足迹之旅 ✈️</text>
      </view>
    </view>

    <!-- 飞行计算工具卡片网格 - 按使用频率自动排序 -->
    <view class="modules-grid">
        <view
          wx:for="{{ displayModules }}"
          wx:key="id"
          class="module-card"
          bind:tap="selectModule"
          data-module="{{ item.id }}"
        >
          <view class="module-icon">{{ item.icon }}</view>
          <view class="module-title">{{ item.title }}</view>
          <view class="module-desc">{{ item.description }}</view>
          <view class="module-count">
            <van-tag type="{{ item.tagType || 'primary' }}" size="medium">{{ item.category }}</van-tag>
          </view>
        </view>
    </view>

  </view>

  <!-- 具体计算页面 - 排除已改为独立页面的模块 -->
  <view wx:if="{{ selectedModule && selectedModule !== 'descent' && selectedModule !== 'crosswind' && selectedModule !== 'turn' && selectedModule !== 'glideslope' && selectedModule !== 'detour' && selectedModule !== 'gradient' && selectedModule !== 'distance' && selectedModule !== 'speed' && selectedModule !== 'temperature' && selectedModule !== 'weight' && selectedModule !== 'pressure' && selectedModule !== 'isa' }}" class="calculation-page">
    <view class="module-header">
      <view class="back-btn" bind:tap="backToModules">← 返回</view>
      <view class="module-title">{{ moduleTitle }}</view>
    </view>

    <!-- 下降率计算模块 -->
    <view wx:if="{{ selectedModule === 'descent' }}" class="calculation-module">
      <view class="input-section">
        <view class="input-group">
          <view class="input-label">📏 当前高度</view>
          <van-field
            value="{{ flightCalcData.descent.currentAltitude }}"
            placeholder="请输入当前高度"
            type="digit"
            bind:change="onCurrentAltitudeChange"
          >
            <view slot="right-icon" class="unit-label">英尺</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">🎯 目标高度</view>
          <van-field
            value="{{ flightCalcData.descent.targetAltitude }}"
            placeholder="请输入目标高度"
            type="digit"
            bind:change="onTargetAltitudeChange"
          >
            <view slot="right-icon" class="unit-label">英尺</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">📍 相距距离</view>
          <van-field
            value="{{ flightCalcData.descent.distanceNM }}"
            placeholder="请输入距离"
            type="digit"
            bind:change="onDistanceNMChange"
          >
            <view slot="right-icon" class="unit-label">海里</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">⚡ 当前地速</view>
          <van-field
            value="{{ flightCalcData.descent.currentGroundSpeed }}"
            placeholder="请输入地速"
            type="digit"
            bind:change="onCurrentGroundSpeedChange"
          >
            <view slot="right-icon" class="unit-label">节</view>
          </van-field>
        </view>
      </view>

      <view class="action-buttons">
        <van-button type="primary" bind:click="calculateDescentRate" block>
          🚀 计算下降率
        </van-button>
        <van-button type="default" bind:click="clearDescentRate" block>
          🗑️ 清空数据
        </van-button>
      </view>

      <!-- 横幅广告 -->

      <view wx:if="{{ flightCalcData.descent.descentRate }}" class="result-section">
        <view class="result-title">📊 计算结果</view>
        <view class="result-grid">
          <view class="result-item">
            <view class="result-label">所需下降率</view>
            <view class="result-value">{{ flightCalcData.descent.descentRate }} 英尺/分钟</view>
          </view>
          <view class="result-item">
            <view class="result-label">下降角度</view>
            <view class="result-value">{{ flightCalcData.descent.descentAngle }}°</view>
          </view>
          <view class="result-item">
            <view class="result-label">下降时间</view>
            <view class="result-value">{{ flightCalcData.descent.timeToDescend }} 分钟</view>
          </view>
          <view class="result-item">
            <view class="result-label">下降梯度</view>
            <view class="result-value">{{ flightCalcData.descent.descentGradient }}%</view>
          </view>
        </view>
      </view>
    </view>

    <!-- 侧风分量计算模块 -->
    <view wx:if="{{ selectedModule === 'crosswind' }}" class="calculation-module">
      <view class="input-section">
        <view class="input-group">
          <view class="input-label">✈️ 真空速 (TAS)</view>
          <van-field
            value="{{ flightCalcData.crosswind.crosswindTrueAirspeed }}"
            placeholder="请输入真空速"
            type="digit"
            bind:change="onCrosswindTrueAirspeedChange"
          >
            <view slot="right-icon" class="unit-label">节</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">🧭 航向</view>
          <van-field
            value="{{ flightCalcData.crosswind.crosswindHeading }}"
            placeholder="请输入航向"
            type="digit"
            bind:change="onCrosswindHeadingChange"
          >
            <view slot="right-icon" class="unit-label">度</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">🌪️ 风向</view>
          <van-field
            value="{{ flightCalcData.crosswind.crosswindDirection }}"
            placeholder="请输入风向"
            type="digit"
            bind:change="onCrosswindDirectionChange"
          >
            <view slot="right-icon" class="unit-label">度</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">💨 风速</view>
          <van-field
            value="{{ flightCalcData.crosswind.crosswindSpeed }}"
            placeholder="请输入风速"
            type="digit"
            bind:change="onCrosswindSpeedChange"
          >
            <view slot="right-icon" class="unit-label">节</view>
          </van-field>
        </view>
      </view>

      <view class="action-buttons">
        <van-button type="primary" bind:click="calculateCrosswind" block>
          🚀 计算侧风分量
        </van-button>
        <van-button type="default" bind:click="clearCrosswind" block>
          🗑️ 清空数据
        </van-button>
      </view>

      <!-- 横幅广告 -->

      <view wx:if="{{ flightCalcData.crosswind.crosswindComponent }}" class="result-section">
        <view class="result-title">📊 计算结果</view>
        <view class="result-grid">
          <view class="result-item">
            <view class="result-label">侧风分量</view>
            <view class="result-value">{{ flightCalcData.crosswind.crosswindDisplayText }}</view>
          </view>
          <view class="result-item">
            <view class="result-label">顶风分量</view>
            <view class="result-value">{{ flightCalcData.crosswind.headwindDisplayText }}</view>
          </view>
          <view class="result-item">
            <view class="result-label">偏流角</view>
            <view class="result-value">{{ flightCalcData.crosswind.driftAngle }}°</view>
          </view>
          <view class="result-item">
            <view class="result-label">地速</view>
            <view class="result-value">{{ flightCalcData.crosswind.groundSpeed }} 节</view>
          </view>
          <view class="result-item">
            <view class="result-label">航迹</view>
            <view class="result-value">{{ flightCalcData.crosswind.track }}°</view>
          </view>
        </view>

        <!-- 风向罗盘 -->
        <view class="compass-section">
          <view class="compass-title">🧭 风向罗盘</view>
          <view class="compass-container">
            <view class="compass-needle wind-needle" style="transform: rotate({{ flightCalcData.crosswind.windAngle }}deg);"></view>
            <view class="compass-needle heading-needle" style="transform: rotate({{ flightCalcData.crosswind.headingAngle }}deg);"></view>
            <view class="compass-needle track-needle" style="transform: rotate({{ flightCalcData.crosswind.trackAngle }}deg);"></view>
            <view class="compass-degrees north">{{ flightCalcData.crosswind.compassNorth }}</view>
            <view class="compass-degrees east">{{ flightCalcData.crosswind.compassEast }}</view>
            <view class="compass-degrees south">{{ flightCalcData.crosswind.compassSouth }}</view>
            <view class="compass-degrees west">{{ flightCalcData.crosswind.compassWest }}</view>
            <view class="compass-center"></view>
          </view>
          <view class="compass-legend">
            <view class="legend-item">
              <view class="legend-color wind-color"></view>
              <text>风向</text>
            </view>
            <view class="legend-item">
              <view class="legend-color heading-color"></view>
              <text>航向</text>
            </view>
            <view class="legend-item">
              <view class="legend-color track-color"></view>
              <text>航迹</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- 转弯半径计算模块 -->
    <view wx:if="{{ selectedModule === 'turn' }}" class="calculation-module">
      <view class="input-section">
        <view class="input-group">
          <view class="input-label">📐 飞机坡度</view>
          <van-field
            value="{{ flightCalcData.turn.turnBankAngle }}"
            placeholder="请输入飞机坡度"
            type="digit"
            bind:change="onTurnBankAngleChange"
          >
            <view slot="right-icon" class="unit-label">度</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">⚡ 地速</view>
          <van-field
            value="{{ flightCalcData.turn.turnGroundSpeed }}"
            placeholder="请输入地速"
            type="digit"
            bind:change="onTurnGroundSpeedChange"
          >
            <view slot="right-icon" class="unit-label">节</view>
          </van-field>
        </view>
      </view>

      <view class="action-buttons">
        <van-button type="primary" bind:click="calculateTurnRadius" block>
          🚀 计算转弯半径
        </van-button>
        <van-button type="default" bind:click="clearTurn" block>
          🗑️ 清空数据
        </van-button>
      </view>

      <view wx:if="{{ flightCalcData.turn.turnRadiusMeters }}" class="result-section">
        <view class="result-title">📊 计算结果</view>
        <view class="result-grid">
          <view class="result-item">
            <view class="result-label">转弯半径(米)</view>
            <view class="result-value">{{ flightCalcData.turn.turnRadiusMeters }} 米</view>
          </view>
          <view class="result-item">
            <view class="result-label">转弯半径(英尺)</view>
            <view class="result-value">{{ flightCalcData.turn.turnRadiusFeet }} 英尺</view>
          </view>
          <view class="result-item">
            <view class="result-label">转弯半径(海里)</view>
            <view class="result-value">{{ flightCalcData.turn.turnRadiusNauticalMiles }} 海里</view>
          </view>
          <view class="result-item">
            <view class="result-label">转弯率</view>
            <view class="result-value">{{ flightCalcData.turn.turnRate }} 度/秒</view>
          </view>
          <view class="result-item">
            <view class="result-label">360°转弯时间</view>
            <view class="result-value">{{ flightCalcData.turn.turnTime360 }} 秒</view>
          </view>
        </view>
      </view>
    </view>

    <!-- 五边高度计算模块 -->
    <view wx:if="{{ selectedModule === 'glideslope' }}" class="calculation-module">
      <view class="input-section">
        <view class="input-group">
          <view class="input-label">📐 下滑角</view>
          <van-field
            value="{{ flightCalcData.glideslope.glideslopeAngle }}"
            placeholder="请输入下滑角"
            type="digit"
            bind:change="onGlideslopeAngleChange"
          >
            <view slot="right-icon" class="unit-label">度</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">📍 距离跑道头</view>
          <van-field
            value="{{ flightCalcData.glideslope.distanceFromThreshold }}"
            placeholder="请输入距离"
            type="digit"
            bind:change="onDistanceFromThresholdChange"
          >
            <view slot="right-icon" class="unit-label">海里</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">🏔️ 机场标高</view>
          <van-field
            value="{{ flightCalcData.glideslope.airportElevation }}"
            placeholder="请输入机场标高"
            type="digit"
            bind:change="onAirportElevationChange"
          >
            <view slot="right-icon" class="unit-label">英尺</view>
          </van-field>
        </view>
      </view>

      <view class="action-buttons">
        <van-button type="primary" bind:click="calculateGlideslope" block>
          🚀 计算下滑线高度
        </van-button>
        <van-button type="default" bind:click="clearGlideslope" block>
          🗑️ 清空数据
        </van-button>
      </view>

      <view wx:if="{{ flightCalcData.glideslope.glideslopeAltitude }}" class="result-section">
        <view class="result-title">📊 计算结果</view>
        <view class="result-grid">
          <view class="result-item">
            <view class="result-label">AGL高度</view>
            <view class="result-value">{{ flightCalcData.glideslope.glideslopeAltitude }} 英尺</view>
          </view>
          <view class="result-item">
            <view class="result-label">QNH高度</view>
            <view class="result-value">{{ flightCalcData.glideslope.glideslopeAbsoluteAltitude }} 英尺</view>
          </view>
        </view>
      </view>
    </view>

    <!-- 绕飞耗油计算模块 -->
    <view wx:if="{{ selectedModule === 'detour' }}" class="calculation-module">
      <view class="input-section">
        <view class="input-group">
          <view class="input-label">📍 申请偏离距离</view>
          <van-field
            value="{{ flightCalcData.detour.detourDistance }}"
            placeholder="请输入偏离距离"
            type="digit"
            bind:change="onDetourDistanceChange"
          >
            <view slot="right-icon" class="unit-label">海里</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">⚡ 地速</view>
          <van-field
            value="{{ flightCalcData.detour.detourGroundSpeed }}"
            placeholder="请输入地速"
            type="digit"
            bind:change="onDetourGroundSpeedChange"
          >
            <view slot="right-icon" class="unit-label">节</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">⛽ 油耗</view>
          <van-field
            value="{{ flightCalcData.detour.detourFuelConsumption }}"
            placeholder="请输入油耗"
            type="digit"
            bind:change="onDetourFuelConsumptionChange"
          >
            <view slot="right-icon" class="unit-label">KG/H</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">📐 偏航角度</view>
          <van-field
            value="{{ flightCalcData.detour.detourDepartureAngle }}"
            placeholder="请输入偏航角度"
            type="digit"
            bind:change="onDetourDepartureAngleChange"
          >
            <view slot="right-icon" class="unit-label">度</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">📐 返回角度</view>
          <van-field
            value="{{ flightCalcData.detour.detourReturnAngle }}"
            placeholder="请输入返回角度"
            type="digit"
            bind:change="onDetourReturnAngleChange"
          >
            <view slot="right-icon" class="unit-label">度</view>
          </van-field>
        </view>
      </view>

      <view class="action-buttons">
        <van-button type="primary" bind:click="calculateDetourFuel" block>
          🚀 计算绕飞耗油
        </van-button>
        <van-button type="default" bind:click="clearDetourFuel" block>
          🗑️ 清空数据
        </van-button>
      </view>

      <view wx:if="{{ flightCalcData.detour.detourFuelResult }}" class="result-section">
        <view class="result-title">📊 计算结果</view>
        <view class="result-grid">
          <view class="result-item">
            <view class="result-label">额外燃油消耗</view>
            <view class="result-value">{{ flightCalcData.detour.detourFuelResult }}</view>
          </view>
          <view class="result-item">
            <view class="result-label">额外飞行时间</view>
            <view class="result-value">{{ flightCalcData.detour.detourTimeResult }}</view>
          </view>
          <view class="result-item">
            <view class="result-label">实际多飞距离</view>
            <view class="result-value">{{ flightCalcData.detour.detourActualDistance }} 海里</view>
          </view>
          <view class="result-item">
            <view class="result-label">偏航段距离</view>
            <view class="result-value">{{ flightCalcData.detour.detourDepartureSegment }} 海里</view>
          </view>
          <view class="result-item">
            <view class="result-label">返回段距离</view>
            <view class="result-value">{{ flightCalcData.detour.detourReturnSegment }} 海里</view>
          </view>
          <view class="result-item">
            <view class="result-label">原直线距离</view>
            <view class="result-value">{{ flightCalcData.detour.detourDirectDistance }} 海里</view>
          </view>
        </view>

        <view wx:if="{{ flightCalcData.detour.detourCalculationDetails }}" class="calculation-details">
          <view class="details-title">📋 计算详情</view>
          <view class="details-content">{{ flightCalcData.detour.detourCalculationDetails }}</view>
        </view>
      </view>
    </view>
  </view>

  <!-- 特殊计算页面 -->
  <view wx:if="{{ selectedModule && (selectedModule === 'coldTemp' || selectedModule === 'pitch' || selectedModule === 'gpws') }}" class="calculation-page">
    <view class="module-header">
      <view class="back-btn" bind:tap="backToModules">← 返回</view>
      <view class="module-title">{{ moduleTitle }}</view>
    </view>

    <!-- 温度修正计算模块 -->
    <view wx:if="{{ selectedModule === 'coldTemp' }}" class="calculation-module">
      <view class="input-section">
        <view class="section-title">基础参数</view>
        
        <view class="input-group">
          <view class="input-label">🏔️ 机场标高</view>
          <van-field
            value="{{ aviationCalcData.coldTemp.airportElevation }}"
            placeholder="例如: 500"
            type="digit"
            bind:change="onColdTempAirportElevationChange"
            input-align="right"
          >
            <view slot="right-icon" class="unit-label">英尺</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">🌡️ 机场温度</view>
          <van-field
            value="{{ aviationCalcData.coldTemp.airportTemperature }}"
            placeholder="支持负数，如: -20 或 15.5"
            type="text"
            bind:change="onColdTempAirportTemperatureChange"
            input-align="right"
          >
            <view slot="right-icon" class="unit-label">°C</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">📍 IF高度</view>
          <van-field
            value="{{ aviationCalcData.coldTemp.ifAltitude }}"
            placeholder="可以不输入"
            type="digit"
            bind:change="onColdTempIfAltitudeChange"
            input-align="right"
          >
            <view slot="right-icon" class="unit-label">英尺</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">🎯 FAF高度</view>
          <van-field
            value="{{ aviationCalcData.coldTemp.fafAltitude }}"
            placeholder="可以不输入"
            type="digit"
            bind:change="onColdTempFafAltitudeChange"
            input-align="right"
          >
            <view slot="right-icon" class="unit-label">英尺</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">🛬 DA高度</view>
          <van-field
            value="{{ aviationCalcData.coldTemp.daAltitude }}"
            placeholder="可以不输入"
            type="digit"
            bind:change="onColdTempDaAltitudeChange"
            input-align="right"
          >
            <view slot="right-icon" class="unit-label">英尺</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">🔄 复飞高度</view>
          <van-field
            value="{{ aviationCalcData.coldTemp.missedAltitude }}"
            placeholder="可以不输入"
            type="digit"
            bind:change="onColdTempMissedAltitudeChange"
            input-align="right"
          >
            <view slot="right-icon" class="unit-label">英尺</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">📏 其他高度</view>
          <van-field
            value="{{ aviationCalcData.coldTemp.otherAltitude }}"
            placeholder="可以不输入"
            type="digit"
            bind:change="onColdTempOtherAltitudeChange"
            input-align="right"
          >
            <view slot="right-icon" class="unit-label">英尺</view>
          </van-field>
        </view>
      </view>

      <view class="input-section">
        <view class="section-title">FPA影响分析 (可选)</view>
        
        <view class="switch-group">
          <view class="switch-label">计算FPA影响 (针对FAF)</view>
          <van-switch 
            checked="{{ aviationCalcData.coldTemp.isFafPoint }}" 
            bind:change="toggleColdTempFafPoint"
          />
        </view>

        <view wx:if="{{ aviationCalcData.coldTemp.isFafPoint }}" class="input-group">
          <view class="input-label">📏 FAF到跑道头距离</view>
          <van-field
            value="{{ aviationCalcData.coldTemp.fafDistance }}"
            placeholder="例如: 8.0"
            type="digit"
            bind:change="onColdTempFafDistanceChange"
            input-align="right"
          >
            <view slot="right-icon" class="unit-label">海里</view>
          </van-field>
        </view>
      </view>

      <view class="action-buttons">
        <van-button type="primary" bind:click="calculateColdTemp" block>
          🚀 计算温度修正
        </van-button>
      </view>

      <!-- 计算结果 -->
      <view wx:if="{{ aviationCalcData.coldTemp.result && aviationCalcData.coldTemp.result.results }}" class="result-section">
        <view class="result-title">📊 计算结果</view>
        <view class="result-list">
          <view wx:for="{{ aviationCalcData.coldTemp.result.results }}" wx:key="name" class="result-item">
            <view class="result-name">{{ item.name }}</view>
            <view class="result-detail">
              <view class="result-original">原高度: {{ item.originalAltitude }} 英尺</view>
              <view class="result-correction">修正值: {{ item.correctionFeet >= 0 ? '+' : '' }}{{ item.correctionFeet }} 英尺</view>
              <view class="result-final">修正后: {{ item.correctedAltitudeFeet }} 英尺</view>
            </view>
            
            <view wx:if="{{ item.vpaInfo }}" class="result-warning">
              <view class="warning-title">FPA分析</view>
              <view class="warning-message">{{ item.vpaInfo.warningMessage }}</view>
            </view>
          </view>
        </view>
      </view>

      <!-- 错误信息 -->
      <view wx:if="{{ aviationCalcData.coldTemp.error }}" class="error-section">
        <view class="error-title">⚠️ 错误信息</view>
        <view class="error-message">{{ aviationCalcData.coldTemp.error }}</view>
      </view>
    </view>

    <!-- 梯度计算模块 -->
    <view wx:if="{{ selectedModule === 'gradient' }}" class="calculation-module">
      <view class="input-section">
        <view class="section-title">输入参数</view>
        
        <view class="input-group">
          <view class="input-label">📐 梯度</view>
          <van-field
            value="{{ aviationCalcData.gradient.gradientInput }}"
            placeholder="请输入梯度"
            type="digit"
            bind:change="onGradientInputChange"
            input-align="right"
          >
            <view slot="right-icon" class="unit-label">%</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">🌬️ 地速</view>
          <van-field
            value="{{ aviationCalcData.gradient.groundSpeedInput }}"
            placeholder="请输入地速"
            type="digit"
            bind:change="onGroundSpeedInputChange"
            input-align="right"
          >
            <view slot="right-icon" class="unit-label">节</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">⬆️ 升降率</view>
          <van-field
            value="{{ aviationCalcData.gradient.verticalSpeedInput }}"
            placeholder="请输入升降率"
            type="digit"
            bind:change="onVerticalSpeedInputChange"
            input-align="right"
          >
            <view slot="right-icon" class="unit-label">ft/min</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">📐 角度</view>
          <van-field
            value="{{ aviationCalcData.gradient.angleInput }}"
            placeholder="请输入角度"
            type="digit"
            bind:change="onAngleInputChange"
            input-align="right"
          >
            <view slot="right-icon" class="unit-label">度</view>
          </van-field>
        </view>
      </view>

      <view class="action-buttons">
        <van-button type="primary" bind:click="convertGradient" block>
          🚀 开始换算
        </van-button>
        <van-button type="default" bind:click="clearGradient" block>
          🗑️ 清空数据
        </van-button>
      </view>

      <!-- 计算结果 -->
      <view wx:if="{{ aviationCalcData.gradient.gradientResult || aviationCalcData.gradient.verticalSpeedResult || aviationCalcData.gradient.angleResult }}" class="result-section">
        <view class="result-title">📊 计算结果</view>
        <view class="result-grid">
          <view wx:if="{{ aviationCalcData.gradient.gradientResult }}" class="result-item">
            <view class="result-label">梯度</view>
            <view class="result-value">{{ aviationCalcData.gradient.gradientResult }}%</view>
          </view>
          <view wx:if="{{ aviationCalcData.gradient.verticalSpeedResult }}" class="result-item">
            <view class="result-label">升降率</view>
            <view class="result-value">{{ aviationCalcData.gradient.verticalSpeedResult }} ft/min</view>
          </view>
          <view wx:if="{{ aviationCalcData.gradient.angleResult }}" class="result-item">
            <view class="result-label">角度</view>
            <view class="result-value">{{ aviationCalcData.gradient.angleResult }}°</view>
          </view>
        </view>
      </view>
    </view>

    <!-- PITCH警告计算模块 -->
    <view wx:if="{{ selectedModule === 'pitch' }}" class="calculation-module">
      <view class="input-section">
        <view class="section-title">飞机型号选择</view>
        
        <view class="picker-group">
          <view class="picker-label">飞机型号</view>
          <view class="picker-value" bind:tap="showAircraftPicker">
            {{ aviationCalcData.pitch.aircraftModelDisplay }}
          </view>
        </view>
      </view>

      <view class="input-section">
        <view class="section-title">飞行参数</view>
        
        <view class="input-group">
          <view class="input-label">📡 无线电高度 (RA)</view>
          <van-field
            value="{{ aviationCalcData.pitch.radioHeight }}"
            placeholder="例如: 15"
            type="digit"
            bind:change="onPitchRadioHeightChange"
            input-align="right"
          >
            <view slot="right-icon" class="unit-label">英尺</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">✈️ 当前飞机姿态</view>
          <van-field
            value="{{ aviationCalcData.pitch.currentAttitude }}"
            placeholder="例如: 8.0"
            type="digit"
            bind:change="onPitchCurrentAttitudeChange"
            input-align="right"
          >
            <view slot="right-icon" class="unit-label">度</view>
          </van-field>
        </view>

        <view class="input-group">
          <view class="input-label">📈 飞机姿态变化率</view>
          <van-field
            value="{{ aviationCalcData.pitch.attitudeChangeRate }}"
            placeholder="例如: 1.5"
            type="digit"
            bind:change="onPitchAttitudeChangeRateChange"
            input-align="right"
          >
            <view slot="right-icon" class="unit-label">度/秒</view>
          </van-field>
        </view>
      </view>

      <view class="action-buttons">
        <van-button type="primary" bind:click="calculatePitchPitch" block>
          🚀 计算 PITCH PITCH 警告
        </van-button>
      </view>

      <!-- 计算结果 -->
      <view wx:if="{{ aviationCalcData.pitch.result }}" class="result-section">
        <view class="result-title">📊 计算结果</view>
        <view class="result-grid">
          <view class="result-item">
            <view class="result-label">预测飞机姿态</view>
            <view class="result-value">{{ aviationCalcData.pitch.predictiveAttitude }}°</view>
          </view>
          <view class="result-item">
            <view class="result-label">触发阈值</view>
            <view class="result-value">{{ aviationCalcData.pitch.threshold }}°</view>
          </view>
          <view class="result-item {{ aviationCalcData.pitch.shouldTrigger ? 'warning-item' : 'normal-item' }}">
            <view class="result-label">警告状态</view>
            <view class="result-value">{{ aviationCalcData.pitch.warningStatus }}</view>
          </view>
        </view>
      </view>

      <!-- 默认前提条件 -->
      <view wx:if="{{ aviationCalcData.pitch.result }}" class="info-section">
        <view class="info-title">ℹ️ 默认前提条件</view>
        <view class="info-list">
          <view class="info-item">飞行阶段: 着陆阶段</view>
          <view class="info-item">自动驾驶仪: 未接通</view>
          <view class="info-item">无线电高度: 有效</view>
          <view wx:if="{{ aviationCalcData.pitch.aircraftModel !== 'A330-200' && aviationCalcData.pitch.aircraftModel !== 'A330-300' }}" class="info-item">擦尾保护引脚: 已激活</view>
          <view wx:if="{{ aviationCalcData.pitch.aircraftModel !== 'A330-200' && aviationCalcData.pitch.aircraftModel !== 'A330-300' }}" class="info-item">推力手柄位置: 非起飞位</view>
          <view wx:if="{{ aviationCalcData.pitch.aircraftModel !== 'A330-200' && aviationCalcData.pitch.aircraftModel !== 'A330-300' }}" class="info-item">低高度条件: RA &lt; 20英尺</view>
          <view wx:if="{{ aviationCalcData.pitch.aircraftModel === 'A330-200' || aviationCalcData.pitch.aircraftModel === 'A330-300' }}" class="info-item">低高度条件: RA &lt; 25英尺</view>
        </view>
      </view>
    </view>

    <!-- GPWS警告触发计算模块 -->
    <view wx:if="{{ selectedModule === 'gpws' }}" class="calculation-module gpws-module">
      <!-- GPWS模式选择 -->
      <view class="gpws-mode-selector">
        <view class="section-title">🚨 GPWS模式选择</view>
        <view class="mode-tabs">
          <view class="mode-tab {{ aviationCalcData.gpws.activeMode === 'mode1' ? 'active' : '' }}" 
                bind:tap="selectGPWSMode" data-mode="mode1">
            Mode 1
          </view>
          <view class="mode-tab {{ aviationCalcData.gpws.activeMode === 'mode2' ? 'active' : '' }}" 
                bind:tap="selectGPWSMode" data-mode="mode2">
            Mode 2
          </view>
          <view class="mode-tab {{ aviationCalcData.gpws.activeMode === 'mode3' ? 'active' : '' }}" 
                bind:tap="selectGPWSMode" data-mode="mode3">
            Mode 3
          </view>
          <view class="mode-tab {{ aviationCalcData.gpws.activeMode === 'mode4' ? 'active' : '' }}" 
                bind:tap="selectGPWSMode" data-mode="mode4">
            Mode 4
          </view>
          <view class="mode-tab {{ aviationCalcData.gpws.activeMode === 'mode5' ? 'active' : '' }}" 
                bind:tap="selectGPWSMode" data-mode="mode5">
            Mode 5
          </view>
        </view>
      </view>

      <!-- Mode 1 - 下降率过大 -->
      <view wx:if="{{ aviationCalcData.gpws.activeMode === 'mode1' }}" class="gpws-mode-content">
        <view class="mode-header">
          <view class="mode-title">Mode 1 - 下降率过大</view>
          <view class="mode-desc">监控过度下降率，防止撞地</view>
        </view>

        <view class="input-section">
          <view class="input-group">
            <view class="input-label">📡 无线电高度 (RA)</view>
            <van-field
              value="{{ aviationCalcData.gpws.mode1.ra }}"
              placeholder="请输入无线电高度"
              type="digit"
              bind:change="onGPWSMode1RAChange"
              input-align="right"
            >
              <view slot="right-icon" class="unit-label">英尺</view>
            </van-field>
          </view>

          <view class="input-group">
            <view class="input-label">📉 下降率</view>
            <van-field
              value="{{ aviationCalcData.gpws.mode1.descentRate }}"
              placeholder="请输入下降率"
              type="digit"
              bind:change="onGPWSMode1DescentRateChange"
              input-align="right"
            >
              <view slot="right-icon" class="unit-label">ft/min</view>
            </van-field>
          </view>
        </view>

        <view class="action-buttons">
          <van-button type="primary" bind:click="calculateGPWSMode1" block>
            🚀 分析 Mode 1
          </van-button>
        </view>

        <!-- Mode 1 结果 -->
        <view wx:if="{{ aviationCalcData.gpws.mode1.thresholdResult }}" class="result-section">
          <view wx:if="{{ aviationCalcData.gpws.mode1.thresholdResult.valid }}" class="gpws-result">
            <view class="result-title">📊 Mode 1 分析结果</view>
            <view class="gpws-status {{ aviationCalcData.gpws.mode1.thresholdResult.type }}">
              <view class="status-text">{{ aviationCalcData.gpws.mode1.thresholdResult.status }}</view>
              <view class="status-message">{{ aviationCalcData.gpws.mode1.thresholdResult.message }}</view>
            </view>
            
            <view class="result-grid">
              <view class="result-item">
                <view class="result-label">SINK RATE门限</view>
                <view class="result-value">{{ aviationCalcData.gpws.mode1.thresholdResult.sinkRateThreshold }} ft/min</view>
              </view>
              <view class="result-item">
                <view class="result-label">PULL UP门限</view>
                <view class="result-value">{{ aviationCalcData.gpws.mode1.thresholdResult.pullUpThreshold }} ft/min</view>
              </view>
              <view wx:if="{{ aviationCalcData.gpws.mode1.thresholdResult.warningLevel }}" class="result-item">
                <view class="result-label">警告级别</view>
                <view class="result-value">{{ aviationCalcData.gpws.mode1.thresholdResult.warningLevel }}</view>
              </view>
            </view>
          </view>
          
          <view wx:else class="error-section">
            <view class="error-title">⚠️ 输入错误</view>
            <view class="error-message">{{ aviationCalcData.gpws.mode1.thresholdResult.message }}</view>
          </view>
        </view>
      </view>

      <!-- Mode 2 - 地形接近率过大 -->
      <view wx:if="{{ aviationCalcData.gpws.activeMode === 'mode2' }}" class="gpws-mode-content">
        <view class="mode-header">
          <view class="mode-title">Mode 2 - 地形接近率过大</view>
          <view class="mode-desc">监控过度地形接近率</view>
        </view>

        <view class="input-section">
          <view class="input-group">
            <view class="input-label">📡 无线电高度 (RA)</view>
            <van-field
              value="{{ aviationCalcData.gpws.mode2.ra }}"
              placeholder="请输入无线电高度"
              type="digit"
              bind:change="onGPWSMode2RAChange"
              input-align="right"
            >
              <view slot="right-icon" class="unit-label">英尺</view>
            </van-field>
          </view>

          <view class="input-group">
            <view class="input-label">⬇️ 地形接近率 (TCR)</view>
            <van-field
              value="{{ aviationCalcData.gpws.mode2.tcr }}"
              placeholder="请输入地形接近率"
              type="digit"
              bind:change="onGPWSMode2TCRChange"
              input-align="right"
            >
              <view slot="right-icon" class="unit-label">ft/min</view>
            </van-field>
          </view>

          <view class="input-group">
            <view class="input-label">🌬️ 空速</view>
            <van-field
              value="{{ aviationCalcData.gpws.mode2.airspeed }}"
              placeholder="请输入空速（可选）"
              type="digit"
              bind:change="onGPWSMode2AirspeedChange"
              input-align="right"
            >
              <view slot="right-icon" class="unit-label">节</view>
            </van-field>
          </view>
        </view>

        <!-- 配置状态 -->
        <view class="input-section">
          <view class="section-title">🔧 飞机配置</view>
          <view class="switch-group">
            <view class="switch-item">
              <view class="switch-label">襟翼在着陆构型</view>
              <van-switch 
                checked="{{ aviationCalcData.gpws.mode2.flapsInLanding }}"
                bind:change="onGPWSMode2FlapsChange"
              />
            </view>
            <view class="switch-item">
              <view class="switch-label">起落架放下</view>
              <van-switch 
                checked="{{ aviationCalcData.gpws.mode2.gearDown }}"
                bind:change="onGPWSMode2GearChange"
              />
            </view>
            <view class="switch-item">
              <view class="switch-label">ILS进近模式</view>
              <van-switch 
                checked="{{ aviationCalcData.gpws.mode2.ilsMode }}"
                bind:change="onGPWSMode2ILSChange"
              />
            </view>
            <view class="switch-item">
              <view class="switch-label">TAD激活</view>
              <van-switch 
                checked="{{ aviationCalcData.gpws.mode2.tadActive }}"
                bind:change="onGPWSMode2TADChange"
              />
            </view>
          </view>
        </view>

        <view class="action-buttons">
          <van-button type="primary" bind:click="calculateGPWSMode2" block>
            🚀 分析 Mode 2
          </van-button>
        </view>

        <!-- Mode 2 结果 -->
        <view wx:if="{{ aviationCalcData.gpws.mode2.result }}" class="result-section">
          <view class="gpws-result">
            <view class="result-title">📊 Mode 2 分析结果</view>
            <view class="gpws-status {{ aviationCalcData.gpws.mode2.result.type }}">
              <view class="status-text">{{ aviationCalcData.gpws.mode2.result.status }}</view>
              <view class="status-message">{{ aviationCalcData.gpws.mode2.result.message }}</view>
            </view>
            
            <view wx:if="{{ aviationCalcData.gpws.mode2.result.thresholdInfo }}" class="result-detail">
              <view class="detail-title">📋 详细信息</view>
              <view class="detail-text">{{ aviationCalcData.gpws.mode2.result.thresholdInfo }}</view>
              <view wx:if="{{ aviationCalcData.gpws.mode2.result.envelopeInfo }}" class="detail-text">{{ aviationCalcData.gpws.mode2.result.envelopeInfo }}</view>
            </view>
          </view>
        </view>
      </view>

      <!-- Mode 3 - 复飞时高度损失 -->
      <view wx:if="{{ aviationCalcData.gpws.activeMode === 'mode3' }}" class="gpws-mode-content">
        <view class="mode-header">
          <view class="mode-title">Mode 3 - 复飞时高度损失</view>
          <view class="mode-desc">检测复飞后的异常高度损失</view>
        </view>

        <view class="input-section">
          <view class="input-group">
            <view class="input-label">📡 无线电高度 (RA)</view>
            <van-field
              value="{{ aviationCalcData.gpws.mode3.ra }}"
              placeholder="请输入无线电高度"
              type="digit"
              bind:change="onGPWSMode3RAChange"
              input-align="right"
            >
              <view slot="right-icon" class="unit-label">英尺</view>
            </van-field>
          </view>

          <view class="input-group">
            <view class="input-label">📉 实际高度损失</view>
            <van-field
              value="{{ aviationCalcData.gpws.mode3.altitudeLoss }}"
              placeholder="请输入高度损失"
              type="digit"
              bind:change="onGPWSMode3AltitudeLossChange"
              input-align="right"
            >
              <view slot="right-icon" class="unit-label">英尺</view>
            </van-field>
          </view>
        </view>

        <view class="action-buttons">
          <van-button type="primary" bind:click="calculateGPWSMode3" block>
            🚀 分析 Mode 3
          </van-button>
          <van-button type="default" bind:click="resetGPWSMode3" block>
            🗑️ 重置
          </van-button>
        </view>

        <!-- Mode 3 结果 -->
        <view wx:if="{{ aviationCalcData.gpws.mode3.result }}" class="result-section">
          <view class="gpws-result">
            <view class="result-title">📊 Mode 3 分析结果</view>
            <view class="gpws-status {{ aviationCalcData.gpws.mode3.result.type }}">
              <view class="status-text">{{ aviationCalcData.gpws.mode3.result.status }}</view>
              <view class="status-message">{{ aviationCalcData.gpws.mode3.result.message }}</view>
            </view>
            
            <view wx:if="{{ aviationCalcData.gpws.mode3.result.thresholdInfo }}" class="result-detail">
              <view class="detail-title">📋 详细信息</view>
              <view class="detail-text">{{ aviationCalcData.gpws.mode3.result.thresholdInfo }}</view>
              <view wx:if="{{ aviationCalcData.gpws.mode3.result.detailedInfo }}" class="detail-text">{{ aviationCalcData.gpws.mode3.result.detailedInfo }}</view>
            </view>
          </view>
        </view>
      </view>

      <!-- Mode 4 - 不安全地形穿越 -->
      <view wx:if="{{ aviationCalcData.gpws.activeMode === 'mode4' }}" class="gpws-mode-content">
        <view class="mode-header">
          <view class="mode-title">Mode 4 - 不安全地形穿越</view>
          <view class="mode-desc">检测飞行过程中的地形穿越风险</view>
        </view>

        <!-- Mode 4 子模式选择 -->
        <view class="input-section">
          <view class="picker-group">
            <view class="picker-label">子模式</view>
            <view class="picker-value" bind:tap="showGPWSMode4SubModePicker">
              {{ aviationCalcData.gpws.mode4.subModeDisplayName }}
            </view>
          </view>
        </view>

        <view class="input-section">
          <view class="input-group">
            <view class="input-label">📡 无线电高度 (RA)</view>
            <van-field
              value="{{ aviationCalcData.gpws.mode4.ra }}"
              placeholder="请输入无线电高度"
              type="digit"
              bind:change="onGPWSMode4RAChange"
              input-align="right"
            >
              <view slot="right-icon" class="unit-label">英尺</view>
            </van-field>
          </view>

          <view class="input-group">
            <view class="input-label">🌬️ 空速</view>
            <van-field
              value="{{ aviationCalcData.gpws.mode4.airspeed }}"
              placeholder="请输入空速"
              type="digit"
              bind:change="onGPWSMode4AirspeedChange"
              input-align="right"
            >
              <view slot="right-icon" class="unit-label">节</view>
            </van-field>
          </view>

          <view wx:if="{{ aviationCalcData.gpws.mode4.subMode === '4C' }}" class="input-group">
            <view class="input-label">📈 起飞最大RA</view>
            <van-field
              value="{{ aviationCalcData.gpws.mode4.maxRA }}"
              placeholder="请输入起飞最大RA"
              type="digit"
              bind:change="onGPWSMode4MaxRAChange"
              input-align="right"
            >
              <view slot="right-icon" class="unit-label">英尺</view>
            </van-field>
          </view>
        </view>

        <!-- Mode 4A 配置 -->
        <view wx:if="{{ aviationCalcData.gpws.mode4.subMode === '4A' }}" class="input-section">
          <view class="section-title">🔧 Mode 4A 配置</view>
          <view class="switch-group">
            <view class="switch-item">
              <view class="switch-label">TAD高完整性</view>
              <van-switch 
                checked="{{ aviationCalcData.gpws.mode4.mode4A_TADHighIntegrity }}"
                bind:change="onGPWSMode4A_TADHighIntegrityChange"
              />
            </view>
            <view class="switch-item">
              <view class="switch-label">TCF启用</view>
              <van-switch 
                checked="{{ aviationCalcData.gpws.mode4.mode4A_TCFEnabled }}"
                bind:change="onGPWSMode4A_TCFEnabledChange"
              />
            </view>
            <view class="switch-item">
              <view class="switch-label">飞越检测</view>
              <van-switch 
                checked="{{ aviationCalcData.gpws.mode4.mode4A_OverflightDetected }}"
                bind:change="onGPWSMode4A_OverflightDetectedChange"
              />
            </view>
          </view>
        </view>

        <!-- Mode 4B 配置 -->
        <view wx:if="{{ aviationCalcData.gpws.mode4.subMode === '4B' }}" class="input-section">
          <view class="section-title">🔧 Mode 4B 配置</view>
          <view class="switch-group">
            <view class="switch-item">
              <view class="switch-label">起落架放下</view>
              <van-switch 
                checked="{{ aviationCalcData.gpws.mode4.mode4B_GearDown }}"
                bind:change="onGPWSMode4B_GearDownChange"
              />
            </view>
            <view class="switch-item">
              <view class="switch-label">襟翼在着陆构型</view>
              <van-switch 
                checked="{{ aviationCalcData.gpws.mode4.mode4B_FlapsInLanding }}"
                bind:change="onGPWSMode4B_FlapsInLandingChange"
              />
            </view>
            <view class="switch-item">
              <view class="switch-label">TAD高完整性</view>
              <van-switch 
                checked="{{ aviationCalcData.gpws.mode4.mode4B_TADHighIntegrity }}"
                bind:change="onGPWSMode4B_TADHighIntegrityChange"
              />
            </view>
            <view class="switch-item">
              <view class="switch-label">TCF启用</view>
              <van-switch 
                checked="{{ aviationCalcData.gpws.mode4.mode4B_TCFEnabled }}"
                bind:change="onGPWSMode4B_TCFEnabledChange"
              />
            </view>
            <view class="switch-item">
              <view class="switch-label">飞越检测</view>
              <van-switch 
                checked="{{ aviationCalcData.gpws.mode4.mode4B_OverflightDetected }}"
                bind:change="onGPWSMode4B_OverflightDetectedChange"
              />
            </view>
          </view>
        </view>

        <!-- Mode 4C 配置 -->
        <view wx:if="{{ aviationCalcData.gpws.mode4.subMode === '4C' }}" class="input-section">
          <view class="section-title">🔧 Mode 4C 配置</view>
          <view class="switch-group">
            <view class="switch-item">
              <view class="switch-label">起落架或襟翼放下</view>
              <van-switch 
                checked="{{ aviationCalcData.gpws.mode4.mode4C_GearOrFlapsDown }}"
                bind:change="onGPWSMode4C_GearOrFlapsDownChange"
              />
            </view>
          </view>
        </view>

        <view class="action-buttons">
          <van-button type="primary" bind:click="calculateGPWSMode4" block>
            🚀 分析 Mode 4
          </van-button>
        </view>

        <!-- Mode 4 结果 -->
        <view wx:if="{{ aviationCalcData.gpws.mode4.result }}" class="result-section">
          <view class="gpws-result">
            <view class="result-title">📊 Mode 4 分析结果</view>
            <view class="mode-info">{{ aviationCalcData.gpws.mode4.result.subModeInfo }}</view>
            <view class="gpws-status {{ aviationCalcData.gpws.mode4.result.type }}">
              <view class="status-text">{{ aviationCalcData.gpws.mode4.result.status }}</view>
              <view class="status-message">{{ aviationCalcData.gpws.mode4.result.message }}</view>
            </view>
            
            <view wx:if="{{ aviationCalcData.gpws.mode4.result.thresholdInfo }}" class="result-detail">
              <view class="detail-title">📋 详细信息</view>
              <view class="detail-text">{{ aviationCalcData.gpws.mode4.result.thresholdInfo }}</view>
              <view wx:if="{{ aviationCalcData.gpws.mode4.result.envelopeInfo }}" class="detail-text">{{ aviationCalcData.gpws.mode4.result.envelopeInfo }}</view>
            </view>
          </view>
        </view>
      </view>

      <!-- Mode 5 - 过度下滑道偏离 -->
      <view wx:if="{{ aviationCalcData.gpws.activeMode === 'mode5' }}" class="gpws-mode-content">
        <view class="mode-header">
          <view class="mode-title">Mode 5 - 过度下滑道偏离</view>
          <view class="mode-desc">监控ILS进近时的下滑道偏离</view>
        </view>

        <view class="input-section">
          <view class="input-group">
            <view class="input-label">📡 无线电高度 (RA)</view>
            <van-field
              value="{{ aviationCalcData.gpws.mode5.ra }}"
              placeholder="请输入无线电高度"
              type="digit"
              bind:change="onGPWSMode5RAChange"
              input-align="right"
            >
              <view slot="right-icon" class="unit-label">英尺</view>
            </van-field>
          </view>

          <view class="input-group">
            <view class="input-label">📐 下滑道偏离度</view>
            <van-field
              value="{{ aviationCalcData.gpws.mode5.gsDeviation }}"
              placeholder="请输入偏离度"
              type="digit"
              bind:change="onGPWSMode5GSDeviationChange"
              input-align="right"
            >
              <view slot="right-icon" class="unit-label">dots</view>
            </van-field>
          </view>
        </view>

        <view class="action-buttons">
          <van-button type="primary" bind:click="calculateGPWSMode5" block>
            🚀 分析 Mode 5
          </van-button>
        </view>

        <!-- Mode 5 结果 -->
        <view wx:if="{{ aviationCalcData.gpws.mode5.result }}" class="result-section">
          <view class="gpws-result">
            <view class="result-title">📊 Mode 5 分析结果</view>
            <view class="gpws-status {{ aviationCalcData.gpws.mode5.result.type }}">
              <view class="status-text">{{ aviationCalcData.gpws.mode5.result.status }}</view>
              <view class="status-message">{{ aviationCalcData.gpws.mode5.result.message }}</view>
            </view>
            
            <view wx:if="{{ aviationCalcData.gpws.mode5.result.thresholdInfo }}" class="result-detail">
              <view class="detail-title">📋 详细信息</view>
              <view class="detail-text">{{ aviationCalcData.gpws.mode5.result.thresholdInfo }}</view>
              <view wx:if="{{ aviationCalcData.gpws.mode5.result.envelopeInfo }}" class="detail-text">{{ aviationCalcData.gpws.mode5.result.envelopeInfo }}</view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

<!-- 飞机型号选择器 -->
<van-action-sheet
  show="{{ showAircraftModelPicker }}"
  title="选择飞机型号"
  bind:close="onAircraftPickerClose"
  bind:select="onAircraftModelSelect"
  actions="{{ aircraftModelActions }}"
/>

<!-- GPWS Mode 4 Sub-Mode Selector -->
<van-action-sheet
  show="{{ showGPWSMode4SubModePicker }}"
  title="选择Mode 4子模式"
  bind:close="onGPWSMode4SubModePickerClose"
  bind:select="onGPWSMode4SubModeSelect"
  actions="{{ gpwsMode4SubModeActions }}"
/>

<!-- PITCH Aircraft Model Selector -->
<van-action-sheet
  show="{{ showPitchAircraftModelPicker }}"
  title="选择飞机型号"
  bind:close="onPitchAircraftModelPickerClose"
  bind:select="onPitchAircraftModelSelect"
  actions="{{ pitchAircraftModelActions }}"
/>

  <!-- 横幅广告 - 仅在未获得无广告奖励且原生广告开关开启时显示 -->
  <view wx:if="{{ !isAdFree && nativeAdEnabled }}" class="ad-banner-container">
    <ad unit-id="adunit-3a1bf3800fa937a2" ad-type="banner" ad-intervals="30"></ad>
  </view>
</view>

<van-toast id="van-toast" />