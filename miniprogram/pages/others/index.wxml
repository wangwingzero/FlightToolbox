<view class="container">
  <!-- 用户状态卡片 - 整合积分和个人信息 -->
  <view class="user-status-card">
    <view class="status-header">
      <view class="user-avatar" bind:tap="showProductPhilosophy">
        <van-icon name="manager" size="36" color="#fff" />
        <view class="avatar-ring"></view>
      </view>
      <view class="user-info">
        <view class="greeting">{{ greeting }}</view>
      </view>
      <view class="points-display">
        <view class="points-value">{{ userPoints }}</view>
        <view class="points-unit">积分</view>
        <view class="points-ring" bind:tap="showPointsDetail"></view>
      </view>
    </view>
    
    <!-- 快速操作区 -->
    <view class="quick-actions">
      <view class="action-item {{ canSignIn ? '' : 'checked' }}" bind:tap="dailySignIn" wx:if="{{ canSignIn }}">
        <view class="action-icon">
          <van-icon name="star" size="18" color="#ffd700" />
        </view>
        <view class="action-content">
          <text class="action-text">每日签到</text>
        </view>
        <view class="action-ripple"></view>
      </view>
      <view class="action-item checked" wx:else>
        <view class="action-icon">
          <van-icon name="passed" size="18" color="#52c41a" />
        </view>
        <view class="action-content">
          <text class="action-text">已签到</text>
        </view>
      </view>
      
      <view class="action-item" bind:tap="watchAdForPoints" wx:if="{{ remainingAdToday > 0 }}">
        <view class="action-icon">
          <van-icon name="play-circle" size="18" color="#1989fa" />
        </view>
        <view class="action-content">
          <text class="action-text">观看视频</text>
          <text class="action-badge">+{{ currentAdReward }}</text>
        </view>
        <view class="action-ripple"></view>
      </view>
      
      <view class="action-item" bind:tap="showPointsRules">
        <view class="action-icon">
          <van-icon name="question" size="18" color="#969799" />
        </view>
        <view class="action-content">
          <text class="action-text">积分规则</text>
        </view>
        <view class="action-ripple"></view>
      </view>
    </view>
    
    <!-- 连续签到提示 -->
    <view class="streak-display" wx:if="{{ signInStreak > 0 }}">
      <van-icon name="fire" size="16" color="#ff6b35" />
      <text class="streak-text">连续签到 {{ signInStreak }} 天，继续保持！</text>
      <view class="streak-flame"></view>
    </view>
  </view>

  <!-- 资质提醒卡片 -->
  <view wx:if="{{ qualifications.length > 0 }}" class="qualification-alert-card">
    <view class="alert-header">
      <view class="alert-icon">
        <van-icon name="shield-o" size="22" color="#ff6b35" />
      </view>
      <view class="alert-content">
        <text class="alert-title">资质提醒</text>
        <text class="alert-subtitle" wx:if="{{ expiringSoonCount > 0 }}">{{ expiringSoonCount }}项即将到期</text>
        <text class="alert-subtitle all-valid" wx:else>全部有效</text>
      </view>
      <view class="alert-action" bind:tap="openQualificationManager">
        <van-icon name="arrow" size="16" color="#666" />
      </view>
    </view>
    
    <scroll-view class="qualification-scroll" scroll-x="{{ true }}" show-scrollbar="{{ false }}">
      <view class="qualification-items">
        <view 
          wx:for="{{ qualifications }}" 
          wx:key="id"
          class="qualification-item qualification-{{ item.status }}"
          bind:tap="openQualificationManager"
        >
          <view class="qual-status-dot"></view>
          <view class="qual-content">
            <view class="qual-name">{{ item.name }}</view>
            <view class="qual-status">
              <text wx:if="{{ item.daysRemaining > 0 }}">{{ item.daysRemaining }}天后到期</text>
              <text wx:elif="{{ item.daysRemaining === 0 }}">今日到期</text>
              <text wx:else>已过期</text>
            </view>
          </view>
          <view class="qual-icon">
            <van-icon 
              name="{{ item.status === 'expired' ? 'cross' : item.status === 'warning' ? 'warning-o' : 'passed' }}" 
              size="16" 
              color="{{ item.status === 'expired' ? '#f44336' : item.status === 'warning' ? '#ff6b35' : '#52c41a' }}" 
            />
          </view>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- 工具分类区域 -->
  <view class="tools-categories">
    <!-- 飞行计算工具 -->
    <view class="category-section">
      <view class="category-header">
        <view class="category-icon">
          <van-icon name="calculator-o" size="20" color="#667eea" />
          <view class="icon-bg flight-calc-bg"></view>
        </view>
        <view class="category-info">
          <text class="category-title">飞行计算</text>
          <text class="category-desc">精确计算，安全飞行</text>
        </view>
        <view class="category-badge">2</view>
      </view>
      <van-row gutter="32">
        <van-col span="12">
          <view class="tool-card flight-calc" bind:tap="openTwinEngineGoAround">
            <view class="tool-icon">
              <van-icon name="play" size="28" color="#667eea" />
              <view class="tool-icon-bg"></view>
            </view>
            <view class="tool-content">
              <view class="tool-name">双发复飞梯度</view>
              <view class="tool-desc">梯度计算分析</view>
              <view class="tool-status">
                <van-tag type="warning" size="mini">3积分</van-tag>
              </view>
            </view>
          </view>
        </van-col>
        <van-col span="12">
          <view class="tool-card flight-calc" bind:tap="openSunriseSunset">
            <view class="tool-icon">
              <van-icon name="clock-o" size="28" color="#764ba2" />
              <view class="tool-icon-bg"></view>
            </view>
            <view class="tool-content">
              <view class="tool-name">夜航时间</view>
              <view class="tool-desc">日出日落计算</view>
              <view class="tool-status">
                <van-tag type="primary" size="mini">2积分</van-tag>
              </view>
            </view>
          </view>
        </van-col>
      </van-row>
    </view>

    <!-- 飞行管理工具 -->
    <view class="category-section">
      <view class="category-header">
        <view class="category-icon">
          <van-icon name="orders-o" size="20" color="#52c41a" />
          <view class="icon-bg management-bg"></view>
        </view>
        <view class="category-info">
          <text class="category-title">飞行管理</text>
          <text class="category-desc">规范管理，高效运行</text>
        </view>
        <view class="category-badge">4</view>
      </view>
      <van-row gutter="32">
        <van-col span="12">
          <view class="tool-card management" bind:tap="openEventReport">
            <view class="tool-icon">
              <van-icon name="edit" size="28" color="#52c41a" />
              <view class="tool-icon-bg"></view>
            </view>
            <view class="tool-content">
              <view class="tool-name">事件报告</view>
              <view class="tool-desc">样例填写指导</view>
              <view class="tool-status">
                <van-tag type="warning" size="mini">3积分</van-tag>
              </view>
            </view>
          </view>
        </van-col>
        <van-col span="12">
          <view class="tool-card management" bind:tap="openFlightTimeShare">
            <view class="tool-icon">
              <van-icon name="clock-o" size="28" color="#389e0d" />
              <view class="tool-icon-bg"></view>
            </view>
            <view class="tool-content">
              <view class="tool-name">分飞行时间</view>
              <view class="tool-desc">计算分享</view>
              <view class="tool-status">
                <van-tag type="primary" size="mini">2积分</van-tag>
              </view>
            </view>
          </view>
        </van-col>
      </van-row>
      
      <!-- 第二行：个人检查单和资质管理 -->
      <van-row gutter="32">
        <van-col span="12">
          <view class="tool-card management" bind:tap="openPersonalChecklist">
            <view class="tool-icon">
              <van-icon name="completed" size="28" color="#52c41a" />
              <view class="tool-icon-bg"></view>
            </view>
            <view class="tool-content">
              <view class="tool-name">个人检查单</view>
              <view class="tool-desc">自定义清单</view>
              <view class="tool-status">
                <van-tag type="success" size="mini">免费</van-tag>
              </view>
            </view>
          </view>
        </van-col>
        <van-col span="12">
          <view class="tool-card management" bind:tap="openQualificationManager">
            <view class="tool-icon">
              <van-icon name="certificate" size="28" color="#389e0d" />
              <view class="tool-icon-bg"></view>
            </view>
            <view class="tool-content">
              <view class="tool-name">资质管理</view>
              <view class="tool-desc">证照管理</view>
              <view class="tool-status">
                <van-tag type="success" size="mini">免费</van-tag>
              </view>
            </view>
          </view>
        </van-col>
      </van-row>
    </view>



    <!-- 特殊情况工具 -->
    <view class="category-section">
      <view class="category-header">
        <view class="category-icon">
          <van-icon name="warning-o" size="20" color="#ff6b35" />
          <view class="icon-bg special-bg"></view>
        </view>
        <view class="category-info">
          <text class="category-title">特殊情况</text>
          <text class="category-desc">应急处置，专业应对</text>
        </view>
        <view class="category-badge">2</view>
      </view>
      <van-row gutter="16" class="tools-grid">
        <van-col span="12">
          <view 
            class="tool-card special"
            bind:tap="openSnowtamDecoder"
          >
            <view class="tool-icon">
              <van-icon name="description" size="28" color="#ff6b35" />
              <view class="tool-icon-bg"></view>
            </view>
            <view class="tool-content">
              <view class="tool-name">雪情通告</view>
              <view class="tool-desc">SNOWTAM解读</view>
              <view class="tool-status">
                <van-tag type="warning" size="mini">3积分</van-tag>
              </view>
            </view>
          </view>
        </van-col>
        
        <van-col span="12">
          <view 
            class="tool-card special"
            bind:tap="openDangerousGoods"
          >
            <view class="tool-icon">
              <van-icon name="warning-o" size="28" color="#f7931e" />
              <view class="tool-icon-bg"></view>
            </view>
            <view class="tool-content">
              <view class="tool-name">危险品</view>
              <view class="tool-desc">规定查询助手</view>
              <view class="tool-status">
                <van-tag type="warning" size="mini">3积分</van-tag>
              </view>
            </view>
          </view>
        </van-col>
      </van-row>
    </view>
  </view>

  <!-- 🎯 基于Context7最佳实践：广告区域 - 特殊情况工具和飞行播客之间 -->
  <view class="ad-section" wx:if="{{ showAd && !userPreferences.reduceAds }}">
    <view class="ad-header">
      <van-icon name="info-o" size="14" color="#969799" />
      <text class="ad-label">广告</text>
    </view>
    <ad-template 
      unit-id="{{ adUnitId }}"
      ad-type="custom"
      bind:adload="onAdLoad"
      bind:aderror="onAdError"
    />
  </view>

  <!-- 关注公众号区域 -->
  <view class="category-section wechat-section">
    <view class="category-header">
      <view class="category-icon">
        <van-icon name="wechat" size="20" color="#07c160" />
        <view class="icon-bg wechat-bg"></view>
      </view>
              <view class="category-info">
          <text class="category-title">飞行播客</text>
          <text class="category-desc">让我们用一种新的方式来学飞行</text>
        </view>
      <view class="category-badge">NEW</view>
    </view>
    
          <view class="wechat-content">
        <!-- 直接跳转按钮（使用最新API） -->
        <view class="direct-jump-action">
          <van-button 
            type="primary" 
            size="normal"
            class="jump-button"
            bind:click="jumpToOfficialAccount">
            进入飞行播客
          </van-button>
        </view>
      
      <!-- 直接显示二维码图片 -->
      <view class="qr-display">
        <image 
          class="qr-code-image" 
          src="/images/OfficialAccount.png"
          mode="aspectFit"
          bind:tap="previewQRCode"
          show-menu-by-longpress="{{true}}"
        />
                  <text class="qr-hint">长按识别二维码关注"飞行播客"</text>
      </view>
    </view>
  </view>

  <!-- 应用信息卡片 -->
  <view class="app-info-card">
    <view class="info-header">
      <view class="info-icon">
        <van-icon name="info-o" size="20" color="#1989fa" />
      </view>
      <text class="info-title">应用信息</text>
    </view>
    
    <van-cell-group class="info-group" border="{{ false }}">
      <van-cell 
        title="版本信息" 
        value="v1.1.0"
        icon="upgrade"
        class="info-cell"
        bind:click="onVersionTap"
      />
      <van-cell 
        title="意见反馈" 
        is-link 
        bind:click="feedback"
        icon="chat-o"
        class="info-cell"
      />
      <van-cell 
        title="关于作者" 
        is-link 
        bind:click="aboutUs"
        icon="contact"
        class="info-cell"
      />
    </van-cell-group>
  </view>

  <!-- 应用信息卡片 -->
  <view class="warning-notice">
    <view class="warning-icon">
      <van-icon name="warning-o" size="40rpx" color="#ff6b35" />
    </view>
    <view class="warning-content">
      本小程序旨在帮助飞行员学习航空理论知识，包括性能计算、概念理解、规章条例等内容。但请注意：所有计算逻辑均基于作者个人理解编写，可能存在错误且未经官方验证。因此，本小程序所有数据仅供学习参考，严禁用于实际飞行操作！
    </view>
  </view>

  <!-- 积分详情弹窗 -->
  <van-popup
    show="{{ showPointsModal }}"
    position="bottom"
    bind:close="closePointsModal"
    round="{{ true }}"
    safe-area-inset-bottom="{{ true }}"
    class="points-popup"
    custom-style="height: 80vh;"
  >
    <view class="modal-container">
      <view class="modal-content">
        <view class="modal-header">
          <text class="modal-title">积分详情</text>
          <van-icon name="cross" size="20" color="#969799" bind:tap="closePointsModal" />
        </view>
        
        <view class="current-points">
          <view class="points-circle">
            <text class="points-amount">{{ userPoints }}</text>
          </view>
          <text class="points-label">当前积分</text>
        </view>
        
        <view class="transactions-list">
          <text class="list-title">最近记录</text>
          <view wx:for="{{ pointsTransactions }}" wx:key="index" class="transaction-item">
            <view class="transaction-info">
              <view class="transaction-icon">
                <van-icon 
                  name="{{ item.amount > 0 ? 'add-o' : 'minus' }}" 
                  size="16" 
                  color="{{ item.amount > 0 ? '#52c41a' : '#f44336' }}" 
                />
              </view>
              <view class="transaction-details">
                <text class="transaction-type">{{ formatTransactionType(item.type) }}</text>
                <text class="transaction-desc" wx:if="{{ item.description }}">{{ item.description }}</text>
                <text class="transaction-time">{{ formatTransactionTime(item.timestamp) }}</text>
              </view>
            </view>
            <text class="transaction-amount {{ item.amount > 0 ? 'positive' : 'negative' }}">
              {{ item.amount > 0 ? '+' : '' }}{{ item.amount }}
            </text>
          </view>
          
          <!-- 显示更多记录提示 -->
          <view wx:if="{{ pointsTransactions.length === 0 }}" class="no-transactions">
            <van-icon name="records" size="32" color="#ddd" />
            <text class="no-transactions-text">暂无积分记录</text>
          </view>
          
          <view wx:if="{{ pointsTransactions.length >= 100 }}" class="more-records-hint">
            <text class="hint-text">仅显示最近100条记录</text>
          </view>
        </view>
      </view>
      
      <view class="modal-footer safe-area-bottom">
        <van-button type="primary" block round bind:click="closePointsModal">
          关闭
        </van-button>
      </view>
    </view>
  </van-popup>

  <!-- 签到成功弹窗 -->
  <van-popup
    show="{{ showSignInModal }}"
    position="center"
    bind:close="closeSignInModal"
    round="{{ true }}"
    class="signin-popup"
    custom-style="min-width: 600rpx;"
  >
    <view class="modal-container">
      <view class="modal-content">
        <view class="signin-success">
          <view class="success-animation">
            <van-icon name="star" size="48" color="#ffd700" />
            <view class="success-glow"></view>
          </view>
          <text class="success-title">签到成功!</text>
          <text class="success-subtitle">获得 {{ signInResult.pointsEarned }} 积分</text>
          
          <view class="signin-stats">
            <view class="stat-item">
              <text class="stat-value">{{ signInResult.consecutiveDays }}</text>
              <text class="stat-label">连续签到天数</text>
            </view>
            <view class="stat-divider"></view>
            <view class="stat-item">
              <text class="stat-value">{{ signInResult.totalPoints }}</text>
              <text class="stat-label">总积分</text>
            </view>
          </view>
        </view>
      </view>
      
      <view class="modal-footer">
        <van-button type="primary" block round bind:click="closeSignInModal">
          太棒了
        </van-button>
      </view>
    </view>
  </van-popup>

  <!-- 积分规则弹窗 -->
  <van-popup
    show="{{ showPointsRulesModal }}"
    position="bottom"
    bind:close="closePointsRulesModal"
    round="{{ true }}"
    safe-area-inset-bottom="{{ true }}"
    class="points-rules-popup"
  >
    <view class="points-rules-modal">
      <!-- 弹窗头部 -->
      <view class="modal-header">
        <text class="modal-title">🎯 积分规则说明</text>
        <van-icon name="cross" size="20" color="#969799" bind:tap="closePointsRulesModal" />
      </view>
      
      <view class="rules-content">
        <!-- 获取积分卡片 -->
        <view class="rule-card earn-card">
          <view class="card-header">
            <van-icon name="add" size="20" color="#52c41a" />
            <text class="card-title">如何获取积分</text>
          </view>
          <view class="card-content">
            <view class="earn-item">
              <view class="earn-icon">
                <van-icon name="calendar-o" size="16" color="#52c41a" />
              </view>
              <view class="earn-info">
                <text class="earn-title">每日签到</text>
                <text class="earn-desc">15-50积分/天，连续签到更多奖励</text>
              </view>
            </view>
            <view class="earn-item">
              <view class="earn-icon">
                <van-icon name="play-circle-o" size="16" color="#1989fa" />
              </view>
              <view class="earn-info">
                <text class="earn-title">观看广告</text>
                <text class="earn-desc">40积分/个，每天最多3个</text>
              </view>
            </view>

          </view>
        </view>

        <!-- 功能计费卡片 -->
        <view class="rule-card cost-card">
          <view class="card-header">
            <van-icon name="diamond-o" size="20" color="#722ed1" />
            <text class="card-title">功能计费标准</text>
          </view>
          <view class="card-content">
            <!-- 免费功能 -->
            <view class="cost-category">
              <view class="category-header">
                <van-icon name="fire" size="14" color="#ff6b35" />
                <text class="category-title">免费功能</text>
              </view>
              <text class="cost-item">• 个人检查单</text>
              <text class="cost-item">• 资质管理</text>
            </view>
            
            <!-- 基础功能 -->
            <view class="cost-category">
              <view class="category-header">
                <van-icon name="calculator-o" size="14" color="#1989fa" />
                <text class="category-title">基础功能 (1积分)</text>
              </view>
              <text class="cost-item">• 飞行速算</text>
              <text class="cost-item">• 常用换算</text>
            </view>
            
            <!-- 中级功能 -->
            <view class="cost-category">
              <view class="category-header">
                <van-icon name="apps-o" size="14" color="#722ed1" />
                <text class="category-title">中级功能 (2积分)</text>
              </view>
              <text class="cost-item">• 特殊计算</text>
              <text class="cost-item">• 万能查询</text>
              <text class="cost-item">• 夜航时间计算</text>
              <text class="cost-item">• 分飞行时间</text>
            </view>
            
            <!-- 高级功能 -->
            <view class="cost-category">
              <view class="category-header">
                <van-icon name="edit" size="14" color="#f44336" />
                <text class="category-title">高级功能 (3积分)</text>
              </view>
              <text class="cost-item">• 事件报告样例</text>
              <text class="cost-item">• 雪情通告解码</text>
              <text class="cost-item">• 危险品查询</text>
              <text class="cost-item">• 双发复飞梯度</text>
            </view>
          </view>
        </view>

        <!-- 使用建议卡片 -->
        <view class="rule-card tips-card">
          <view class="card-header">
            <van-icon name="bulb-o" size="20" color="#faad14" />
            <text class="card-title">使用建议</text>
          </view>
          <view class="card-content">
            <view class="tip-item">
              <van-icon name="check-circle-o" size="14" color="#52c41a" />
              <text class="tip-text">每日签到是最稳定的积分来源</text>
            </view>
            <view class="tip-item">
              <van-icon name="check-circle-o" size="14" color="#52c41a" />
              <text class="tip-text">观看3个广告可满足大部分需求</text>
            </view>
            <view class="tip-item">
              <van-icon name="check-circle-o" size="14" color="#52c41a" />
              <text class="tip-text">免费功能可无限制使用</text>
            </view>
            <view class="tip-item">
              <van-icon name="check-circle-o" size="14" color="#52c41a" />
              <text class="tip-text">积分按具体操作扣除，查看即扣费</text>
            </view>
          </view>
        </view>

        <!-- 关于积分制度入口 -->
        <view class="rule-card philosophy-card">
          <view class="card-header">
            <van-icon name="heart-o" size="20" color="#f44336" />
            <text class="card-title">关于积分制度</text>
          </view>
          <view class="card-content">
            <view class="philosophy-entry" bind:tap="showProductPhilosophy">
              <text class="philosophy-text">听听作者的话</text>
              <van-icon name="arrow" size="16" color="#1989fa" />
            </view>
          </view>
        </view>
      </view>
    </view>
  </van-popup>

  <!-- 🎯 新增：产品理念说明弹窗 -->
  <van-popup
    show="{{ showProductPhilosophyModal }}"
    position="bottom"
    bind:close="closeProductPhilosophyModal"
    round="{{ true }}"
    safe-area-inset-bottom="{{ true }}"
    class="philosophy-popup"
  >
    <view class="philosophy-modal">
      <view class="modal-header">
        <text class="modal-title">💝 作者的话</text>
        <van-icon name="cross" size="20" color="#969799" bind:tap="closeProductPhilosophyModal" />
      </view>
      
      <view class="philosophy-content">
        <!-- 产品理念说明 -->
        <view class="philosophy-text">
          <view class="paragraph">
            <text class="text-content">感谢您选择飞行工具箱！这段时间收到了许多飞行朋友的关心，有朋友建议我推出付费版本，认为这样可以更好地支持开发和维护。确实，维护和投入都需要成本。</text>
          </view>
          
          <view class="paragraph">
            <text class="text-content">但我的初衷就是想让大家都能不花一分钱使用这些工具。为了找到一个平衡点，最终想到了积分制，这样既能支持小程序的持续发展，又能让大家继续免费使用，保持纯粹的体验。</text>
          </view>
          
          <view class="paragraph">
            <text class="text-content">你每一次的签到和支持，都是对我最大的鼓励。</text>
          </view>
          
          <view class="paragraph highlight">
            <view class="highlight-content">
              <van-icon name="heart-o" size="18" color="#f44336" />
              <text class="highlight-text">感谢您的理解与陪伴，让我们一起创造更美好的飞行体验！</text>
            </view>
          </view>
        </view>
      </view>
    </view>
  </van-popup>

  <!-- 事件报告详情弹窗 -->
  <van-popup
    show="{{ showReportDetailModal }}"
    position="bottom"
    bind:close="closeReportDetail"
    round="{{ true }}"
    safe-area-inset-bottom="{{ true }}"
    class="report-detail-popup"
  >
    <view class="report-detail-modal">
      <view class="modal-header">
        <text class="modal-title">事件报告详情</text>
        <van-icon name="cross" size="20" color="#969799" bind:tap="closeReportDetail" />
      </view>
      
      <view class="detail-content">
        <text class="detail-text" user-select>{{selectedReport.generatedText}}</text>
      </view>
      <van-grid column-num="3" border="{{ false }}" gutter="{{ 10 }}">
        <van-grid-item use-slot>
          <van-button type="default" block bind:click="copySelectedReport">复制</van-button>
        </van-grid-item>
        <van-grid-item use-slot>
          <van-button type="danger" block bind:click="deleteSelectedReport">删除</van-button>
        </van-grid-item>
        <van-grid-item use-slot>
          <van-button type="info" block bind:click="closeReportDetail">关闭</van-button>
        </van-grid-item>
      </van-grid>
    </view>
  </van-popup>

  <!-- 公众号二维码弹窗 -->
  <van-popup
    show="{{ showQRCodeModal }}"
    position="center"
    bind:close="closeQRCodeModal"
    round="{{ true }}"
    class="qr-code-popup"
  >
    <view class="qr-modal">
      <view class="modal-header">
        <text class="modal-title">关注公众号</text>
        <van-icon name="cross" size="20" color="#969799" bind:tap="closeQRCodeModal" />
      </view>
      
      <view class="qr-content">
        <view class="qr-placeholder">
          <van-icon name="wechat" size="64" color="#07c160" />
          <text class="qr-title">飞行播客</text>
          <text class="qr-id">微信号：gh_68a6294836cd</text>
          <text class="qr-desc">让我们用一种新的方式来学飞行</text>
        </view>
        
        <view class="qr-benefits">
          <text class="benefits-title">关注后您将获得：</text>
          <view class="benefit-list">
            <view class="benefit-row">
              <van-icon name="play-circle" size="16" color="#ffd700" />
              <text>精品飞行音频节目</text>
            </view>
            <view class="benefit-row">
              <van-icon name="volume-o" size="16" color="#ffd700" />
              <text>创新的飞行学习方式</text>
            </view>
            <view class="benefit-row">
              <van-icon name="friends-o" size="16" color="#ffd700" />
              <text>飞行知识互动交流</text>
            </view>
          </view>
        </view>
      </view>
      
      <view class="modal-footer">
        <van-button type="primary" block round bind:click="closeQRCodeModal">
          知道了
        </van-button>
      </view>
    </view>
  </van-popup>



  <!-- 广告设置区域 -->
  <view class="ad-settings">
    <van-cell-group title="广告设置">
      <!-- 开启减少广告功能（仅在未激活时显示） -->
      <van-cell 
        wx:if="{{ !isCountdownActive }}"
        title="减少广告显示" 
        label="开启需消耗50积分，24小时有效"
      >
        <van-switch 
          checked="{{ userPreferences.reduceAds }}"
          bind:change="onReduceAdsChange"
        />
      </van-cell>
      
      <!-- 倒计时显示（广告关闭时） -->
      <van-cell 
        wx:if="{{ isCountdownActive }}"
        title="广告恢复倒计时"
        value="{{ remainingTime }}"
        icon="clock-o"
        label="倒计时结束后广告将重新显示"
        class="countdown-cell {{ countdownClass }}"
      />
      
      <!-- 当前状态提示（仅在未激活时显示） -->
      <van-cell 
        wx:if="{{ !isCountdownActive }}"
        title="当前状态"
        value="正常显示广告"
        icon="info-o"
        class="status-cell"
      />

    </van-cell-group>
  </view>
</view> 