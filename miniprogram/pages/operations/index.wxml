<view class="container page-content">
  <!-- 主页面 - 功能卡片选择 -->
  <view wx:if="{{ !selectedModule }}" class="main-page">
    <view class="page-header">
      <view class="header-title">✈️ 航班运行</view>
      <view class="header-subtitle">航班管理，运行保障</view>
    </view>


    <!-- 功能卡片网格 -->
    <view class="modules-grid">
      <view class="module-card" bind:tap="selectModule" data-module="airline-recordings">
        <view class="module-icon">🎧</view>
        <view class="module-title">航线录音</view>
        <view class="module-desc">真实陆空通话录音学习</view>
        <!-- 数据量标签（底部） -->
        <view class="module-count">
          <van-tag type="warning" size="medium">330条录音</van-tag>
        </view>
      </view>

      <view class="module-card" bind:tap="selectModule" data-module="communication-rules">
        <view class="module-icon">📖</view>
        <view class="module-title">通信规范</view>
        <view class="module-desc">专业通信规范详解</view>
        <!-- 数据量标签（底部） -->
        <view class="module-count">
          <van-tag type="success" size="medium">5类规范</van-tag>
        </view>
      </view>

      <view class="module-card" bind:tap="openStandardPhraseology">
        <view class="module-icon">💬</view>
        <view class="module-title">标准通信用语</view>
        <view class="module-desc">陆空通话标准用语查询</view>
        <!-- 数据量标签（底部） -->
        <view class="module-count">
          <van-tag type="primary" size="medium">200+用语</van-tag>
        </view>
      </view>

      <view class="module-card" bind:tap="selectModule" data-module="communication-failure">
        <view class="module-icon">📵</view>
        <view class="module-title">通信失效</view>
        <view class="module-desc">通信失效处理程序</view>
        <!-- 数据量标签（底部） -->
        <view class="module-count">
          <van-tag type="primary" size="medium">6个程序</van-tag>
        </view>
      </view>

      <view class="module-card" bind:tap="selectModule" data-module="snowtam-encoder">
        <view class="module-icon">❄️</view>
        <view class="module-title">雪情通告</view>
        <view class="module-desc">SNOWTAM编码器</view>
        <!-- 数据量标签（底部） -->
        <view class="module-count">
          <van-tag type="warning" size="medium">编码工具</van-tag>
        </view>
      </view>

      <view class="module-card" bind:tap="selectModule" data-module="rodex-decoder">
        <view class="module-icon">🛫</view>
        <view class="module-title">欧洲RODEX</view>
        <view class="module-desc">跑道状况解读</view>
        <!-- 数据量标签（底部） -->
        <view class="module-count">
          <van-tag type="warning" size="medium">解码工具</van-tag>
        </view>
      </view>


      <view class="module-card emergency-module-card" bind:tap="navigateToEmergencyAltitude">
        <view class="module-icon">🚨</view>
        <view class="module-title">紧急改变高度</view>
        <view class="module-desc">紧急情况高度改变程序</view>
        <!-- 数据量标签（底部） -->
        <view class="module-count">
          <van-tag type="danger" size="medium">3类程序</van-tag>
        </view>
        <view class="emergency-badge">紧急</view>
      </view>

      <view class="module-card" bind:tap="selectModule" data-module="acr">
        <view class="module-icon">🛬</view>
        <view class="module-title">ACR-PCR</view>
        <view class="module-desc">飞机道面承载能力对比</view>
        <!-- 数据量标签（底部） -->
        <view class="module-count">
          <van-tag type="primary" size="medium">全机型</van-tag>
        </view>
      </view>
    </view>


    <!-- 功能说明区域 -->
    <view class="function-tips">
      <view class="tips-title">💡 使用说明</view>
      <view class="tips-content">
        <view class="tip-item">• 🎧 音频学习：真实陆空通话录音，提升专业通信能力</view>
        <view class="tip-item">• 📖 规范查询：通信规范、标准用语等权威资料查询</view>
        <view class="tip-item">• 🚨 紧急程序：通信失效、紧急改变高度等应急程序</view>
        <view class="tip-item">• 🛫 专业工具：SNOWTAM编码、RODEX解读</view>
        <view class="tip-item">• 🛫 支持离线使用，数据本地存储</view>
      </view>
    </view>
  </view>

  <!-- 通信规范模块页面 -->
  <view wx:if="{{ selectedModule === 'communication-rules' }}" class="communication-rules-container">
    <!-- 页面标题 -->
    <view class="page-header">
      <view class="header-title">📖 陆空通话规范</view>
      <view class="header-subtitle">专业通信规范详解</view>
    </view>

    <!-- 卡片选择区域 -->
    <view class="cards-container">
      <!-- 通话要求卡片 -->
      <view class="procedure-card requirements-card" bind:tap="selectRulesCategory" data-type="phraseologyRequirements">
        <view class="card-icon">🗣️</view>
        <view class="card-title">通话要求</view>
        <view class="card-subtitle">基本要求与通话结构</view>
        <view class="card-details">
          <view class="detail-item">
            <text class="detail-label">内容：</text>
            <text class="detail-value">通话概述、结构、技巧</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">语言：</text>
            <text class="detail-value">中文普通话或英语</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">时间：</text>
            <text class="detail-value">UTC 协调世界时</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">数据状态：</text>
            <text class="detail-value">{{ rulesData ? '已加载' : '未加载' }}</text>
          </view>
        </view>
        <view class="card-arrow">→</view>
      </view>

      <!-- 发音规则卡片 -->
      <view class="procedure-card pronunciation-card" bind:tap="selectRulesCategory" data-type="pronunciation">
        <view class="card-icon">🔤</view>
        <view class="card-title">发音规则</view>
        <view class="card-subtitle">数字、字母标准发音</view>
        <view class="card-details">
          <view class="detail-item">
            <text class="detail-label">数字：</text>
            <text class="detail-value">0-9 标准读法</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">字母：</text>
            <text class="detail-value">ICAO 字母表</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">特殊：</text>
            <text class="detail-value">高度、时间、频率</text>
          </view>
        </view>
        <view class="card-arrow">→</view>
      </view>

      <!-- 标准用语卡片 -->
      <view class="procedure-card phrases-card" bind:tap="selectRulesCategory" data-type="standardPhrases">
        <view class="card-icon">💬</view>
        <view class="card-title">标准用语</view>
        <view class="card-subtitle">常用通话用语表</view>
        <view class="card-details">
          <view class="detail-item">
            <text class="detail-label">数量：</text>
            <text class="detail-value">{{ rulesData && rulesData.standardPhrases ? rulesData.standardPhrases.length : 0 }}个用语</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">类型：</text>
            <text class="detail-value">确认、指令、询问</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">语言：</text>
            <text class="detail-value">中英文对照</text>
          </view>
        </view>
        <view class="card-arrow">→</view>
      </view>

      <!-- 呼号用法卡片 -->
      <view class="procedure-card callsign-card" bind:tap="selectRulesCategory" data-type="callSignPhraseology">
        <view class="card-icon">📻</view>
        <view class="card-title">呼号用法</view>
        <view class="card-subtitle">管制单位呼号规范</view>
        <view class="card-details">
          <view class="detail-item">
            <text class="detail-label">管制：</text>
            <text class="detail-value">区域、进近、塔台</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">航空器：</text>
            <text class="detail-value">注册号、航班号</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">缩减：</text>
            <text class="detail-value">简化呼号规则</text>
          </view>
        </view>
        <view class="card-arrow">→</view>
      </view>

      <!-- 天气报文卡片 -->
      <view class="procedure-card weather-card" bind:tap="selectRulesCategory" data-type="weatherPhraseology">
        <view class="card-icon">🌤️</view>
        <view class="card-title">天气报文</view>
        <view class="card-subtitle">天气信息通话格式</view>
        <view class="card-details">
          <view class="detail-item">
            <text class="detail-label">风向风速：</text>
            <text class="detail-value">三位数+米秒</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">能见度：</text>
            <text class="detail-value">距离+单位</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">云况：</text>
            <text class="detail-value">云量+高度</text>
          </view>
        </view>
        <view class="card-arrow">→</view>
      </view>
    </view>


    <!-- 快速提示 -->
    <view class="quick-tips">
      <view class="tips-title">💡 学习提示</view>
      <view class="tips-list">
        <view class="tip-item">
          <text class="tip-number">1</text>
          <text class="tip-text">发话前仔细守听频率，确保无干扰</text>
        </view>
        <view class="tip-item">
          <text class="tip-number">2</text>
          <text class="tip-text">使用标准发音，语速控制在合理范围</text>
        </view>
        <view class="tip-item">
          <text class="tip-number">3</text>
          <text class="tip-text">重要信息需要复诵确认</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 紧急改变高度已迁移到独立页面 /pages/emergency-altitude/index -->


</view>

<van-toast id="van-toast" />