<view class="container page-content">
  <!-- 主页面 - 功能卡片选择 -->
  <view wx:if="{{ !selectedModule }}" class="main-page">

    <view class="quick-audio-card" bind:tap="handleQuickRoutePlayTap">
      <view class="quick-audio-left">
        <view class="quick-audio-title">{{ quickPlayerTitle }}</view>
        <view class="quick-audio-subtitle">{{ quickPlayerSubtitle || '已缓存航线随机播放' }}</view>
        <view class="quick-audio-status">{{ quickPlayerStatus }}</view>
      </view>
      <view class="quick-audio-controls">
        <view class="quick-audio-prev" catch:tap="handleQuickRoutePrevTap">
          <text class="quick-audio-prev-icon">⏮</text>
        </view>
        <view class="quick-audio-button {{ isPlaying ? 'playing' : '' }}">
          <text class="quick-audio-icon">{{ isPlaying ? '❚❚' : '▶' }}</text>
        </view>
        <view class="quick-audio-next" catch:tap="handleQuickRouteNextTap">
          <text class="quick-audio-next-icon">⏭</text>
        </view>
      </view>
    </view>

    <!-- 航班运行功能卡片网格 -->
    <view class="modules-grid">
      <view class="module-card" bind:tap="selectModule" data-module="airline-recordings">
        <view class="module-icon">🎧</view>
        <view class="module-title">航线录音</view>
        <view class="module-desc">听听前辈怎么说话，跟着学准没错</view>
        <view class="module-count">
          <van-tag type="warning" size="medium">330条录音</van-tag>
        </view>
      </view>
      <view class="module-card" bind:tap="openStandardPhraseology">
        <view class="module-icon">💬</view>
        <view class="module-title">陆空通话规范</view>
        <view class="module-desc">一站式搜索标准用语与通信规范</view>
        <view class="module-count">
          <van-tag type="primary" size="medium">200+用语 · 6个要点</van-tag>
        </view>
      </view>
      <!-- CPDLC电文查询卡片 -->
      <view class="module-card" bind:tap="openCPDLC">
        <view class="module-icon">📡</view>
        <view class="module-title">CPDLC电文</view>
        <view class="module-desc">数据链不求人，352条电文随查随用</view>
        <view class="module-count">
          <van-tag type="primary" size="medium">352条电文</van-tag>
        </view>
      </view>
      <view class="module-card" bind:tap="selectModule" data-module="communication-failure">
        <view class="module-icon">📵</view>
        <view class="module-title">通信失效</view>
        <view class="module-desc">失联不慌，6套程序护你周全</view>
        <view class="module-count">
          <van-tag type="primary" size="medium">6个程序</van-tag>
        </view>
      </view>
      <view class="module-card emergency-module-card" bind:tap="navigateToEmergencyAltitude">
        <view class="module-icon">🚨</view>
        <view class="module-title">紧急改变高度</view>
        <view class="module-desc">紧急时刻救命的3套程序</view>
        <view class="module-count">
          <van-tag type="danger" size="medium">3类程序</van-tag>
        </view>
        <view class="emergency-badge">紧急</view>
      </view>
    </view>



  </view>

  <!-- 紧急改变高度已迁移到独立页面 /pages/emergency-altitude/index -->


</view>

<!-- 横幅广告 -->
<view wx:if="{{ !isAdFree }}" class="ad-banner-container">
  <ad unit-id="adunit-d6c8a55bd3cb4fd1" ad-type="banner" ad-intervals="30"></ad>
</view>

<van-toast id="van-toast" />