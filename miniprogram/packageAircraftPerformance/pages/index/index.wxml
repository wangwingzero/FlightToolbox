<view class="container">
  <!-- 顶部背景装饰 -->
  <view class="bg-accent"></view>

  <view class="content-wrapper">
    <view class="page-hero">
      <view class="hero-pill">飞机性能</view>
      <view class="hero-title">性能公式卡片</view>
      <view class="hero-subtitle">
        用简明的公式和示意图快速回顾飞机性能核心概念。
      </view>
    </view>

    <!-- 搜索框 -->
    <view class="search-section">
      <van-search
        value="{{ searchValue }}"
        placeholder="搜索公式 / 关键字（如 TOD / V2）"
        bind:change="onSearchChange"
        bind:clear="onSearchClear"
        shape="round"
        background="transparent"
        custom-class="custom-search"
      />
    </view>

    <!-- 列表区域 -->
    <view class="list-section">
      <van-empty
        wx:if="{{ !loading && displayedCards.length === 0 }}"
        image="search"
        description="未找到相关公式卡片"
      />

      <view wx:elif="{{ !loading }}" class="entry-list">
        <block wx:for="{{ displayedCards }}" wx:key="id">
          <view class="entry-card {{ item.themeClass }}" bind:tap="onCardTap" data-id="{{ item.id }}">
            <view class="card-accent"></view>
            <view class="card-main">
              <image
                class="entry-image"
                mode="aspectFill"
                src="{{ item.imagePath }}"
                catchtap="onImagePreview"
                data-src="{{ item.imagePath }}"
              />
              <view class="card-content">
                <view wx:if="{{ item.tags && item.tags.length > 0 }}" class="card-tags">
                  <view wx:for="{{ item.tags }}" wx:key="*this" wx:for-item="tag" class="tag">{{ tag }}</view>
                </view>
                <view class="entry-title">
                  <text class="title-zh">{{ item.titleZh }}</text>
                </view>
                <view class="entry-summary">
                  <text user-select="true">{{ item.summaryZh }}</text>
                </view>
              </view>
            </view>
          </view>
        </block>
      </view>

      <view wx:if="{{ loading }}" class="loading-mask">
        <van-loading size="24px" vertical>数据加载中...</van-loading>
      </view>
    </view>

    <view wx:if="{{ !isAdFree && nativeAdEnabled }}" class="ad-banner-container">
      <ad unit-id="adunit-d7a3b71f5ce0afca" ad-type="banner" ad-intervals="30"></ad>
    </view>
  </view>
</view>
