<view class="container page-content">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <view class="header-icon">âœˆï¸</view>
    <view class="header-title">é£æœºå‚æ•°æŸ¥è¯¢</view>
    <view class="header-subtitle">ä¸“ä¸šèˆªç©ºå™¨æ€§èƒ½æ•°æ®åº“ Â· 22æ¬¾ä¸»æµæœºå‹</view>
    <view class="header-stats">
      <view class="stat-item">
        <view class="stat-number">{{aircraftList.length}}</view>
        <view class="stat-label">æœºå‹</view>
      </view>
      <view class="stat-item">
        <view class="stat-number">{{filteredList.length}}</view>
        <view class="stat-label">åŒ¹é…</view>
      </view>
    </view>
  </view>

  <!-- æœç´¢æ¡† -->
  <view class="search-section">
    <van-search
      value="{{ searchValue }}"
      placeholder="æœç´¢é£æœºå‹å·ã€åˆ¶é€ å•†æˆ–ICAOä»£ç "
      bind:change="onSearchChange"
      bind:clear="onSearchClear"
      shape="round"
    />
  </view>

  <!-- æ¨ªå¹…å¹¿å‘Š -->
  <view class="ad-banner-container">
    <ad-custom unit-id="adunit-2f5afef0d27dc863" bindload="adLoad" binderror="adError" bindclose="adClose"></ad-custom>
  </view>

  <!-- é£æœºåˆ—è¡¨ -->
  <view class="aircraft-list">
    <block wx:for="{{ filteredList }}" wx:key="model" wx:for-index="idx">
      <view 
        class="aircraft-item" 
        bind:tap="selectAircraft" 
        data-index="{{ index }}"
      >
        <view class="aircraft-header">
          <view class="aircraft-model">{{ item.model }}</view>
          <view class="aircraft-code">{{ item.icaoAerodromeReferenceCode }}</view>
        </view>
        <view class="aircraft-info">
          <view class="info-item">
            <view class="info-icon">âš–ï¸</view>
            <view class="info-content">
              <view class="label">æœ€å¤§èµ·é£é‡é‡</view>
              <view class="value">{{ item.mtow }}</view>
            </view>
          </view>
          <view class="info-item">
            <view class="info-icon">ğŸŒ</view>
            <view class="info-content">
              <view class="label">èˆªç¨‹</view>
              <view class="value">{{ item.range }}</view>
            </view>
          </view>
          <view class="info-item">
            <view class="info-icon">ğŸ‘¥</view>
            <view class="info-content">
              <view class="label">åº§ä½æ•°</view>
              <view class="value">{{ item.typicalSeating }}</view>
            </view>
          </view>
        </view>
        <view class="aircraft-footer">
          <view class="view-details">æŸ¥çœ‹è¯¦æƒ… â†’</view>
        </view>
      </view>
      
      <!-- åœ¨ç¬¬8ä¸ªé¡¹ç›®åæ’å…¥å¹¿å‘Š -->
      <view wx:if="{{ (idx + 1) % 8 === 0 && idx < filteredList.length - 1 }}" class="ad-container list-ad">
        <ad-custom unit-id="adunit-735d7d24032d4ca8" bindload="adLoad" binderror="adError" bindclose="adClose"></ad-custom>
      </view>
    </block>
  </view>

  <!-- è¯¦æƒ…å¼¹çª— -->
  <van-popup
    show="{{ showDetail }}"
    position="bottom"
    round
    bind:close="closeDetail"
    custom-style="height: 85vh;"
  >
    <view class="detail-popup" wx:if="{{ selectedAircraft }}">
      <view class="detail-header">
        <view class="detail-header-content">
          <view class="detail-icon">âœˆï¸</view>
          <view class="detail-title-group">
            <view class="detail-title">{{ selectedAircraft.model }}</view>
            <view class="detail-subtitle">{{ selectedAircraft.manufacturer }} Â· {{ selectedAircraft.icaoAerodromeReferenceCode }}</view>
          </view>
        </view>
        <view class="close-button" bind:tap="closeDetail">
          <van-icon name="cross" size="20" color="#ef4444" />
        </view>
      </view>
      
      <scroll-view class="detail-content" scroll-y enhanced show-scrollbar="{{ false }}" style="height: calc(85vh - 140rpx); padding-bottom: 60rpx;">
        <!-- åŸºæœ¬å°ºå¯¸ -->
        <view class="param-section">
          <view class="section-title">ğŸ“ åŸºæœ¬å°ºå¯¸</view>
          <view class="param-grid">
            <view class="param-item">
              <text class="param-label">æ€»é•¿åº¦</text>
              <text class="param-value">{{ selectedAircraft.overallLength || 'æš‚æ— æ•°æ®' }}</text>
            </view>
            <view class="param-item">
              <text class="param-label">ç¿¼å±•</text>
              <text class="param-value">{{ selectedAircraft.wingspan || 'æš‚æ— æ•°æ®' }}</text>
            </view>
            <view class="param-item">
              <text class="param-label">æ€»é«˜åº¦</text>
              <text class="param-value">{{ selectedAircraft.overallHeight || 'æš‚æ— æ•°æ®' }}</text>
            </view>
            <view class="param-item">
              <text class="param-label">æœºèº«å®½åº¦</text>
              <text class="param-value">{{ selectedAircraft.fuselageWidth || 'æš‚æ— æ•°æ®' }}</text>
            </view>
          </view>
        </view>

        <!-- èµ·è½æ¶å‚æ•° -->
        <view class="param-section">
          <view class="section-title">ğŸ› èµ·è½æ¶å‚æ•°</view>
          <view class="param-grid">
            <view class="param-item">
              <text class="param-label">ä¸»èµ·è½æ¶è½®è·</text>
              <text class="param-value">{{ selectedAircraft.mainGearTrack || 'æš‚æ— æ•°æ®' }}</text>
            </view>
            <view class="param-item">
              <text class="param-label">å‰åè½®è·</text>
              <text class="param-value">{{ selectedAircraft.wheelbase || 'æš‚æ— æ•°æ®' }}</text>
            </view>
          </view>
        </view>

        <!-- é‡é‡å‚æ•° -->
        <view class="param-section">
          <view class="section-title">âš–ï¸ é‡é‡å‚æ•°</view>
          <view class="param-grid">
            <view class="param-item">
              <text class="param-label">æœ€å¤§èµ·é£é‡é‡</text>
              <text class="param-value">{{ selectedAircraft.mtow || 'æš‚æ— æ•°æ®' }}</text>
            </view>
            <view class="param-item">
              <text class="param-label">æœ€å¤§ç€é™†é‡é‡</text>
              <text class="param-value">{{ selectedAircraft.mlw || 'æš‚æ— æ•°æ®' }}</text>
            </view>
            <view class="param-item">
              <text class="param-label">æœ€å¤§é›¶ç‡ƒé‡é‡</text>
              <text class="param-value">{{ selectedAircraft.mzfw || 'æš‚æ— æ•°æ®' }}</text>
            </view>
          </view>
        </view>

        <!-- æ€§èƒ½å‚æ•° -->
        <view class="param-section">
          <view class="section-title">ğŸš€ æ€§èƒ½å‚æ•°</view>
          <view class="param-grid">
            <view class="param-item">
              <text class="param-label">å…¸å‹åº§ä½æ•°</text>
              <text class="param-value">{{ selectedAircraft.typicalSeating || 'æš‚æ— æ•°æ®' }}</text>
            </view>
            <view class="param-item">
              <text class="param-label">æœ€å¤§åº§ä½æ•°</text>
              <text class="param-value">{{ selectedAircraft.maxSeating || 'æš‚æ— æ•°æ®' }}</text>
            </view>
            <view class="param-item">
              <text class="param-label">èˆªç¨‹</text>
              <text class="param-value">{{ selectedAircraft.range || 'æš‚æ— æ•°æ®' }}</text>
            </view>
            <view class="param-item">
              <text class="param-label">ICAOæœºåœºå‚è€ƒä»£ç </text>
              <text class="param-value">{{ selectedAircraft.icaoAerodromeReferenceCode || 'æš‚æ— æ•°æ®' }}</text>
            </view>
          </view>
        </view>

      </scroll-view>
    </view>
  </van-popup>

  <!-- åº•éƒ¨æ¨ªå¹…å¹¿å‘Š -->
  <view class="ad-banner-container bottom-ad">
    <ad-custom unit-id="adunit-3a1bf3800fa937a2" bindload="adLoad" binderror="adError" bindclose="adClose"></ad-custom>
  </view>
</view>

<van-toast id="van-toast" />