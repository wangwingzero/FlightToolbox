<view class="modern-container">
  <!-- ç°ä»£åŒ–é¡µé¢å¤´éƒ¨ -->
  <view class="modern-header">
    <!-- é¢åŒ…å±‘å¯¼èˆª -->
    <view class="modern-breadcrumb">
      <view class="modern-breadcrumb-item">CCARè§„ç« </view>
      <view class="modern-breadcrumb-separator">></view>
      <view class="modern-breadcrumb-item modern-breadcrumb-current">
        {{ category || 'è§„ç« åˆ—è¡¨' }}
      </view>
    </view>
    
    <!-- å¤´éƒ¨å†…å®¹ -->
    <view class="modern-header-content">
      <view class="modern-header-left">
        <view class="modern-header-title">{{ subcategory || 'è§„ç« åˆ—è¡¨' }}</view>
        <view class="modern-header-subtitle">{{ category }}</view>
      </view>
      
      <!-- æœ‰æ•ˆæ€§ç­›é€‰æ§ä»¶ -->
      <view class="modern-filter-controls">
        <view 
          class="modern-filter-button {{ validityFilter === 'all' ? 'active' : '' }}"
          bind:tap="onFilterChange"
          data-filter="all"
        >
          å…¨éƒ¨
        </view>
        <view 
          class="modern-filter-button success {{ validityFilter === 'valid' ? 'active' : '' }}"
          bind:tap="onFilterChange"
          data-filter="valid"
        >
          æœ‰æ•ˆ
        </view>
        <view 
          class="modern-filter-button error {{ validityFilter === 'invalid' ? 'active' : '' }}"
          bind:tap="onFilterChange"
          data-filter="invalid"
        >
          å¤±æ•ˆ
        </view>
      </view>
    </view>
  </view>



  <!-- ç°ä»£åŒ–è§„ç« åˆ—è¡¨ -->
  <view class="modern-card-container">
    <view wx:if="{{ filteredRegulations.length === 0 && !loading }}" class="modern-empty-state fade-in">
      <view class="modern-empty-icon">ğŸ“‹</view>
      <view class="modern-empty-text">æš‚æ— ç›¸å…³è§„ç« </view>
      <view class="modern-empty-hint">å°è¯•è°ƒæ•´ç­›é€‰æ¡ä»¶</view>
    </view>

    <view wx:else class="modern-card-list fade-in">
      <block wx:for="{{ filteredRegulations }}" wx:key="doc_number" wx:for-index="idx">
        <view 
          class="modern-card-item hover-lift bounce-click" 
          bind:tap="onRegulationClick"
          data-regulation="{{ item }}"
        >
        <!-- æœ‰æ•ˆæ€§å¾½ç«  - å³ä¸Šè§’ä½ç½® -->
        <view class="modern-validity-badge {{ item.validity === 'æœ‰æ•ˆ' ? 'valid' : 'invalid' }}">
          {{ item.validity }}
        </view>
        
        <view class="modern-card-main">
          <!-- å¡ç‰‡å¤´éƒ¨ -->
          <view class="modern-card-header">
            <view class="modern-card-number primary">{{ item.doc_number }}</view>
          </view>
          
          <!-- è§„ç« æ ‡é¢˜ -->
          <view class="modern-card-title">{{ item.title }}</view>

          <!-- è§„èŒƒæ€§æ–‡ä»¶æ•°é‡ -->
          <view class="modern-card-normative-count">
            <view class="normative-count-icon">ğŸ“„</view>
            <view class="normative-count-text">{{ item.normativeCount || 0 }} ä¸ªè§„èŒƒæ€§æ–‡ä»¶</view>
          </view>

          <!-- å¡ç‰‡åº•éƒ¨ä¿¡æ¯ -->
          <view class="modern-card-footer">{{ item.office_unit }}</view>
        </view>
        
        <!-- å¡ç‰‡æ“ä½œåŒºåŸŸ -->
        <view class="modern-card-actions">
          <view
            class="modern-action-button primary bounce-click"
            catchtap="onCopyLink"
            data-regulation="{{ item }}"
          >
            <van-icon name="link" size="16" />
            <text style="margin-left: 4rpx;">å¤åˆ¶é“¾æ¥</text>
          </view>
        </view>
        </view>
        
        <!-- åœ¨ç¬¬10ä¸ªé¡¹ç›®åæ’å…¥å¹¿å‘Š -->
        <view wx:if="{{ (idx + 1) % 10 === 0 && idx < filteredRegulations.length - 1 }}" class="ad-container list-ad">
          <ad-custom unit-id="adunit-735d7d24032d4ca8" bindload="adLoad" binderror="adError" bindclose="adClose"></ad-custom>
        </view>
      </block>
    </view>
  </view>

  <!-- ç°ä»£åŒ–ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="modern-stats-footer">
    <view class="modern-stats-text">
      å½“å‰æ˜¾ç¤º {{ filteredRegulations.length }} / {{ regulations.length }} ä¸ªè§„ç« 
      <text wx:if="{{ validityFilter !== 'all' }}">
        ï¼ˆ{{ validityFilter === 'valid' ? 'æœ‰æ•ˆ' : 'å¤±æ•ˆ' }}è§„ç« ï¼‰
      </text>
    </view>
  </view>

  <!-- åº•éƒ¨æ¨ªå¹…å¹¿å‘Š -->
  <view class="ad-banner-container bottom-ad">
    <ad-custom unit-id="adunit-2f5afef0d27dc863" bindload="adLoad" binderror="adError" bindclose="adClose"></ad-custom>
  </view>
</view>

<van-toast id="van-toast" />