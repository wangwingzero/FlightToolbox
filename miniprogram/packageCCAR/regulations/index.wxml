<view class="page-container">
  <view class="header-bg"></view>

  <!-- 头部信息 -->
  <view class="page-header">
    <view class="header-content">
      <view class="header-title">{{ subcategory || category }}</view>
      <view class="header-subtitle" wx:if="{{ subcategory }}">{{ category }}</view>
    </view>
    
    <!-- 筛选器 -->
    <view class="filter-tabs">
       <view class="filter-tab {{ validityFilter === 'all' ? 'active' : '' }}" bindtap="onFilterChange" data-filter="all">全部</view>
       <view class="filter-tab {{ validityFilter === 'valid' ? 'active' : '' }}" bindtap="onFilterChange" data-filter="valid">有效</view>
       <view class="filter-tab {{ validityFilter === 'invalid' ? 'active' : '' }}" bindtap="onFilterChange" data-filter="invalid">失效</view>
    </view>
  </view>

  <!-- 列表 -->
  <view class="list-container">
    <block wx:for="{{ filteredRegulations }}" wx:key="index">
      <view class="regulation-card" bindtap="onRegulationClick" data-regulation="{{ item }}">
         <view class="validity-tag {{ item.validity === '有效' ? 'valid' : (item.validity === '废止' ? 'abolished' : 'invalid') }}">{{ item.validity }}</view>
         
         <view class="card-content">
           <view class="card-header">
             <text class="doc-number">{{ item.doc_number }}</text>
           </view>
           <view class="card-title">{{ item.title }}</view>
           <view class="card-footer">
             <view class="meta-item" wx:if="{{ item.normativeCount > 0 }}">
               <van-icon name="description" size="12px" style="margin-right: 4px;" />
               <text>{{ item.normativeCount }} 个文件</text>
             </view>
             <view class="meta-item">{{ item.office_unit }}</view>
           </view>
         </view>
         
         <view class="card-action" catchtap="onCopyLink" data-regulation="{{ item }}">
           <view class="action-btn">
             <van-icon name="link-o" size="16px" color="#1989fa" />
             <text>复制</text>
           </view>
         </view>
      </view>
    </block>

    <!-- 空状态 -->
    <view wx:if="{{ filteredRegulations.length === 0 && !loading }}" class="empty-state">
      <van-icon name="description" size="64px" color="#e0e0e0" />
      <text class="empty-text">暂无相关规章</text>
    </view>
  </view>
</view>

<van-toast id="van-toast" />