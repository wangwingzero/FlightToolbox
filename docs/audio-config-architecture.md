# éŸ³é¢‘é…ç½®æž¶æž„è®¾è®¡æ–‡æ¡£

## ðŸ“– æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿°äº† FlightToolbox å°ç¨‹åºä¸­éŸ³é¢‘é…ç½®ç®¡ç†ç³»ç»Ÿçš„æž¶æž„è®¾è®¡ï¼Œæ—¨åœ¨æä¾›ä¸€ä¸ªå¯æ‰©å±•ã€æ˜“ç»´æŠ¤çš„éŸ³é¢‘èµ„æºç®¡ç†æ–¹æ¡ˆã€‚

## ðŸŽ¯ è®¾è®¡ç›®æ ‡

- **å¯æ‰©å±•æ€§**ï¼šè½»æ¾æ·»åŠ æ–°çš„åœ°åŒºå’Œæœºåœº
- **å¯ç»´æŠ¤æ€§**ï¼šå•ä¸€æ•°æ®æºï¼Œé¿å…é‡å¤é…ç½®
- **èŒè´£åˆ†ç¦»**ï¼šé…ç½®é€»è¾‘ä¸Žæ•°æ®åˆ†ç¦»
- **å‘åŽå…¼å®¹**ï¼šä¸å½±å“çŽ°æœ‰åŠŸèƒ½

## ðŸ—ï¸ æž¶æž„è®¾è®¡

### æ–‡ä»¶ç»“æž„

```
miniprogram/
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ audio-config.js          # éŸ³é¢‘é…ç½®ç®¡ç†å™¨ï¼ˆæ ¸å¿ƒï¼‰
â”‚   â””â”€â”€ communication-rules.js   # é€šä¿¡è§„åˆ™é…ç½®
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ regions/
â”‚   â”‚   â”œâ”€â”€ japan.js             # æ—¥æœ¬éŸ³é¢‘æ•°æ®
â”‚   â”‚   â”œâ”€â”€ philippines.js       # è²å¾‹å®¾éŸ³é¢‘æ•°æ®
â”‚   â”‚   â”œâ”€â”€ korean.js            # éŸ©å›½éŸ³é¢‘æ•°æ®
â”‚   â”‚   â”œâ”€â”€ germany.js           # å¾·å›½éŸ³é¢‘æ•°æ®ï¼ˆæœªæ¥ï¼‰
â”‚   â”‚   â””â”€â”€ usa.js               # ç¾Žå›½éŸ³é¢‘æ•°æ®ï¼ˆæœªæ¥ï¼‰
â”‚   â””â”€â”€ index.js                 # æ•°æ®ç»Ÿä¸€å¯¼å‡º
â”œâ”€â”€ packageJapan/                # æ—¥æœ¬éŸ³é¢‘åˆ†åŒ…ï¼ˆæ–°æ ¼å¼ï¼‰âœ¨
â”œâ”€â”€ packagePhilippines/          # è²å¾‹å®¾éŸ³é¢‘åˆ†åŒ…ï¼ˆæ–°æ ¼å¼ï¼‰âœ¨
â”œâ”€â”€ packageKorean/               # éŸ©å›½éŸ³é¢‘åˆ†åŒ…ï¼ˆæ–°æ ¼å¼ï¼‰âœ¨
â”œâ”€â”€ packageGermany/              # å¾·å›½éŸ³é¢‘åˆ†åŒ…ï¼ˆæœªæ¥ï¼‰
â”œâ”€â”€ packageUSA/                  # ç¾Žå›½éŸ³é¢‘åˆ†åŒ…ï¼ˆæœªæ¥ï¼‰
â”œâ”€â”€ packageAustralia/            # æ¾³å¤§åˆ©äºšéŸ³é¢‘åˆ†åŒ…ï¼ˆæœªæ¥ï¼‰
â””â”€â”€ packageSouthAfrica/          # å—éžéŸ³é¢‘åˆ†åŒ…ï¼ˆæœªæ¥ï¼‰
```

### æ ¸å¿ƒç»„ä»¶

#### 1. éŸ³é¢‘é…ç½®ç®¡ç†å™¨ (`utils/audio-config.js`)

**èŒè´£ï¼š**
- ç»Ÿä¸€ç®¡ç†æ‰€æœ‰éŸ³é¢‘é…ç½®
- æä¾›æ ‡å‡†åŒ–çš„æ•°æ®è®¿é—®æŽ¥å£
- å¤„ç†éŸ³é¢‘è·¯å¾„æ˜ å°„
- ç®¡ç†åœ°åŒºå’Œæœºåœºä¿¡æ¯

**ä¸»è¦æ–¹æ³•ï¼š**
```javascript
class AudioConfigManager {
  getRegions()                    // èŽ·å–æ‰€æœ‰åœ°åŒº
  getAirports()                   // èŽ·å–æ‰€æœ‰æœºåœº
  getAirportsByRegion(regionId)   // æ ¹æ®åœ°åŒºèŽ·å–æœºåœº
  getAirportById(airportId)       // æ ¹æ®IDèŽ·å–æœºåœº
  getAudioPath(airportId, filename) // èŽ·å–éŸ³é¢‘æ–‡ä»¶è·¯å¾„
  getFullConfig()                 // èŽ·å–å®Œæ•´é…ç½®
}
```

#### 2. æ•°æ®æ–‡ä»¶ (`data/regions/*.js`)

**èŒè´£ï¼š**
- å­˜å‚¨çº¯å‡€çš„éŸ³é¢‘æ•°æ®
- æ¯ä¸ªåœ°åŒºä¸€ä¸ªç‹¬ç«‹æ–‡ä»¶
- ç»Ÿä¸€çš„æ•°æ®æ ¼å¼

**æ•°æ®æ ¼å¼ï¼š**
```javascript
const RegionData = {
  clips: [
    {
      label: "è¿›è¿‘",                    // å½•éŸ³ç±»åž‹
      full_transcript: "...",          // è‹±æ–‡åŽŸæ–‡
      translation_cn: "...",           // ä¸­æ–‡ç¿»è¯‘
      mp3_file: "xxx.mp3"              // éŸ³é¢‘æ–‡ä»¶å
    }
  ]
};

module.exports = RegionData;
```

#### 3. æ•°æ®å¯¼å‡ºå™¨ (`data/index.js`)

**èŒè´£ï¼š**
- ç»Ÿä¸€å¯¼å‡ºæ‰€æœ‰åœ°åŒºæ•°æ®
- ä¾¿äºŽæœªæ¥è‡ªåŠ¨åŒ–åŠ è½½

## ðŸš€ ä½¿ç”¨æ–¹æ³•

### åœ¨é¡µé¢ä¸­ä½¿ç”¨

```javascript
// åŠ è½½é…ç½®
const audioConfig = require('../../utils/audio-config.js');
const config = audioConfig.airlineRecordingsData;

// ä½¿ç”¨é…ç½®ç®¡ç†å™¨
const manager = audioConfig.audioConfigManager;
const regions = manager.getRegions();
const airports = manager.getAirportsByRegion('asia');
const audioPath = manager.getAudioPath('japan', 'sample.mp3');
```

### API æŽ¥å£

```javascript
// èŽ·å–æ‰€æœ‰åœ°åŒº
const regions = audioConfigManager.getRegions();
// è¿”å›ž: [{ id, name, icon, color, description }, ...]

// èŽ·å–åœ°åŒºä¸‹çš„æœºåœº
const airports = audioConfigManager.getAirportsByRegion('asia');
// è¿”å›ž: [{ id, regionId, name, city, icao, clips }, ...]

// èŽ·å–éŸ³é¢‘è·¯å¾„
const path = audioConfigManager.getAudioPath('japan', 'sample.mp3');
// è¿”å›ž: "/packageJ/sample.mp3"
```

## ðŸ“ˆ æ‰©å±•æŒ‡å—

### æ·»åŠ æ–°åœ°åŒº

#### 1. åˆ›å»ºæ•°æ®æ–‡ä»¶

```bash
# åˆ›å»ºæ¬§æ´²åœ°åŒºæ•°æ®æ–‡ä»¶
touch miniprogram/data/regions/europe.js
```

```javascript
// miniprogram/data/regions/europe.js
const EuropeData = {
  clips: [
    {
      label: "è¿›è¿‘",
      full_transcript: "Lufthansa 441, turn left heading 270",
      translation_cn: "æ±‰èŽŽ441ï¼Œå·¦è½¬èˆªå‘270",
      mp3_file: "LH441_Turn-Left-270.mp3"
    }
    // ... æ›´å¤šå½•éŸ³
  ]
};

module.exports = EuropeData;
```

#### 2. æ›´æ–°é…ç½®ç®¡ç†å™¨

```javascript
// miniprogram/utils/audio-config.js
const europeData = require('../data/regions/europe.js');

// åœ¨ constructor ä¸­æ·»åŠ åœ°åŒº
this.regions.push({
  id: 'europe',
  name: 'æ¬§æ´²',
  icon: 'ðŸŒ',
  color: '#10B981',
  description: 'æ¬§æ´²åœ°åŒºæœºåœºé™†ç©ºé€šè¯å½•éŸ³'
});

// æ·»åŠ æœºåœº
this.airports.push({
  id: 'frankfurt',
  regionId: 'europe',
  name: 'å¾·å›½æ³•å…°å…‹ç¦æœºåœº',
  city: 'æ³•å…°å…‹ç¦',
  icao: 'EDDF',
  packageName: 'packageL',
  audioPath: '/packageL/',
  icon: 'ðŸ°',
  description: 'æ³•å…°å…‹ç¦å›½é™…æœºåœºé™†ç©ºé€šè¯å½•éŸ³',
  clips: europeData.clips || []
});
```

#### 3. åˆ›å»ºéŸ³é¢‘åˆ†åŒ…

```bash
mkdir miniprogram/packageL
# å°†éŸ³é¢‘æ–‡ä»¶æ”¾å…¥ packageL ç›®å½•
```

#### 4. æ›´æ–°å°ç¨‹åºé…ç½®

```json
// miniprogram/app.json
{
  "subPackages": [
    {
      "root": "packageL",
      "name": "europeAudioPackage",
      "pages": ["index"]
    }
  ]
}
```

### è‡ªåŠ¨åŒ–è„šæœ¬ï¼ˆå»ºè®®ï¼‰

```bash
#!/bin/bash
# add-region.sh - è‡ªåŠ¨æ·»åŠ æ–°åœ°åŒºè„šæœ¬

REGION_ID=$1
REGION_NAME=$2
PACKAGE_NAME=$3

# åˆ›å»ºæ•°æ®æ–‡ä»¶
cat > "miniprogram/data/regions/${REGION_ID}.js" << EOF
const ${REGION_ID^}Data = {
  clips: [
    // TODO: æ·»åŠ å½•éŸ³æ•°æ®
  ]
};

module.exports = ${REGION_ID^}Data;
EOF

# åˆ›å»ºåˆ†åŒ…ç›®å½•
mkdir -p "miniprogram/${PACKAGE_NAME}"

echo "âœ… å·²åˆ›å»º ${REGION_NAME} åœ°åŒºçš„åŸºç¡€æ–‡ä»¶"
echo "ðŸ“ è¯·æ‰‹åŠ¨æ›´æ–° utils/audio-config.js æ·»åŠ é…ç½®"
```

## ðŸ”„ è¿ç§»æŒ‡å—

### ä»Žæ—§æž¶æž„è¿ç§»

å¦‚æžœæ‚¨çš„é¡¹ç›®ä½¿ç”¨æ—§çš„é…ç½®æ–¹å¼ï¼š

1. **å¤‡ä»½çŽ°æœ‰æ–‡ä»¶**
2. **è¿ç§»æ•°æ®æ–‡ä»¶**
3. **æ›´æ–°å¼•ç”¨è·¯å¾„**
4. **æµ‹è¯•åŠŸèƒ½å®Œæ•´æ€§**

### æ—§é…ç½®æ¸…ç†

```bash
# åˆ é™¤é‡å¤çš„é…ç½®æ–‡ä»¶
rm miniprogram/utils/AirlineRecordings.js
rm miniprogram/utils/japan-audio-config.js
rm miniprogram/utils/philippine-audio-config.js
```

## ðŸ› ï¸ æœ€ä½³å®žè·µ

### 1. æ•°æ®æ ¼å¼æ ‡å‡†åŒ–

ç¡®ä¿æ‰€æœ‰åœ°åŒºæ•°æ®æ–‡ä»¶éµå¾ªç»Ÿä¸€æ ¼å¼ï¼š

```javascript
// æ ‡å‡†æ ¼å¼
const RegionData = {
  clips: [
    {
      label: "å½•éŸ³ç±»åž‹",           // å¿…éœ€ï¼šè¿›è¿‘/åœ°é¢/å¡”å°/æ”¾è¡Œ
      full_transcript: "è‹±æ–‡åŽŸæ–‡", // å¿…éœ€ï¼šå®Œæ•´è‹±æ–‡å½•éŸ³æ–‡æœ¬
      translation_cn: "ä¸­æ–‡ç¿»è¯‘",  // å¿…éœ€ï¼šä¸­æ–‡ç¿»è¯‘
      mp3_file: "æ–‡ä»¶å.mp3"      // å¿…éœ€ï¼šéŸ³é¢‘æ–‡ä»¶å
    }
  ]
};
```

### 2. å‘½åè§„èŒƒ

- **åœ°åŒºID**ï¼šå°å†™è‹±æ–‡ï¼Œå¦‚ `japan`, `korea`, `germany`
- **æœºåœºID**ï¼šå°å†™è‹±æ–‡ï¼Œå¦‚ `tokyo`, `seoul`, `frankfurt`
- **åˆ†åŒ…å**ï¼š`package` + å›½å®¶åï¼Œå¦‚ `packageJapan`, `packageKorean`, `packageGermany`ï¼ˆç»Ÿä¸€æ–°æ ¼å¼ï¼‰
- **éŸ³é¢‘æ–‡ä»¶**ï¼š`èˆªç­å·_æè¿°.mp3`ï¼Œå¦‚ `Korean-Air-925_Clear-for-takeoff.mp3`

### 3. æ€§èƒ½ä¼˜åŒ–

- ä½¿ç”¨åˆ†åŒ…é¢„åŠ è½½ç­–ç•¥
- éŸ³é¢‘æ–‡ä»¶å¤§å°æŽ§åˆ¶åœ¨ 500KB ä»¥å†…
- æŒ‰éœ€åŠ è½½éŸ³é¢‘æ•°æ®

### 4. é”™è¯¯å¤„ç†

```javascript
// ç¤ºä¾‹ï¼šå®‰å…¨çš„é…ç½®èŽ·å–
try {
  const audioPath = audioConfigManager.getAudioPath(airportId, filename);
  if (!audioPath) {
    console.warn(`éŸ³é¢‘è·¯å¾„èŽ·å–å¤±è´¥: ${airportId}/${filename}`);
    return;
  }
  // ä½¿ç”¨éŸ³é¢‘è·¯å¾„
} catch (error) {
  console.error('éŸ³é¢‘é…ç½®é”™è¯¯:', error);
  // é™çº§å¤„ç†
}
```

## ðŸ“Š æž¶æž„ä¼˜åŠ¿

### âœ… ä¼˜åŠ¿

1. **å•ä¸€æ•°æ®æº**ï¼šé¿å…æ•°æ®é‡å¤å’Œä¸ä¸€è‡´
2. **èŒè´£æ¸…æ™°**ï¼šé…ç½®ç®¡ç†ä¸Žæ•°æ®å­˜å‚¨åˆ†ç¦»
3. **æ˜“äºŽæ‰©å±•**ï¼šæ·»åŠ æ–°åœ°åŒºåªéœ€2-3ä¸ªæ­¥éª¤
4. **ä¾¿äºŽç»´æŠ¤**ï¼šä¿®æ”¹æ•°æ®åªéœ€æ›´æ–°ä¸€ä¸ªæ–‡ä»¶
5. **è‡ªåŠ¨åŒ–å‹å¥½**ï¼šæ”¯æŒè„šæœ¬åŒ–æ‰¹é‡æ“ä½œ
6. **ç±»åž‹å®‰å…¨**ï¼šç»Ÿä¸€çš„æ•°æ®æŽ¥å£å’Œæ ¼å¼éªŒè¯

### ðŸ“ˆ æ‰©å±•æ€§å¯¹æ¯”

| æ“ä½œ | æ—§æž¶æž„ | æ–°æž¶æž„ |
|------|--------|--------|
| æ·»åŠ æ–°åœ°åŒº | ä¿®æ”¹3-5ä¸ªæ–‡ä»¶ | åˆ›å»º1ä¸ªæ•°æ®æ–‡ä»¶ + æ›´æ–°é…ç½® |
| ä¿®æ”¹å½•éŸ³æ•°æ® | åŒæ­¥å¤šä¸ªæ–‡ä»¶ | ä¿®æ”¹1ä¸ªæ•°æ®æ–‡ä»¶ |
| ç»´æŠ¤å¤æ‚åº¦ | é«˜ï¼ˆå¤šæ–‡ä»¶åŒæ­¥ï¼‰ | ä½Žï¼ˆå•ä¸€é…ç½®æºï¼‰ |
| å‡ºé”™æ¦‚çŽ‡ | é«˜ï¼ˆäººå·¥åŒæ­¥ï¼‰ | ä½Žï¼ˆè‡ªåŠ¨åŒ–ç®¡ç†ï¼‰ |

## ðŸ” æ•…éšœæŽ’é™¤

### å¸¸è§é—®é¢˜

1. **éŸ³é¢‘åŠ è½½å¤±è´¥**
   - æ£€æŸ¥åˆ†åŒ…è·¯å¾„é…ç½®
   - éªŒè¯éŸ³é¢‘æ–‡ä»¶æ˜¯å¦å­˜åœ¨
   - ç¡®è®¤åˆ†åŒ…é¢„åŠ è½½è®¾ç½®

2. **æ•°æ®æ ¼å¼é”™è¯¯**
   - æ£€æŸ¥ `module.exports` è¯­æ³•
   - éªŒè¯æ•°æ®ç»“æž„å®Œæ•´æ€§
   - ç¡®è®¤æ–‡ä»¶ç¼–ç æ ¼å¼

3. **é…ç½®æ›´æ–°ä¸ç”Ÿæ•ˆ**
   - é‡å¯å¼€å‘è€…å·¥å…·
   - æ¸…é™¤å°ç¨‹åºç¼“å­˜
   - æ£€æŸ¥æ–‡ä»¶å¼•ç”¨è·¯å¾„

## ðŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2024-01-XX)
- åˆå§‹æž¶æž„è®¾è®¡
- æ”¯æŒæ—¥æœ¬ã€è²å¾‹å®¾åœ°åŒº
- åŸºç¡€é…ç½®ç®¡ç†å™¨å®žçŽ°

### v1.1.0 (2024-07-05)
- âœ… æ·»åŠ éŸ©å›½åœ°åŒºæ”¯æŒ (packageKorean)
- âœ… åŒ…å«20ä¸ªçœŸå®žä»å·æœºåœºå½•éŸ³
- âœ… æ›´æ–°åˆ†åŒ…é…ç½®å’Œé¢„åŠ è½½è§„åˆ™
- âœ… å¼•å…¥æ–°çš„åˆ†åŒ…å‘½åæ¨¡å¼ï¼špackage[Country]

### v1.2.0 (2024-07-05) 
- âœ… å®Œæˆå…¨é¢åˆ†åŒ…é‡å‘½åè¿ç§»
- âœ… packageJ â†’ packageJapan  
- âœ… packageK â†’ packagePhilippines
- âœ… packageL â†’ packageKorean
- âœ… ç»Ÿä¸€æ‰€æœ‰æœªæ¥åˆ†åŒ…å‘½åæ ¼å¼
- âœ… å»ºç«‹åˆ†åŒ…å‘½åæ ‡å‡†æ–‡æ¡£

### v1.3.0 (è®¡åˆ’ä¸­)
- æ·»åŠ æ›´å¤šæ¬§æ´²åœ°åŒºæ”¯æŒ
- è‡ªåŠ¨åŒ–è„šæœ¬å·¥å…·
- æ€§èƒ½ä¼˜åŒ–

## ðŸ”„ åˆ†åŒ…å‘½åæ¨¡å¼è¿ç§»å»ºè®®

### æ–°å‘½åæ¨¡å¼çš„ä¼˜åŠ¿

éŸ©å›½å·²çŽ‡å…ˆé‡‡ç”¨æ–°çš„ `packageKorean` å‘½åæ¨¡å¼ï¼Œç›¸æ¯”åŽŸæ¥çš„å­—æ¯ç¼–å·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š

âœ… **æ¸…æ™°ç›´è§‚**ï¼š`packageKorean` æ¯” `packageL` æ›´å®¹æ˜“ç†è§£  
âœ… **é¿å…å†²çª**ï¼šä¸ç”¨æ‹…å¿ƒå­—æ¯ç”¨å®Œæˆ–è®°é”™ç¼–å·  
âœ… **æ˜“äºŽç»´æŠ¤**ï¼šå¼€å‘è€…èƒ½ç›´æŽ¥ä»Žæ–‡ä»¶å¤¹åçœ‹å‡ºå†…å®¹  
âœ… **æ‰©å±•æ€§å¼º**ï¼šæ”¯æŒä»»æ„æ•°é‡çš„å›½å®¶è€Œä¸å—å­—æ¯é™åˆ¶  

### âœ… å·²å®Œæˆçš„è¿ç§»è®¡åˆ’

```bash
# å·²å®Œæˆè¿ç§» - 2024-07-05
packageJ       â†’ packageJapan         # æ—¥æœ¬ï¼ˆâœ… å·²å®Œæˆï¼‰
packageK       â†’ packagePhilippines   # è²å¾‹å®¾ï¼ˆâœ… å·²å®Œæˆï¼‰
packageL       â†’ packageKorean        # éŸ©å›½ï¼ˆâœ… å·²å®Œæˆï¼‰

# æœªæ¥æ–°å¢žï¼ˆç›´æŽ¥ä½¿ç”¨æ–°æ ¼å¼ï¼‰
packageGermany      # å¾·å›½
packageUSA          # ç¾Žå›½  
packageAustralia    # æ¾³å¤§åˆ©äºš
packageSouthAfrica  # å—éž
```

### è¿ç§»å®Œæˆæ•ˆæžœ

1. âœ… **å‘½åç»Ÿä¸€**ï¼šæ‰€æœ‰åˆ†åŒ…éƒ½é‡‡ç”¨æ¸…æ™°çš„å›½å®¶åç§°
2. âœ… **é…ç½®æ›´æ–°**ï¼šæ‰€æœ‰ç›¸å…³é…ç½®æ–‡ä»¶å·²åŒæ­¥æ›´æ–°
3. âœ… **å‘åŽå…¼å®¹**ï¼šçŽ°æœ‰åŠŸèƒ½å®Œå…¨æ­£å¸¸
4. âœ… **æ–‡æ¡£å®Œå–„**ï¼šå»ºç«‹äº†å®Œæ•´çš„å‘½åæ ‡å‡†æ–‡æ¡£

ðŸ‘€ **è¯¦ç»†çš„å‘½åæ ‡å‡†è¯·å‚è€ƒ**: [åˆ†åŒ…å‘½åæ ‡å‡†æ–‡æ¡£](./package-naming-standard.md)

---

**æ–‡æ¡£ç»´æŠ¤è€…**ï¼šFlightToolbox å¼€å‘å›¢é˜Ÿ  
**æœ€åŽæ›´æ–°**ï¼š2024-01-XX  
**ç‰ˆæœ¬**ï¼š1.0.0