<view class="modern-container">
  <!-- ç°ä»£åŒ–é¡µé¢å¤´éƒ¨ -->
  <view class="modern-header">
    <!-- é¢åŒ…å±‘å¯¼èˆª -->
    <view class="modern-breadcrumb">
      <view class="modern-breadcrumb-item">CCARè§„ç« </view>
      <view class="modern-breadcrumb-separator">></view>
      <view class="modern-breadcrumb-item">è§„èŒƒæ€§æ–‡ä»¶</view>
      <view class="modern-breadcrumb-separator">></view>
      <view class="modern-breadcrumb-item modern-breadcrumb-current">
        {{ regulationTitle || docNumber }}
      </view>
    </view>
    
    <!-- å¤´éƒ¨å†…å®¹ -->
    <view class="modern-header-content">
      <view class="modern-header-left">
        <view class="modern-header-title">è§„èŒƒæ€§æ–‡ä»¶</view>
      </view>
      
      <!-- æœ‰æ•ˆæ€§ç­›é€‰æ§ä»¶ -->
      <view class="modern-filter-controls">
        <view 
          class="modern-filter-button {{ validityFilter === 'all' ? 'active' : '' }}"
          bind:tap="onFilterChange"
          data-filter="all"
        >
          å…¨éƒ¨
        </view>
        <view 
          class="modern-filter-button success {{ validityFilter === 'valid' ? 'active' : '' }}"
          bind:tap="onFilterChange"
          data-filter="valid"
        >
          æœ‰æ•ˆ
        </view>
        <view 
          class="modern-filter-button error {{ validityFilter === 'invalid' ? 'active' : '' }}"
          bind:tap="onFilterChange"
          data-filter="invalid"
        >
          å¤±æ•ˆ
        </view>
      </view>
    </view>
  </view>

  <!-- ç°ä»£åŒ–è§„èŒƒæ€§æ–‡ä»¶åˆ—è¡¨ -->
  <view class="modern-card-container">
    <view wx:if="{{ displayedNormatives.length === 0 && !loading }}" class="modern-empty-state fade-in">
      <view class="modern-empty-icon">ğŸ“„</view>
      <view class="modern-empty-text">æš‚æ— ç›¸å…³è§„èŒƒæ€§æ–‡ä»¶</view>
      <view class="modern-empty-hint">è¯¥è§„ç« å¯èƒ½è¿˜æ²¡æœ‰é…å¥—çš„è§„èŒƒæ€§æ–‡ä»¶ï¼Œæˆ–å°è¯•è°ƒæ•´ç­›é€‰æ¡ä»¶</view>
    </view>

    <view wx:else class="modern-card-list fade-in">
      <view
        wx:for="{{ displayedNormatives }}"
        wx:key="id"
        class="modern-card-item hover-lift bounce-click"
      >
        <!-- æœ‰æ•ˆæ€§å¾½ç«  - å³ä¸Šè§’ä½ç½® -->
        <view class="modern-validity-badge {{ item.validity === 'æœ‰æ•ˆ' ? 'valid' : 'invalid' }}">
          {{ item.validity }}
        </view>
        
        <view class="modern-card-main" bind:tap="onFileDetail" data-normative="{{ item }}">
          <!-- å¡ç‰‡å¤´éƒ¨ -->
          <view class="modern-card-header">
            <view class="modern-card-number success">{{ item.doc_number }}</view>
          </view>
          
          <!-- æ–‡ä»¶æ ‡é¢˜ -->
          <view class="modern-card-title">{{ item.title }}</view>
        </view>
        
        <!-- å¡ç‰‡å…ƒä¿¡æ¯ - å·¦ä¸‹è§’ä½ç½® -->
        <view class="modern-card-meta">
          <view class="meta-date">{{ item.publish_date }}</view>
          <view class="meta-office">{{ item.office_unit }}</view>
        </view>
        
        <!-- å¡ç‰‡æ“ä½œåŒºåŸŸ -->
        <view class="modern-card-actions">
          <view
            class="modern-action-button primary small bounce-click"
            bind:tap="onCopyLink"
            data-normative="{{ item }}"
          >
            <van-icon name="link" size="14" />
            <text style="margin-left: 4rpx;">å¤åˆ¶é“¾æ¥</text>
          </view>
        </view>
      </view>

      <!-- åŠ è½½æ›´å¤šæŒ‰é’® -->
      <view wx:if="{{ hasMore }}" class="modern-load-more">
        <view
          class="modern-load-more-button {{ loadingMore ? 'loading' : '' }}"
          bind:tap="onLoadMore"
        >
          <view wx:if="{{ loadingMore }}" class="loading-icon">â³</view>
          <text>{{ loadingMore ? 'åŠ è½½ä¸­...' : 'åŠ è½½æ›´å¤š' }}</text>
        </view>
      </view>

      <!-- æ²¡æœ‰æ›´å¤šæ•°æ®æç¤º -->
      <view wx:elif="{{ displayedNormatives.length > 0 }}" class="modern-no-more">
        <view class="no-more-text">å·²æ˜¾ç¤ºå…¨éƒ¨æ•°æ®</view>
      </view>
    </view>
  </view>

  <!-- ç°ä»£åŒ–ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="modern-stats-footer">
    <view class="modern-stats-text">
      å½“å‰æ˜¾ç¤º {{ displayedNormatives.length }} / {{ filteredNormatives.length }} ä¸ªè§„èŒƒæ€§æ–‡ä»¶
      <text wx:if="{{ validityFilter !== 'all' }}">
        ï¼ˆ{{ validityFilter === 'valid' ? 'æœ‰æ•ˆ' : 'å¤±æ•ˆ' }}æ–‡ä»¶ï¼‰
      </text>
      <text wx:if="{{ filteredNormatives.length !== normatives.length }}">
        ï¼Œå…± {{ normatives.length }} ä¸ª
      </text>
    </view>
  </view>
</view>

<van-toast id="van-toast" />