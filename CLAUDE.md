# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

è¯·ç”¨ä¸­æ–‡å›å¤

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 5åˆ†é’Ÿä¸Šæ‰‹å¼€å‘

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd D:\FlightToolbox

# 2. å®‰è£…ä¾èµ–
cd miniprogram && npm install

# 3. åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­ï¼ˆå»ºè®®ä½¿ç”¨ç¨³å®šç‰ˆï¼‰ï¼š
#    - å¯¼å…¥é¡¹ç›®ï¼šé€‰æ‹© D:\FlightToolbox ç›®å½•
#    - å·¥å…· -> æ„å»ºnpm -> ç¡®è®¤æ„å»º
#    - ç¼–è¯‘ï¼šç‚¹å‡»ç¼–è¯‘æŒ‰é’®

# 4. å¼€å§‹å¼€å‘ï¼š
#    - é¢„è§ˆï¼šæ‰«ç çœŸæœºæµ‹è¯•
#    - å¼€å¯é£è¡Œæ¨¡å¼éªŒè¯ç¦»çº¿åŠŸèƒ½
```

### æ–°é¡µé¢å¼€å‘æ¨¡æ¿

```javascript
// æ‰€æœ‰æ–°é¡µé¢å¿…é¡»ä½¿ç”¨BasePageåŸºç±»
var BasePage = require('../../utils/base-page.js');

var pageConfig = {
  data: {
    // é¡µé¢æ•°æ®
    loading: false,
    list: []
  },
  
  customOnLoad: function(options) {
    console.log('é¡µé¢åŠ è½½ï¼Œå‚æ•°:', options);
    this.loadData();
  },
  
  // æ•°æ®åŠ è½½ç¤ºä¾‹
  loadData: function() {
    var self = this;
    this.loadDataWithLoading(function() {
      // è¿”å›Promiseæˆ–ç›´æ¥è¿”å›æ•°æ®
      return new Promise(function(resolve) {
        setTimeout(function() {
          resolve([{id: 1, name: 'ç¤ºä¾‹æ•°æ®'}]);
        }, 1000);
      });
    }, {
      dataKey: 'list',
      context: 'åŠ è½½æ•°æ®'
    });
  },
  
  // åˆ†åŒ…æ•°æ®åŠ è½½ç¤ºä¾‹
  loadSubpackageData: function() {
    this.loadSubpackageData('packageA', '../../packageA/data.js', {
      context: 'ICAOæ•°æ®',
      fallbackData: []
    });
  }
};

// ä½¿ç”¨BasePageåˆ›å»ºé¡µé¢
Page(BasePage.createPage(pageConfig));
```

### æ ¸å¿ƒå¼€å‘åŸåˆ™

1. **ç¦»çº¿ä¼˜å…ˆ**ï¼šæ‰€æœ‰åŠŸèƒ½å¿…é¡»åœ¨é£è¡Œæ¨¡å¼ä¸‹å¯ç”¨
2. **ä½¿ç”¨åŸºç±»**ï¼šæ–°é¡µé¢å¿…é¡»ç»§æ‰¿BasePage
3. **ES5è¯­æ³•**ï¼šç¡®ä¿å°ç¨‹åºå…¼å®¹æ€§
4. **åˆ†åŒ…å¼‚æ­¥**ï¼šè·¨åˆ†åŒ…å¼•ç”¨å¿…é¡»ä½¿ç”¨å¼‚æ­¥æ–¹å¼
5. **é”™è¯¯å¤„ç†**ï¼šä½¿ç”¨ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶

## ğŸ“± é¡¹ç›®æ¦‚è¿°

FlightToolbox æ˜¯ä¸€ä¸ªä¸“ä¸ºèˆªç©ºé£è¡Œå‘˜è®¾è®¡çš„å¾®ä¿¡å°ç¨‹åºï¼Œä¸“æ³¨äºèˆªç©ºé£è¡Œå·¥å…·å’Œèˆªçº¿å½•éŸ³åŠŸèƒ½ã€‚ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š

- **ğŸ›« èˆªçº¿é£è¡Œæ¨¡å—**ï¼šçœŸå®æœºåœºèˆªçº¿å½•éŸ³æ’­æ”¾å’Œå­¦ä¹ 
- **ğŸ” èµ„æ–™æŸ¥è¯¢**ï¼šICAOä»£ç ã€ç¼©å†™ã€å®šä¹‰ã€æœºåœºä¿¡æ¯æŸ¥è¯¢
- **ğŸ§® é£è¡Œè®¡ç®—**ï¼šå„ç§èˆªç©ºè®¡ç®—å™¨å’Œå·¥å…·
- **ğŸ“» é€šä¿¡å¤±æ•ˆç¨‹åº**ï¼šå„åœ°åŒºé€šä¿¡å¤±æ•ˆå¤„ç†å·®å¼‚ç¨‹åº
- **ğŸ› ï¸ å…¶ä»–å·¥å…·**ï¼šä¸ªäººæ£€æŸ¥å•ã€èµ„è´¨ç®¡ç†ã€äº‹ä»¶æŠ¥å‘Šç­‰

## ğŸš¨ CRITICAL - å¿…é¡»ç¦»çº¿è¿è¡Œ

æœ¬å°ç¨‹åºä¸“ä¸ºèˆªç©ºé£è¡Œå‘˜è®¾è®¡ï¼Œ**å¿…é¡»èƒ½å¤Ÿåœ¨å®Œå…¨ç¦»çº¿ç¯å¢ƒä¸‹æ­£å¸¸è¿è¡Œ**ã€‚

### ä¸ºä»€ä¹ˆå¿…é¡»ç¦»çº¿ï¼Ÿ

1. **é£è¡Œå®‰å…¨è¦æ±‚**ï¼šé£è¡Œå‘˜åœ¨ç©ºä¸­æ‰§è¡Œä»»åŠ¡æ—¶ï¼Œæ‰‹æœºå¿…é¡»å¼€å¯é£è¡Œæ¨¡å¼
2. **é«˜ç©ºç½‘ç»œé™åˆ¶**ï¼šä¸‡ç±³é«˜ç©ºä¸­æ— æ³•ä½¿ç”¨ç§»åŠ¨ç½‘ç»œæˆ–WiFi
3. **ç´§æ€¥æƒ…å†µå¤„ç†**ï¼šé€šä¿¡å¤±æ•ˆç­‰ç´§æ€¥æƒ…å†µä¸‹ï¼Œé£è¡Œå‘˜éœ€è¦ç«‹å³è®¿é—®ç¨‹åºå’Œæ•°æ®
4. **æ³•è§„éµå¾ª**ï¼šæ°‘èˆªæ³•è§„è¦æ±‚é£è¡Œè¿‡ç¨‹ä¸­å…³é—­æ— çº¿é€šä¿¡åŠŸèƒ½

### è®¾è®¡è¦æ±‚

- âœ… **æ‰€æœ‰æ ¸å¿ƒæ•°æ®å¿…é¡»æœ¬åœ°å­˜å‚¨**ï¼šICAOä»£ç ã€æœºåœºæ•°æ®ã€é€šä¿¡ç¨‹åºç­‰
- âœ… **éŸ³é¢‘æ–‡ä»¶å¿…é¡»æœ¬åœ°ç¼“å­˜**ï¼šèˆªçº¿å½•éŸ³ã€å‘éŸ³ç¤ºä¾‹ç­‰
- âœ… **åˆ†åŒ…é¢„åŠ è½½ç­–ç•¥**ï¼šç¡®ä¿å…³é”®æ•°æ®åœ¨ç¦»çº¿æ—¶å¯ç”¨
- âœ… **æ— ç½‘ç»œä¾èµ–åŠŸèƒ½**ï¼šè®¡ç®—å™¨ã€æ£€æŸ¥å•ã€ç¨‹åºæŸ¥è¯¢ç­‰
- âŒ **ç¦æ­¢åœ¨çº¿APIè°ƒç”¨**ï¼šä¸èƒ½ä¾èµ–å®æ—¶ç½‘ç»œæ•°æ®
- âŒ **ç¦æ­¢äº‘ç«¯å­˜å‚¨ä¾èµ–**ï¼šç”¨æˆ·æ•°æ®å¿…é¡»æœ¬åœ°å­˜å‚¨

### æµ‹è¯•éªŒè¯

å¼€å‘æ—¶å¿…é¡»éªŒè¯ï¼š

1. å¼€å¯é£è¡Œæ¨¡å¼åæ‰€æœ‰åŠŸèƒ½æ­£å¸¸
2. åˆ†åŒ…æ•°æ®åœ¨æ— ç½‘ç»œæ—¶å¯æ­£å¸¸åŠ è½½
3. éŸ³é¢‘æ’­æ”¾åœ¨ç¦»çº¿çŠ¶æ€ä¸‹æ­£å¸¸
4. è®¡ç®—å’ŒæŸ¥è¯¢åŠŸèƒ½å®Œå…¨ç¦»çº¿å¯ç”¨

## ğŸš¨ JavaScript è¯­æ³•å…¼å®¹æ€§æŒ‡å—

### ç°çŠ¶ç¡®è®¤

é¡¹ç›®é…ç½®ä¸­å·²å¯ç”¨ES6è½¬æ¢ï¼ˆ`"es6": true`ï¼‰ï¼Œå¾®ä¿¡å¼€å‘è€…å·¥å…·ä¼šè‡ªåŠ¨å¤„ç†ES6+è¯­æ³•çš„å…¼å®¹æ€§è½¬æ¢ã€‚

### JavaScript æ”¯æŒæƒ…å†µ

#### è¿è¡Œé™åˆ¶

åŸºäºå®‰å…¨è€ƒè™‘ï¼Œå°ç¨‹åºä¸­ä¸æ”¯æŒåŠ¨æ€æ‰§è¡Œ JS ä»£ç ï¼Œå³ï¼š

- âŒ ä¸æ”¯æŒä½¿ç”¨ `eval` æ‰§è¡Œ JS ä»£ç 
- âŒ ä¸æ”¯æŒä½¿ç”¨ `new Function` åˆ›å»ºå‡½æ•°ï¼ˆ`new Function('return this')` é™¤å¤–ï¼‰

#### æ ‡å‡† ECMAScript æ”¯æŒ

å°ç¨‹åºçš„ JS æ‰§è¡Œç¯å¢ƒåœ¨ä¸åŒå¹³å°ä¸Šå­˜åœ¨å·®å¼‚ï¼Œå› æ­¤å¯¼è‡´ä¸åŒå¹³å°å¯¹ ECMAScript æ ‡å‡†çš„æ”¯æŒå­˜åœ¨å·®å¼‚ã€‚

å°ç¨‹åºåŸºç¡€åº“å†…ç½®äº†ä¸€ä»½ **core-js Polyfill** æ¥å°½é‡æŠ¹å¹³è¿™äº›å·®å¼‚ï¼Œå¯ä»¥å°†å¹³å°ç¯å¢ƒç¼ºå¤±çš„æ ‡å‡† API è¡¥é½ã€‚

âš ï¸ **æ³¨æ„**ï¼šå¹³å°å¯¹ ECMAScript è¯­æ³•çš„æ”¯æŒå·®å¼‚æ— æ³•æŠ¹å¹³ï¼Œå½“ä½¿ç”¨é«˜çº§è¯­æ³•ï¼ˆå¦‚ `async/await`ï¼‰æ—¶ï¼Œéœ€è¦å€ŸåŠ©ä»£ç è½¬æ¢å·¥å…·æ¥æ”¯æŒè¿™äº›è¯­æ³•ã€‚

#### æ— æ³•è¢« Polyfill çš„ API

ä»¥ä¸‹ API åœ¨éƒ¨åˆ†ä½ç‰ˆæœ¬å®¢æˆ·ç«¯ä¸­æ— æ³•ä½¿ç”¨ï¼Œè¯·æ³¨æ„å°½é‡é¿å…ä½¿ç”¨ï¼š

- âŒ `Proxy` å¯¹è±¡

#### ä¸æ ‡å‡†çš„å·®å¼‚

**Promise æ—¶åºå·®å¼‚**ï¼š
ç”±äº iOS JavaScriptCore çš„é™åˆ¶ï¼ŒiOS 15 åŠä»¥ä¸‹çš„ Promise æ˜¯ä¸€ä¸ªä½¿ç”¨ setTimeout æ¨¡æ‹Ÿçš„ Polyfillã€‚è¿™æ„å‘³ç€ Promise è§¦å‘çš„ä»»åŠ¡ä¸ºæ™®é€šä»»åŠ¡ï¼Œè€Œéå¾®ä»»åŠ¡ï¼Œè¿›è€Œå¯¼è‡´åœ¨ iOS15 åŠä»¥ä¸‹çš„ Promise æ—¶åºä¼šå’Œæ ‡å‡†å­˜åœ¨å·®å¼‚ã€‚

```javascript
var arr = []

setTimeout(() => arr.push(6), 0)
arr.push(1)
const p = new Promise(resolve => {
  arr.push(2)
  resolve()
})
arr.push(3)
p.then(() => arr.push(5))
arr.push(4)
setTimeout(() => arr.push(7), 0)

setTimeout(() => {
  // æ ‡å‡†åº”è¯¥è¾“å‡º [1,2,3,4,5,6,7]
  // åœ¨ iOS15 å°ç¨‹åºç¯å¢ƒï¼Œè¿™é‡Œä¼šè¾“å‡º [1,2,3,4,6,5,7]
  console.log(arr)
}, 1000)
```

iOS 16 åŠä»¥ä¸Šä¸å­˜åœ¨æ­¤å·®å¼‚ã€‚

### è¯­æ³•é”™è¯¯æ’æŸ¥æŒ‡å—

#### å¦‚æœé‡åˆ° "Unexpected token: punc (.)" é”™è¯¯

1. **æ£€æŸ¥é¡¹ç›®é…ç½®**ï¼šç¡®è®¤ `project.config.json` ä¸­ `"es6": true` å·²å¯ç”¨
2. **æ£€æŸ¥åŸºç¡€åº“ç‰ˆæœ¬**ï¼šç¡®è®¤ä½¿ç”¨çš„åŸºç¡€åº“ç‰ˆæœ¬æ”¯æŒæ‰€éœ€è¯­æ³•
3. **çœŸæœºæµ‹è¯•**ï¼šåœ¨çœŸæœºä¸ŠéªŒè¯åŠŸèƒ½æ˜¯å¦æ­£å¸¸
4. **é™çº§å¤„ç†**ï¼šå¦‚é‡å…¼å®¹æ€§é—®é¢˜ï¼Œè€ƒè™‘ä½¿ç”¨æ›´å…¼å®¹çš„è¯­æ³•

#### æ¨èçš„å…¼å®¹æ€§ç­–ç•¥

1. **ä¼˜å…ˆä½¿ç”¨ES6+è¯­æ³•**ï¼šåˆ©ç”¨å·¥å…·è‡ªåŠ¨è½¬æ¢
2. **å…³é”®åŠŸèƒ½å…¼å®¹æ€§æµ‹è¯•**ï¼šç¡®ä¿æ ¸å¿ƒåŠŸèƒ½åœ¨ç›®æ ‡è®¾å¤‡ä¸Šæ­£å¸¸è¿è¡Œ
3. **Polyfillä½¿ç”¨**ï¼šåˆç†ä½¿ç”¨å†…ç½®çš„core-js Polyfill
4. **é¿å…ä½¿ç”¨ä¸æ”¯æŒçš„API**ï¼šå¦‚Proxyç­‰

### å¼€å‘å»ºè®®

1. **ç°ä»£è¯­æ³•**ï¼šå¯ä»¥ä½¿ç”¨ES6+è¯­æ³•ï¼Œå·¥å…·ä¼šè‡ªåŠ¨å¤„ç†å…¼å®¹æ€§
2. **æµ‹è¯•éªŒè¯**ï¼šé‡ç‚¹åœ¨çœŸæœºä¸Šæµ‹è¯•ï¼Œç‰¹åˆ«æ˜¯ä½ç‰ˆæœ¬iOSè®¾å¤‡
3. **é”™è¯¯å¤„ç†**ï¼šé‡åˆ°å…¼å®¹æ€§é—®é¢˜æ—¶ï¼Œé‡‡ç”¨æ›´ä¿å®ˆçš„è¯­æ³•å®ç°

## ğŸ“¦ é‡æ„åçš„ç»Ÿä¸€ç»„ä»¶æ¶æ„ï¼ˆ2025å¹´7æœˆï¼‰

### ğŸ¯ æ ¸å¿ƒç»„ä»¶ä½¿ç”¨

é‡æ„åé¡¹ç›®æä¾›ç»Ÿä¸€çš„åŸºç±»å’Œç»„ä»¶ï¼Œ**æ‰€æœ‰æ–°é¡µé¢å¿…é¡»ä½¿ç”¨ä»¥ä¸‹ç»„ä»¶**ï¼š

#### 1. BasePage ç»Ÿä¸€é¡µé¢åŸºç±»

```javascript
// æ–°é¡µé¢å¿…é¡»ä½¿ç”¨BasePageåŸºç±»
var BasePage = require('../../utils/base-page.js');

var pageConfig = {
  data: {
    // é¡µé¢æ•°æ®
  },
  
  customOnLoad: function(options) {
    // è‡ªå®šä¹‰åŠ è½½é€»è¾‘ï¼ˆä¸»é¢˜ç®¡ç†è‡ªåŠ¨å¤„ç†ï¼‰
  },
  
  // ä½¿ç”¨åŸºç±»æä¾›çš„æ–¹æ³•
  myMethod: function() {
    this.loadDataWithLoading(loadFunction, options);
    this.showSuccess('æ“ä½œæˆåŠŸ');
    this.handleError(error, 'æ“ä½œå¤±è´¥');
  }
};

Page(BasePage.createPage(pageConfig));
```

#### 2. SearchComponent ç»Ÿä¸€æœç´¢ç»„ä»¶

```javascript
var SearchComponent = require('../../utils/search-component.js');
var searchComponent = SearchComponent.createSearchComponent();

// åœ¨é¡µé¢ä¸­ä½¿ç”¨
performSearch: function(keyword) {
  var results = searchComponent.search(keyword, this.data.originalData, {
    searchFields: ['name', 'description']
  });
  this.setData({ filteredData: results });
}
```

#### 3. PickerComponent ç»Ÿä¸€é€‰æ‹©å™¨ç»„ä»¶

```javascript
var PickerComponent = require('../../utils/picker-component.js');
var pickerComponent = PickerComponent.createPickerComponent();

// åˆ›å»ºé€‰æ‹©å™¨æ··å…¥
var pickerMixin = pickerComponent.createPickerMixin({
  onConfirm: function(event) {
    // å¤„ç†é€‰æ‹©ç»“æœ
  }
});
```

#### 4. DataLoader ç»Ÿä¸€æ•°æ®åŠ è½½

```javascript
var dataLoader = require('../../utils/data-loader.js');

// åˆ†åŒ…æ•°æ®åŠ è½½
dataLoader.loadSubpackageData(this, 'packageA', '../../packageA/data.js', {
  fallbackData: [],
  context: 'åˆ†åŒ…æ•°æ®'
});
```

### ğŸš¨ é‡è¦çº¦å®š

1. **JavaScriptè¯­æ³•**ï¼šæ”¯æŒES6+è¯­æ³•ï¼ŒåŒ…æ‹¬classã€ç®­å¤´å‡½æ•°ã€æ¨¡æ¿å­—ç¬¦ä¸²ç­‰
2. **ç”Ÿå‘½å‘¨æœŸ**ï¼šä½¿ç”¨ `customOnLoad`ã€`customOnShow` ç­‰è‡ªå®šä¹‰ç”Ÿå‘½å‘¨æœŸ
3. **é”™è¯¯å¤„ç†**ï¼šä¼˜å…ˆä½¿ç”¨åŸºç±»çš„ `handleError()` æ–¹æ³•
4. **æ•°æ®åŠ è½½**ï¼šä¼˜å…ˆä½¿ç”¨åŸºç±»çš„ `loadDataWithLoading()` æ–¹æ³•
5. **ä¸»é¢˜ç®¡ç†**ï¼šåŸºç±»è‡ªåŠ¨å¤„ç†ï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç†

### ğŸ“‹ é‡æ„å®ŒæˆçŠ¶æ€

- âœ… **BasePageåŸºç±»**ï¼šå·²å®Œæˆï¼Œè§£å†³48ä¸ªæ–‡ä»¶çš„ä¸»é¢˜ç®¡ç†é‡å¤
- âœ… **æœç´¢ç»„ä»¶**ï¼šå·²å®Œæˆï¼Œè§£å†³6ä¸ªæ–‡ä»¶çš„æœç´¢åŠŸèƒ½é‡å¤
- âœ… **Pickerç»„ä»¶**ï¼šå·²å®Œæˆï¼Œè§£å†³14ä¸ªæ–‡ä»¶çš„é€‰æ‹©å™¨é‡å¤
- âœ… **æ•°æ®åŠ è½½å™¨**ï¼šå·²å®Œæˆï¼Œæ”¯æŒåˆ†åŒ…å¼‚æ­¥åŒ–å’Œç¦»çº¿ç¼“å­˜
- âœ… **é”™è¯¯å¤„ç†ç³»ç»Ÿ**ï¼šå·²å®Œæˆï¼Œè§£å†³74ä¸ªæ–‡ä»¶çš„é”™è¯¯å¤„ç†é‡å¤

### ğŸ“– è¯¦ç»†æ–‡æ¡£

å‚è€ƒ `miniprogram/utils/README.md` è·å–å®Œæ•´çš„ç»„ä»¶ä½¿ç”¨æŒ‡å—ã€‚

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### ğŸš¨ é‡è¦æ›´æ–°ï¼šé©¾é©¶èˆ±é…ç½®æ¨¡å—é‡æ„ (2025å¹´7æœˆ)

é©¾é©¶èˆ±æ¨¡å—å·²å®Œæˆé‡å¤§é…ç½®ç®¡ç†é‡æ„ï¼Œé‡‡ç”¨æ¨¡å—åŒ–é…ç½®ç®¡ç†æ¶æ„ï¼š

#### é©¾é©¶èˆ±é…ç½®æ¨¡å—ç»“æ„
```
pages/cockpit/
â”œâ”€â”€ index.js              # ä¸»é¡µé¢é€»è¾‘ï¼ˆä½¿ç”¨BasePageåŸºç±»ï¼‰
â”œâ”€â”€ index.wxml             # é¡µé¢ç»“æ„
â”œâ”€â”€ index.wxss             # é¡µé¢æ ·å¼
â””â”€â”€ modules/
    â””â”€â”€ config.js          # é…ç½®ç®¡ç†æ¨¡å—ï¼ˆæ–°å¢ï¼‰
                          # é›†ä¸­ç®¡ç†æ‰€æœ‰é…ç½®å‚æ•°
```

#### é…ç½®æ¨¡å—æ¶æ„ç‰¹ç‚¹
- **é›†ä¸­åŒ–ç®¡ç†**ï¼šæ‰€æœ‰ç¡¬ç¼–ç å‚æ•°ç§»è‡³é…ç½®æ¨¡å—
- **ç»“æ„åŒ–åˆ†ç±»**ï¼šGPSã€æŒ‡å—é’ˆã€åœ°å›¾ã€ç¦»çº¿æ¨¡å¼ç­‰åˆ†ç±»é…ç½®
- **47ä¸ªé…ç½®é¡¹**ï¼šè¦†ç›–GPSã€æŒ‡å—é’ˆã€åœ°å›¾ã€æ€§èƒ½ä¼˜åŒ–ç­‰æ‰€æœ‰å‚æ•°
- **å¯ç»´æŠ¤æ€§**ï¼šå•ä¸€èŒè´£ï¼Œä¾¿äºè°ƒæ•´å’Œæ‰©å±•

#### é…ç½®ä½¿ç”¨ç¤ºä¾‹
```javascript
var config = require('./modules/config.js');

// GPSé…ç½®è®¿é—®
var maxSpeed = config.gps.maxReasonableSpeed;           // 600kt
var gpsThreshold = config.gps.signalLossThreshold;      // 30ç§’

// æŒ‡å—é’ˆé…ç½®è®¿é—®
var headingBuffer = config.compass.headingBufferSize;   // 15
var compassInterval = config.compass.compassInterval;   // 'game'

// åœ°å›¾é…ç½®è®¿é—®
var zoomLevels = config.map.zoomLevels;                 // [5,10,20,40,80,160,320,640]
var updateInterval = config.map.updateInterval;         // 2000ms

// ç¦»çº¿æ¨¡å¼é…ç½®
var simData = config.offline.simulatedData;            // æ¨¡æ‹ŸGPSæ•°æ®
```

### ğŸ“ ç³»ç»Ÿæ¶æ„å›¾

#### æ€»ä½“æ¶æ„å±‚æ¬¡
```
FlightToolbox å¾®ä¿¡å°ç¨‹åº
â”œâ”€â”€ ä¸»åŒ… (miniprogram/) [< 2MB]
â”‚   â”œâ”€â”€ æ ¸å¿ƒé¡µé¢ (27ä¸ª)
â”‚   â”œâ”€â”€ ç»Ÿä¸€åŸºç±»ç³»ç»Ÿ (utils/)
â”‚   â”œâ”€â”€ ä¸»é¢˜ç®¡ç†
â”‚   â””â”€â”€ åˆ†åŒ…è°ƒåº¦ä¸­å¿ƒ
â”‚
â”œâ”€â”€ åŠŸèƒ½åˆ†åŒ…ç»„ [11ä¸ªåˆ†åŒ…]
â”‚   â”œâ”€â”€ packageA (ICAOä»£ç ) - 30ä¸‡æ¡è®°å½•
â”‚   â”œâ”€â”€ packageB (ç¼©å†™æ•°æ®) - 2ä¸‡æ¡è®°å½•  
â”‚   â”œâ”€â”€ packageC (æœºåœºæ•°æ®) - 5åƒæ¡è®°å½•
â”‚   â”œâ”€â”€ packageD (å®šä¹‰æ•°æ®) - 3åƒæ¡è®°å½•
â”‚   â”œâ”€â”€ packageF (ACRæ•°æ®) - è·‘é“ç³»æ•°
â”‚   â”œâ”€â”€ packageG (å±é™©å“æ•°æ®) - è¿è¾“è§„èŒƒ
â”‚   â”œâ”€â”€ packageH (åŒå‘å¤é£æ•°æ®) - æ¢¯åº¦è®¡ç®—
â”‚   â”œâ”€â”€ packageO (å…¶ä»–é¡µé¢åŠŸèƒ½) - å·¥å…·é›†åˆ
â”‚   â”œâ”€â”€ packagePerformance (æ€§èƒ½å‚æ•°) - é£æœºæ€§èƒ½
â”‚   â”œâ”€â”€ packageHealth (èˆªåŒ»å¥åº·) - åŒ»å­¦æ ‡å‡†
â”‚   â””â”€â”€ packageCCAR (CAACè§„ç« ) - æ³•è§„æ–‡ä»¶
â”‚
â””â”€â”€ éŸ³é¢‘åˆ†åŒ…ç»„ [13ä¸ªåˆ†åŒ…] 
    â”œâ”€â”€ äºšæ´²æ¿å—
    â”‚   â”œâ”€â”€ packageJapan (æ—¥æœ¬) - 24æ¡å½•éŸ³
    â”‚   â”œâ”€â”€ packageKorean (éŸ©å›½) - 19æ¡å½•éŸ³
    â”‚   â”œâ”€â”€ packageSingapore (æ–°åŠ å¡) - 8æ¡å½•éŸ³
    â”‚   â”œâ”€â”€ packageThailand (æ³°å›½) - 22æ¡å½•éŸ³
    â”‚   â””â”€â”€ packagePhilippines (è²å¾‹å®¾) - 27æ¡å½•éŸ³
    â”œâ”€â”€ æ¬§æ´²æ¿å—
    â”‚   â”œâ”€â”€ packageRussia (ä¿„ç½—æ–¯) - 23æ¡å½•éŸ³
    â”‚   â”œâ”€â”€ packageFrance (æ³•å›½) - 19æ¡å½•éŸ³
    â”‚   â”œâ”€â”€ packageTurkey (åœŸè€³å…¶) - 28æ¡å½•éŸ³
    â”‚   â””â”€â”€ packageItaly (æ„å¤§åˆ©) - 29æ¡å½•éŸ³
    â”œâ”€â”€ ç¾æ´²æ¿å—
    â”‚   â””â”€â”€ packageAmerica (ç¾å›½) - 52æ¡å½•éŸ³
    â”œâ”€â”€ å¤§æ´‹æ´²æ¿å—
    â”‚   â””â”€â”€ packageAustralia (æ¾³å¤§åˆ©äºš) - 20æ¡å½•éŸ³
    â”œâ”€â”€ å…¶ä»–åœ°åŒº
    â”‚   â”œâ”€â”€ packageSrilanka (æ–¯é‡Œå…°å¡) - 22æ¡å½•éŸ³
    â”‚   â””â”€â”€ packageUAE (é˜¿è”é…‹) - 37æ¡å½•éŸ³
```

#### åˆ†åŒ…é¢„åŠ è½½ä¾èµ–å…³ç³»
```
é¡µé¢ â†’ é¢„åŠ è½½åˆ†åŒ…å…³ç³»å›¾

pages/home/index
â””â”€â”€ packageKorean (å¸¸ç”¨éŸ³é¢‘ä¼˜å…ˆåŠ è½½)

pages/search/index  
â”œâ”€â”€ packageA (ICAOæŸ¥è¯¢æ ¸å¿ƒ)
â””â”€â”€ packageB (ç¼©å†™æŸ¥è¯¢æ ¸å¿ƒ)

pages/flight-calculator/index
â”œâ”€â”€ packageF (ACRè®¡ç®—æ•°æ®)
â””â”€â”€ packageO (è®¡ç®—å·¥å…·é›†åˆ)

pages/performance-parameters/index
â”œâ”€â”€ packagePerformance (æ€§èƒ½æ•°æ®)
â”œâ”€â”€ packageF (ACRæ•°æ®)
â””â”€â”€ packageO (ç›¸å…³å·¥å…·)

pages/operations/index
â”œâ”€â”€ packagePhilippines (è¿è¡ŒéŸ³é¢‘)
â””â”€â”€ packageSingapore (è¿è¡ŒéŸ³é¢‘)
```

#### éŸ³é¢‘ç³»ç»Ÿä¸‰å±‚æ¶æ„
```
ğŸµ éŸ³é¢‘é…ç½®æ¶æ„è¯¦å›¾

æ•°æ®å±‚ (miniprogram/data/regions/)
â”œâ”€â”€ japan.js (æ—¥æœ¬å½•éŸ³å…ƒæ•°æ®)
â”œâ”€â”€ korean.js (éŸ©å›½å½•éŸ³å…ƒæ•°æ®)  
â”œâ”€â”€ singapore.js (æ–°åŠ å¡å½•éŸ³å…ƒæ•°æ®)
â””â”€â”€ ... (å…¶ä»–10ä¸ªå›½å®¶æ•°æ®æ–‡ä»¶)
    â”œâ”€â”€ æœºåœºICAOä»£ç é…ç½®
    â”œâ”€â”€ å½•éŸ³æ–‡ä»¶è·¯å¾„æ˜ å°„
    â”œâ”€â”€ åˆ†åŒ…åç§°æ˜ å°„
    â””â”€â”€ åŒºåŸŸåˆ†ç±»ä¿¡æ¯

         â¬‡ï¸

é…ç½®å±‚ (miniprogram/utils/audio-config.js)
â”œâ”€â”€ AudioConfigManager (ç»Ÿä¸€ç®¡ç†å™¨)
â”œâ”€â”€ å¤§æ´²åˆ†ç±» (äºšæ´²ã€æ¬§æ´²ã€ç¾æ´²ã€å¤§æ´‹æ´²ã€å…¶ä»–)
â”œâ”€â”€ å›½å®¶/åœ°åŒºæ˜ å°„ (13ä¸ªå›½å®¶åœ°åŒº)
â”œâ”€â”€ åˆ†åŒ…åŠ¨æ€åŠ è½½
â””â”€â”€ éŸ³é¢‘è·¯å¾„è§£æ

         â¬‡ï¸

åˆ†åŒ…å±‚ (package*/) 
â”œâ”€â”€ packageJapan/audios/ (æ—¥æœ¬æœºåœºå½•éŸ³æ–‡ä»¶)
â”œâ”€â”€ packageKorean/audios/ (éŸ©å›½æœºåœºå½•éŸ³æ–‡ä»¶)
â”œâ”€â”€ packageSingapore/audios/ (æ–°åŠ å¡æœºåœºå½•éŸ³æ–‡ä»¶)  
â””â”€â”€ ... (å…¶ä»–éŸ³é¢‘åˆ†åŒ…ç‰©ç†å­˜å‚¨)
```

### å°ç¨‹åºæ¶æ„

- **æ¡†æ¶**ï¼šå¾®ä¿¡å°ç¨‹åºåŸç”Ÿæ¡†æ¶
- **ç»„ä»¶åº“**ï¼šVant Weapp UIç»„ä»¶åº“  
- **å¼€å‘è¯­è¨€**ï¼šJavaScript (ES6+è¯­æ³•å®Œå…¨æ”¯æŒ)
- **ç¼–è¯‘å™¨**ï¼šå¯ç”¨ES6è½¬æ¢å’ŒSWCç¼–è¯‘å™¨ï¼Œè‡ªåŠ¨å¤„ç†å…¼å®¹æ€§

### ğŸ“¦ åˆ†åŒ…ç»“æ„

é¡¹ç›®é‡‡ç”¨åˆ†åŒ…æ¶æ„ï¼ŒæŒ‰åŠŸèƒ½å’Œåœ°åŒºåˆ†åŒ…ï¼š

#### åŠŸèƒ½åˆ†åŒ…

- `packageA` - ICAOä»£ç æ•°æ® (30ä¸‡æ¡è®°å½•)
- `packageB` - ç¼©å†™æ•°æ® (2ä¸‡æ¡è®°å½•)
- `packageC` - æœºåœºæ•°æ® (5åƒæ¡è®°å½•)
- `packageD` - å®šä¹‰æ•°æ® (3åƒæ¡è®°å½•)
- `packageF` - ACRæ•°æ® (è·‘é“ç³»æ•°)
- `packageG` - å±é™©å“æ•°æ® (è¿è¾“è§„èŒƒ)
- `packageH` - åŒå‘å¤é£æ•°æ® (æ¢¯åº¦è®¡ç®—)
- `packageO` - å…¶ä»–é¡µé¢åŠŸèƒ½ (å·¥å…·é›†åˆ)
- `packagePerformance` - æ€§èƒ½å‚æ•°æ•°æ® (é£æœºæ€§èƒ½)
- `packageHealth` - èˆªåŒ»å¥åº·æ•°æ® (åŒ»å­¦æ ‡å‡†)
- `packageCCAR` - CAACè§„ç« æ•°æ® (æ³•è§„æ–‡ä»¶)

#### éŸ³é¢‘åˆ†åŒ…ï¼ˆæŒ‰å›½å®¶åœ°åŒºï¼‰

- `packageJapan` - æ—¥æœ¬æˆç”°æœºåœºå½•éŸ³ (24æ¡)
- `packagePhilippines` - è²å¾‹å®¾é©¬å°¼æ‹‰æœºåœºå½•éŸ³ (27æ¡)
- `packageKorean` - éŸ©å›½ä»å·æœºåœºå½•éŸ³ (19æ¡)
- `packageSingapore` - æ–°åŠ å¡æ¨Ÿå®œæœºåœºå½•éŸ³ (8æ¡)
- `packageThailand` - æ³°å›½æ›¼è°·æœºåœºå½•éŸ³ (22æ¡)
- `packageRussia` - ä¿„ç½—æ–¯è«æ–¯ç§‘æœºåœºå½•éŸ³ (23æ¡)
- `packageSrilanka` - æ–¯é‡Œå…°å¡ç§‘ä¼¦å¡æœºåœºå½•éŸ³ (22æ¡)
- `packageAustralia` - æ¾³å¤§åˆ©äºšæ‚‰å°¼æœºåœºå½•éŸ³ (20æ¡)
- `packageTurkey` - åœŸè€³å…¶ä¼Šæ–¯å¦å¸ƒå°”æœºåœºå½•éŸ³ (28æ¡)
- `packageFrance` - æ³•å›½æˆ´é«˜ä¹æœºåœºå½•éŸ³ (19æ¡)
- `packageAmerica` - ç¾å›½æ—§é‡‘å±±æœºåœºå½•éŸ³ (52æ¡)
- `packageItaly` - æ„å¤§åˆ©ç½—é©¬æœºåœºå½•éŸ³ (29æ¡)
- `packageUAE` - é˜¿è”é…‹è¿ªæ‹œæœºåœºå½•éŸ³ (37æ¡)

### ğŸš¨ è·¨åˆ†åŒ…æ¨¡å—å¼•ç”¨è§„èŒƒ

**è·¨åˆ†åŒ…æ¨¡å—å¼•ç”¨å¿…é¡»ä½¿ç”¨å¼‚æ­¥æ–¹å¼ï¼Œé¿å…ç”Ÿäº§ç¯å¢ƒåŠ è½½å¤±è´¥**

#### æ ¸å¿ƒè¦æ±‚

- âœ… **å¼‚æ­¥require**ï¼šè·¨åˆ†åŒ…å¼•ç”¨å¿…é¡»ä½¿ç”¨å›è°ƒå‡½æ•°
- âŒ **åŒæ­¥require**ï¼šç¦æ­¢ç›´æ¥åŒæ­¥å¼•ç”¨å…¶ä»–åˆ†åŒ…æ¨¡å—
- ğŸ”§ **ç”Ÿäº§å…¼å®¹**ï¼šç¡®ä¿ç”Ÿäº§ç¯å¢ƒä¸‹åˆ†åŒ…æ­£å¸¸åŠ è½½

#### æ­£ç¡®ç¤ºä¾‹

```javascript
// âœ… æ­£ç¡®ï¼šå¼‚æ­¥require with å›è°ƒ
require('../../packageA/data.js', function(data) {
  // æˆåŠŸåŠ è½½å¤„ç†
  console.log('æ•°æ®åŠ è½½æˆåŠŸ', data);
}, function(error) {
  // å¤±è´¥å¤„ç†
  console.error('æ•°æ®åŠ è½½å¤±è´¥', error);
});

// âŒ é”™è¯¯ï¼šåŒæ­¥require
var data = require('../../packageA/data.js'); // ç”Ÿäº§ç¯å¢ƒå¯èƒ½å¤±è´¥
```

#### æŠ€æœ¯åŸç†

å¾®ä¿¡å°ç¨‹åºç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œè·¨åˆ†åŒ…çš„åŒæ­¥ `require`å¯èƒ½å› åˆ†åŒ…æœªé¢„åŠ è½½è€Œå¤±è´¥ï¼Œå¿…é¡»ä½¿ç”¨å¼‚æ­¥æ–¹å¼ç¡®ä¿å…¼å®¹æ€§ã€‚

### ğŸµ éŸ³é¢‘é…ç½®æ¶æ„

éŸ³é¢‘ç³»ç»Ÿé‡‡ç”¨ä¸‰å±‚æ¶æ„ï¼š

1. **æ•°æ®å±‚**ï¼š`miniprogram/data/regions/*.js` - å„å›½å½•éŸ³æ•°æ®å’Œå…ƒä¿¡æ¯
2. **é…ç½®å±‚**ï¼š`miniprogram/utils/audio-config.js` - ç»Ÿä¸€é…ç½®ç®¡ç†å™¨
3. **åˆ†åŒ…å±‚**ï¼š`package*/` - éŸ³é¢‘èµ„æºåˆ†åŒ…å­˜å‚¨

## ğŸ“Š æ€§èƒ½ç›‘æ§

### å…³é”®æ€§èƒ½æŒ‡æ ‡

```bash
# é¡¹ç›®è§„æ¨¡æŒ‡æ ‡
ä¸»åŒ…å¤§å°: < 2MB (å½“å‰åˆè§„)
åˆ†åŒ…æ€»æ•°: 24ä¸ª (13ä¸ªéŸ³é¢‘åˆ†åŒ… + 11ä¸ªåŠŸèƒ½åˆ†åŒ…)
éŸ³é¢‘æ–‡ä»¶: 337ä¸ªçœŸå®æœºåœºå½•éŸ³
æ•°æ®è®°å½•: 30ä¸‡+æ¡ (ICAOã€æœºåœºã€ç¼©å†™ç­‰)

# æ€§èƒ½åŸºå‡†æŒ‡æ ‡
å¯åŠ¨æ—¶é—´: < 3ç§’ (ç¦»çº¿ç¯å¢ƒ)
åˆ†åŒ…åŠ è½½: < 2ç§’ (é¢„åŠ è½½)
æœç´¢å“åº”: < 500ms (æœ¬åœ°æ•°æ®)
éŸ³é¢‘æ’­æ”¾: < 1ç§’ (ç¼“å­˜å‘½ä¸­)
ç¦»çº¿åŠŸèƒ½è¦†ç›–ç‡: 100%
```

### æ€§èƒ½ç›‘æ§å·¥å…·

#### å†…ç½®è¯Šæ–­å·¥å…·
```javascript
// 1. åˆ†åŒ…çŠ¶æ€è¯Šæ–­
// è®¿é—®æµ‹è¯•é¡µé¢ï¼špages/test-subpackage/index
// å®æ—¶ç›‘æ§24ä¸ªåˆ†åŒ…çš„åŠ è½½çŠ¶æ€

// 2. åˆ†åŒ…è°ƒè¯•å·¥å…·
var debugTool = require('../../utils/subpackage-debug.js');
debugTool.checkAllSubpackages(); // æ£€æŸ¥æ‰€æœ‰åˆ†åŒ…çŠ¶æ€

// 3. éŸ³é¢‘ç³»ç»Ÿè¯Šæ–­
var audioConfig = require('../../utils/audio-config.js');
audioConfig.validateAllRegions(); // éªŒè¯éŸ³é¢‘é…ç½®å®Œæ•´æ€§
```

#### å¾®ä¿¡å¼€å‘è€…å·¥å…·ç›‘æ§
```bash
# æ€§èƒ½é¢æ¿ç›‘æ§æŒ‡æ ‡ï¼š
1. å†…å­˜ä½¿ç”¨æƒ…å†µ - å…³æ³¨åˆ†åŒ…åŠ è½½åçš„å†…å­˜å ç”¨
2. ç½‘ç»œè¯·æ±‚ - ç¡®ä¿ç¦»çº¿ç¯å¢ƒæ— ç½‘ç»œä¾èµ–
3. æ¸²æŸ“æ€§èƒ½ - å¤§æ•°æ®åˆ—è¡¨æ¸²æŸ“ä¼˜åŒ–
4. å­˜å‚¨ä½¿ç”¨ - æœ¬åœ°ç¼“å­˜å’Œæ•°æ®å­˜å‚¨ç›‘æ§
```

### æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

#### åˆ†åŒ…é¢„åŠ è½½ä¼˜åŒ–
```javascript
// æ™ºèƒ½é¢„åŠ è½½ç­–ç•¥
"preloadRule": {
  "pages/home/index": {
    "network": "all",
    "packages": ["packageKorean"] // å¸¸ç”¨éŸ³é¢‘åŒ…ä¼˜å…ˆ
  },
  "pages/search/index": {
    "network": "all", 
    "packages": ["packageA", "packageB"] // æŸ¥è¯¢åŠŸèƒ½ç›¸å…³æ•°æ®åŒ…
  }
}
```

#### æ•°æ®åŠ è½½ä¼˜åŒ–
```javascript
// ä½¿ç”¨DataLoaderçš„ç¼“å­˜æœºåˆ¶
dataLoader.loadWithLoading(this, loadFunction, {
  enableCache: true,
  cacheKey: 'performance_optimized_data',
  maxCacheAge: 24 * 60 * 60 * 1000 // 24å°æ—¶ç¼“å­˜
});
```

#### å†…å­˜ç®¡ç†ä¼˜åŒ–
```javascript
// BasePageè‡ªåŠ¨æ¸…ç†æœºåˆ¶
onUnload: function() {
  // è‡ªåŠ¨æ¸…ç†å®šæ—¶å™¨ã€éŸ³é¢‘æ’­æ”¾å™¨ç­‰èµ„æº
  this.cleanup(); // åŸºç±»è‡ªåŠ¨å¤„ç†
}
```

## ğŸ”§ å¼€å‘å‘½ä»¤

### å¾®ä¿¡å°ç¨‹åºå¼€å‘æµç¨‹

```bash
# 1. å®‰è£…ä¾èµ–
cd miniprogram && npm install

# 2. æ„å»ºnpmåŒ… (å¾®ä¿¡å¼€å‘è€…å·¥å…·)
# å·¥å…· -> æ„å»ºnpm -> ç¡®è®¤æ„å»º

# 3. ç¼–è¯‘æ„å»º
# å¾®ä¿¡å¼€å‘è€…å·¥å…· -> ç¼–è¯‘

# 4. çœŸæœºè°ƒè¯•
# å¾®ä¿¡å¼€å‘è€…å·¥å…· -> é¢„è§ˆ -> æ‰«ç çœŸæœºæµ‹è¯•

# 5. åˆ†åŒ…é¢„ä¸‹è½½æµ‹è¯• (é‡è¦)
# ç¡®ä¿æ‰€æœ‰åˆ†åŒ…åœ¨ç¦»çº¿çŠ¶æ€ä¸‹å¯æ­£å¸¸åŠ è½½
```

### å¿«é€Ÿå¼€å‘å‘½ä»¤

```bash
# å¿«é€Ÿè¯­æ³•æ£€æŸ¥æ‰€æœ‰JSæ–‡ä»¶
find miniprogram -name "*.js" -exec node -c {} \; 

# æ£€æŸ¥åˆ†åŒ…æ•°é‡æ˜¯å¦æ­£ç¡® (åº”è¯¥æ˜¾ç¤º24ä¸ªåˆ†åŒ…)
grep -c "\"root\":" miniprogram/app.json

# æ£€æŸ¥éŸ³é¢‘æ–‡ä»¶æ€»æ•° (åº”è¯¥æ˜¾ç¤º337æ¡å½•éŸ³)
find package* -name "*.mp3" 2>/dev/null | wc -l

# éªŒè¯é¡¹ç›®é…ç½®
cat project.config.json | grep '"es6"'
```

### å¸¸ç”¨å¼€å‘ä»»åŠ¡

#### æ·»åŠ æ–°é¡µé¢

```javascript
// 1. åœ¨app.jsonä¸­æ·»åŠ é¡µé¢è·¯å¾„
// 2. ä½¿ç”¨BasePageåŸºç±»åˆ›å»ºé¡µé¢
var BasePage = require('../../utils/base-page.js');

var pageConfig = {
  customOnLoad: function(options) {
    // é¡µé¢é€»è¾‘
  }
};

Page(BasePage.createPage(pageConfig));
```

#### æ·»åŠ æ–°åˆ†åŒ…

```javascript
// 1. åœ¨app.jsonçš„subPackagesä¸­æ·»åŠ é…ç½®
// 2. ä½¿ç”¨DataLoaderåŠ è½½åˆ†åŒ…æ•°æ®
var dataLoader = require('../../utils/data-loader.js');

dataLoader.loadSubpackageData(this, 'packageName', './data.js', {
  fallbackData: [],
  context: 'åˆ†åŒ…æè¿°'
});
```

#### é©¾é©¶èˆ±é…ç½®å¼€å‘

```javascript
// 1. ä¿®æ”¹é…ç½®å‚æ•°
// ç¼–è¾‘ pages/cockpit/modules/config.js
var config = {
  gps: {
    maxReasonableSpeed: 650,  // ä¿®æ”¹æœ€å¤§åˆç†é€Ÿåº¦
    // ... å…¶ä»–GPSé…ç½®
  },
  compass: {
    headingBufferSize: 20,    // ä¿®æ”¹èˆªå‘ç¼“å†²åŒºå¤§å°
    // ... å…¶ä»–æŒ‡å—é’ˆé…ç½®
  }
};

// 2. åœ¨é©¾é©¶èˆ±é¡µé¢ä¸­ä½¿ç”¨é…ç½®
var config = require('./modules/config.js');
var maxSpeed = config.gps.maxReasonableSpeed;

// 3. éªŒè¯é…ç½®å®Œæ•´æ€§
cd pages/cockpit && node -e "
const config = require('./modules/config.js');
console.log('GPSé…ç½®é¡¹æ•°é‡:', Object.keys(config.gps).length);
console.log('æŒ‡å—é’ˆé…ç½®é¡¹æ•°é‡:', Object.keys(config.compass).length);
console.log('åœ°å›¾é…ç½®é¡¹æ•°é‡:', Object.keys(config.map).length);
"
```

#### éŸ³é¢‘åˆ†åŒ…å¼€å‘

```javascript
// 1. åœ¨miniprogram/data/regions/åˆ›å»ºåœ°åŒºæ•°æ®æ–‡ä»¶
// 2. ä½¿ç”¨audio-config.jsç®¡ç†éŸ³é¢‘é…ç½®
var audioConfig = require('../../utils/audio-config.js');
var audioData = audioConfig.getRegionData('regionName');
```

### ä»£ç æ£€æŸ¥

```bash
# JavaScriptè¯­æ³•æ£€æŸ¥
node -c miniprogram/utils/[filename].js

# æ‰¹é‡è¯­æ³•éªŒè¯
find miniprogram/ -name "*.js" -exec node -c {} \;

# é©¾é©¶èˆ±é…ç½®æ¨¡å—è¯­æ³•æ£€æŸ¥
node -c miniprogram/pages/cockpit/modules/config.js

# é©¾é©¶èˆ±é…ç½®éªŒè¯
cd miniprogram/pages/cockpit && node -e "
const config = require('./modules/config.js');
console.log('âœ… é…ç½®åŠ è½½æˆåŠŸ');
console.log('GPSé…ç½®é¡¹:', Object.keys(config.gps).length);
console.log('æŒ‡å—é’ˆé…ç½®é¡¹:', Object.keys(config.compass).length);
console.log('åœ°å›¾é…ç½®é¡¹:', Object.keys(config.map).length);
"
```

## ğŸ“‹ å¼€å‘è§„èŒƒ2.0

### ä»£ç é£æ ¼æŒ‡å—

#### JavaScriptè§„èŒƒ
```javascript
// 1. å˜é‡å£°æ˜ï¼šä½¿ç”¨varå…³é”®å­— (ES5å…¼å®¹)
var userName = 'pilot';
var userAge = 30;
var isActive = true;

// 2. å‡½æ•°å®šä¹‰ï¼šä½¿ç”¨functionå…³é”®å­—
function calculateDistance(point1, point2) {
  var dx = point2.x - point1.x;
  var dy = point2.y - point1.y;
  return Math.sqrt(dx * dx + dy * dy);
}

// 3. å¯¹è±¡æ“ä½œï¼šä½¿ç”¨ä¼ ç»Ÿæ–¹å¼
var flightData = {
  callSign: 'CCA123',
  altitude: 35000,
  speed: 850
};

// å¯¹è±¡æ‰©å±•
var extendedData = {};
for (var key in flightData) {
  if (flightData.hasOwnProperty(key)) {
    extendedData[key] = flightData[key];
  }
}
extendedData.route = 'PEK-LAX';
```

#### å‘½åçº¦å®š
```javascript
// å˜é‡å’Œå‡½æ•°ï¼šé©¼å³°å¼å‘½å
var flightNumber = 'CA1234';
function getFlightInfo() { }

// å¸¸é‡ï¼šå¤§å†™ä¸‹åˆ’çº¿åˆ†å‰²
var MAX_ALTITUDE = 43000;
var AIRPORT_CODES = ['PEK', 'PVG', 'CAN'];

// ç»„ä»¶å’Œç±»ï¼šå¤§å†™å¼€å¤´
var BasePage = require('./base-page.js');
var SearchComponent = require('./search-component.js');

// ç§æœ‰æ–¹æ³•ï¼šä¸‹åˆ’çº¿å‰ç¼€  
function _validateInput(input) {
  return input && input.trim();
}
```

#### æ³¨é‡Šè§„èŒƒ
```javascript
/**
 * è®¡ç®—ä¸¤ç‚¹é—´çš„èˆªå‘è§’
 * @param {Object} from èµ·å§‹ç‚¹åæ ‡
 * @param {Object} to ç›®æ ‡ç‚¹åæ ‡
 * @returns {Number} èˆªå‘è§’ï¼ˆåº¦ï¼‰
 */
function calculateBearing(from, to) {
  // ä½¿ç”¨å…¬å¼è®¡ç®—èˆªå‘è§’
  var deltaLng = to.lng - from.lng;
  var y = Math.sin(deltaLng) * Math.cos(to.lat);
  var x = Math.cos(from.lat) * Math.sin(to.lat) - 
          Math.sin(from.lat) * Math.cos(to.lat) * Math.cos(deltaLng);
  
  return Math.atan2(y, x) * 180 / Math.PI;
}
```

### æäº¤è§„èŒƒ (Git Commit)

#### æäº¤æ ¼å¼
```bash
<type>(<scope>): <subject>

[body]

[footer]
```

#### æäº¤ç±»å‹ (type)
```bash
feat: æ–°åŠŸèƒ½ (feature)
fix: ä¿®å¤bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼ä¿®æ”¹ï¼ˆä¸å½±å“åŠŸèƒ½ï¼‰
refactor: ä»£ç é‡æ„
perf: æ€§èƒ½ä¼˜åŒ–
test: æµ‹è¯•ç›¸å…³
chore: æ„å»ºå·¥å…·ã€è¾…åŠ©å·¥å…·å˜åŠ¨
```

#### æäº¤ç¤ºä¾‹
```bash
# æ–°åŠŸèƒ½
feat(audio): æ–°å¢ä¿„ç½—æ–¯æœºåœºå½•éŸ³åˆ†åŒ…
- æ·»åŠ packageRussiaåˆ†åŒ…é…ç½®
- æ–°å¢23æ¡è«æ–¯ç§‘æœºåœºå½•éŸ³
- æ›´æ–°éŸ³é¢‘é…ç½®ç®¡ç†å™¨

# ä¿®å¤é—®é¢˜
fix(subpackage): ä¿®å¤è·¨åˆ†åŒ…requireè­¦å‘Š
- å°†åŒæ­¥requireæ”¹ä¸ºå¼‚æ­¥require
- æ·»åŠ é”™è¯¯å¤„ç†æœºåˆ¶
- æ›´æ–°23ä¸ªæ–‡ä»¶çš„å¼•ç”¨æ–¹å¼

# æ€§èƒ½ä¼˜åŒ–
perf(search): ä¼˜åŒ–ICAOä»£ç æœç´¢æ€§èƒ½
- æ·»åŠ æœç´¢ç´¢å¼•
- å®ç°ç»“æœç¼“å­˜
- æœç´¢å“åº”æ—¶é—´ä»1.2sä¼˜åŒ–åˆ°300ms
```

### æ–‡ä»¶ç»„ç»‡è§„èŒƒ

#### ç›®å½•ç»“æ„
```
miniprogram/
â”œâ”€â”€ pages/           # é¡µé¢æ–‡ä»¶
â”‚   â”œâ”€â”€ [é¡µé¢å]/
â”‚   â”‚   â”œâ”€â”€ index.js    # é¡µé¢é€»è¾‘ï¼ˆå¿…é¡»ä½¿ç”¨BasePageï¼‰
â”‚   â”‚   â”œâ”€â”€ index.wxml  # é¡µé¢ç»“æ„
â”‚   â”‚   â”œâ”€â”€ index.wxss  # é¡µé¢æ ·å¼
â”‚   â”‚   â””â”€â”€ index.json  # é¡µé¢é…ç½®
â”œâ”€â”€ utils/           # å·¥å…·ç»„ä»¶
â”‚   â”œâ”€â”€ base-page.js     # é¡µé¢åŸºç±»
â”‚   â”œâ”€â”€ search-component.js # æœç´¢ç»„ä»¶
â”‚   â””â”€â”€ audio-config.js  # éŸ³é¢‘é…ç½®
â”œâ”€â”€ data/            # æ•°æ®æ–‡ä»¶
â”‚   â””â”€â”€ regions/     # éŸ³é¢‘åŒºåŸŸæ•°æ®
â””â”€â”€ components/      # è‡ªå®šä¹‰ç»„ä»¶
```

#### åˆ†åŒ…ç»„ç»‡è§„èŒƒ
```
package[Name]/
â”œâ”€â”€ index.js         # åˆ†åŒ…å…¥å£é¡µé¢
â”œâ”€â”€ data.js         # åˆ†åŒ…æ•°æ®æ–‡ä»¶ (å¦‚æœæœ‰)
â”œâ”€â”€ audios/         # éŸ³é¢‘æ–‡ä»¶ç›®å½• (éŸ³é¢‘åˆ†åŒ…)
â”‚   â”œâ”€â”€ file1.mp3
â”‚   â””â”€â”€ file2.mp3
â””â”€â”€ utils/          # åˆ†åŒ…å·¥å…· (å¦‚æœéœ€è¦)
```

### ä»£ç è´¨é‡æ§åˆ¶

#### å¿…é¡»éµå¾ªçš„è§„åˆ™
```javascript
// 1. æ‰€æœ‰æ–°é¡µé¢å¿…é¡»ä½¿ç”¨BasePageåŸºç±»
var BasePage = require('../../utils/base-page.js');
Page(BasePage.createPage(pageConfig));

// 2. è·¨åˆ†åŒ…å¼•ç”¨å¿…é¡»ä½¿ç”¨å¼‚æ­¥æ–¹å¼
require('../../packageA/data.js', successCallback, errorCallback);

// 3. é”™è¯¯å¤„ç†å¿…é¡»ä½¿ç”¨ç»Ÿä¸€æœºåˆ¶
this.handleError(error, 'æ“ä½œä¸Šä¸‹æ–‡');

// 4. æ•°æ®åŠ è½½å¿…é¡»æœ‰loadingçŠ¶æ€
this.loadDataWithLoading(loadFunction, options);

// 5. æœç´¢åŠŸèƒ½å¿…é¡»ä½¿ç”¨SearchComponent
var searchComponent = SearchComponent.createSearchComponent();

// 6. é©¾é©¶èˆ±åŠŸèƒ½å¿…é¡»ä½¿ç”¨é…ç½®æ¨¡å—
var config = require('./modules/config.js');
var gpsSpeed = config.gps.maxReasonableSpeed;
```

#### ä»£ç å®¡æŸ¥æ¸…å•
```bash
âœ… æ˜¯å¦ä½¿ç”¨BasePageåŸºç±»ï¼Ÿ
âœ… æ˜¯å¦æ­£ç¡®å¤„ç†åˆ†åŒ…å¼‚æ­¥åŠ è½½ï¼Ÿ 
âœ… æ˜¯å¦éµå¾ªES5è¯­æ³•è§„èŒƒï¼Ÿ
âœ… æ˜¯å¦æ·»åŠ å¿…è¦çš„é”™è¯¯å¤„ç†ï¼Ÿ
âœ… æ˜¯å¦ä½¿ç”¨ç»Ÿä¸€çš„ç»„ä»¶å’Œå·¥å…·ï¼Ÿ
âœ… æ˜¯å¦åœ¨ç¦»çº¿æ¨¡å¼ä¸‹æ­£å¸¸å·¥ä½œï¼Ÿ
âœ… æ˜¯å¦æ·»åŠ äº†é€‚å½“çš„æ³¨é‡Šï¼Ÿ
âœ… æ˜¯å¦é€šè¿‡è¯­æ³•æ£€æŸ¥ (node -c)ï¼Ÿ
âœ… é©¾é©¶èˆ±æ¨¡å—æ˜¯å¦ä½¿ç”¨é…ç½®æ¨¡å—ï¼Ÿ
âœ… é…ç½®å‚æ•°æ˜¯å¦é¿å…ç¡¬ç¼–ç ï¼Ÿ
```

### æµ‹è¯•éªŒè¯æµç¨‹

#### å¼€å‘é˜¶æ®µæµ‹è¯•

```bash
# JavaScriptè¯­æ³•éªŒè¯
find miniprogram -name "*.js" -exec node -c {} \;

# æ£€æŸ¥éŸ³é¢‘æ–‡ä»¶è·¯å¾„
find package* -name "*.mp3" 2>/dev/null | wc -l  # åº”è¯¥æ˜¾ç¤º337æ¡å½•éŸ³

# éªŒè¯åˆ†åŒ…é…ç½®
grep -c "\"root\":" miniprogram/app.json  # åº”è¯¥æ˜¾ç¤º24ä¸ªåˆ†åŒ…

# æµ‹è¯•åˆ†åŒ…è°ƒè¯•å·¥å…·
node -c miniprogram/utils/subpackage-debug.js

# é©¾é©¶èˆ±é…ç½®æ¨¡å—æµ‹è¯•
node -c miniprogram/pages/cockpit/modules/config.js

# é©¾é©¶èˆ±é…ç½®å®Œæ•´æ€§éªŒè¯
cd miniprogram/pages/cockpit && node -e "
const config = require('./modules/config.js');
const gpsKeys = Object.keys(config.gps).length;
const compassKeys = Object.keys(config.compass).length;
const mapKeys = Object.keys(config.map).length;
console.log('âœ… é…ç½®éªŒè¯é€šè¿‡');
console.log('GPSé…ç½®é¡¹:', gpsKeys, '(é¢„æœŸ: 25)');
console.log('æŒ‡å—é’ˆé…ç½®é¡¹:', compassKeys, '(é¢„æœŸ: 11)');
console.log('åœ°å›¾é…ç½®é¡¹:', mapKeys, '(é¢„æœŸ: 12)');
"
```

#### å‘å¸ƒå‰æ£€æŸ¥æ¸…å• âœ…

1. **è¯­æ³•æ£€æŸ¥**ï¼š`find miniprogram -name "*.js" -exec node -c {} \;` éªŒè¯æ‰€æœ‰JSæ–‡ä»¶è¯­æ³•æ­£ç¡®
2. **å¾®ä¿¡å¼€å‘è€…å·¥å…·ç¼–è¯‘**ï¼šç¡®ä¿æ— ç¼–è¯‘é”™è¯¯å’Œè­¦å‘Š
3. **çœŸæœºé¢„è§ˆæµ‹è¯•**ï¼šé€šè¿‡å¾®ä¿¡å¼€å‘è€…å·¥å…·çœŸæœºé¢„è§ˆåŠŸèƒ½
4. **ç¦»çº¿åŠŸèƒ½æµ‹è¯•**ï¼šå¼€å¯é£è¡Œæ¨¡å¼éªŒè¯æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½
5. **åˆ†åŒ…éªŒè¯**ï¼šç¡®ä¿24ä¸ªåˆ†åŒ…å¼‚æ­¥åŠ è½½æ­£å¸¸
6. **éŸ³é¢‘æµ‹è¯•**ï¼šéªŒè¯337æ¡å½•éŸ³æ’­æ”¾åŠŸèƒ½
7. **ä»£ç ä½“ç§¯æ£€æŸ¥**ï¼šç¡®ä¿ä¸»åŒ…<2MBï¼Œå„åˆ†åŒ…<2MB
8. **BasePageé›†æˆæ£€æŸ¥**ï¼šç¡®ä¿æ‰€æœ‰é¡µé¢ä½¿ç”¨ç»Ÿä¸€åŸºç±»
9. **é©¾é©¶èˆ±é…ç½®æ£€æŸ¥**ï¼šéªŒè¯é…ç½®æ¨¡å—47ä¸ªå‚æ•°æ­£ç¡®åŠ è½½
10. **æ•°æ®å®Œæ•´æ€§æ£€æŸ¥**ï¼šéªŒè¯30ä¸‡ICAOä»£ç ã€2ä¸‡ç¼©å†™ç­‰æ•°æ®å®Œæ•´æ€§
11. **åˆ†åŒ…è°ƒè¯•æµ‹è¯•**ï¼šä½¿ç”¨ `pages/test-subpackage/index` éªŒè¯åˆ†åŒ…åŠ è½½æ­£å¸¸

## ğŸ“ é‡è¦æ–‡ä»¶è¯´æ˜

### æ ¸å¿ƒé…ç½®æ–‡ä»¶

- `project.config.json` - å°ç¨‹åºé¡¹ç›®é…ç½® (ES6: trueï¼Œä½†å®é™…å¼€å‘éœ€ä½¿ç”¨ES5)
- `miniprogram/app.json` - å°ç¨‹åºå…¨å±€é…ç½® (é¡µé¢ã€åˆ†åŒ…ã€é¢„åŠ è½½)

### é‡æ„åçš„æ ¸å¿ƒå·¥å…·æ–‡ä»¶

- `miniprogram/utils/base-page.js` - ç»Ÿä¸€é¡µé¢åŸºç±» (è§£å†³48ä¸ªæ–‡ä»¶çš„ä¸»é¢˜ç®¡ç†é‡å¤)
- `miniprogram/utils/data-loader.js` - ç»Ÿä¸€æ•°æ®åŠ è½½ç®¡ç†å™¨ (æ”¯æŒåˆ†åŒ…å¼‚æ­¥åŒ–)
- `miniprogram/utils/search-component.js` - ç»Ÿä¸€æœç´¢ç»„ä»¶ (è§£å†³6ä¸ªæ–‡ä»¶çš„æœç´¢é‡å¤)
- `miniprogram/utils/picker-component.js` - ç»Ÿä¸€é€‰æ‹©å™¨ç»„ä»¶ (è§£å†³14ä¸ªæ–‡ä»¶çš„é€‰æ‹©å™¨é‡å¤)
- `miniprogram/utils/error-handler.js` - æ‰©å±•é”™è¯¯å¤„ç†ç³»ç»Ÿ (è§£å†³74ä¸ªæ–‡ä»¶çš„é”™è¯¯å¤„ç†é‡å¤)
- `miniprogram/utils/subpackage-debug.js` - åˆ†åŒ…è°ƒè¯•å·¥å…· (è·¨åˆ†åŒ…requireä¿®å¤)

### é©¾é©¶èˆ±æ¨¡å—æ ¸å¿ƒæ–‡ä»¶

- `miniprogram/pages/cockpit/index.js` - é©¾é©¶èˆ±ä¸»é¡µé¢ (ä½¿ç”¨BasePageåŸºç±»ï¼Œé›†æˆé…ç½®æ¨¡å—)
- `miniprogram/pages/cockpit/modules/config.js` - é©¾é©¶èˆ±é…ç½®ç®¡ç†æ¨¡å— (æ–°å¢ï¼Œ47ä¸ªé…ç½®é¡¹)
  - GPSé…ç½®ï¼š25ä¸ªå‚æ•°ï¼ˆé€Ÿåº¦ã€é«˜åº¦ã€å¹²æ‰°æ£€æµ‹ã€çŠ¶æ€é˜ˆå€¼ç­‰ï¼‰
  - æŒ‡å—é’ˆé…ç½®ï¼š11ä¸ªå‚æ•°ï¼ˆå¹³æ»‘å¤„ç†ã€ç¨³å®šæ€§æ£€æŸ¥ã€èˆªå‘è®¡ç®—ç­‰ï¼‰
  - åœ°å›¾é…ç½®ï¼š12ä¸ªå‚æ•°ï¼ˆç¼©æ”¾çº§åˆ«ã€æ›´æ–°é—´éš”ã€ç»˜åˆ¶å‚æ•°ç­‰ï¼‰
  - ç¦»çº¿æ¨¡å¼é…ç½®ï¼šæ¨¡æ‹Ÿæ•°æ®é…ç½®
  - æ€§èƒ½ä¼˜åŒ–é…ç½®ï¼šCanvasåˆå§‹åŒ–ã€æ•°æ®æ›´æ–°èŠ‚æµç­‰

### éŸ³é¢‘ç³»ç»Ÿæ ¸å¿ƒæ–‡ä»¶

- `miniprogram/utils/audio-config.js` - éŸ³é¢‘é…ç½®ç®¡ç†å™¨ (æ”¯æŒ13ä¸ªå›½å®¶åœ°åŒº)
- `miniprogram/data/regions/*.js` - å„å›½å½•éŸ³æ•°æ®æ–‡ä»¶ (åŒ…å«å…ƒä¿¡æ¯å’Œæ–‡ä»¶è·¯å¾„)

## ğŸ”§ æ•…éšœæ’é™¤å¢å¼ºç‰ˆ

### ğŸ¤– è‡ªåŠ¨è¯Šæ–­å·¥å…·

#### åˆ†åŒ…çŠ¶æ€æ™ºèƒ½è¯Šæ–­
```javascript
// 1. ä½¿ç”¨å†…ç½®åˆ†åŒ…è¯Šæ–­å·¥å…·
// è®¿é—®æµ‹è¯•é¡µé¢ï¼špages/test-subpackage/index
// åŠŸèƒ½ï¼šå®æ—¶ç›‘æ§24ä¸ªåˆ†åŒ…çš„åŠ è½½çŠ¶æ€ï¼Œè‡ªåŠ¨æ£€æµ‹é—®é¢˜

// 2. å‘½ä»¤è¡Œå¿«é€Ÿè¯Šæ–­
var diagnoser = require('../../utils/subpackage-debug.js');
diagnoser.runFullDiagnosis().then(function(report) {
  console.log('è¯Šæ–­æŠ¥å‘Š:', report);
  // æŠ¥å‘ŠåŒ…å«ï¼šåŠ è½½çŠ¶æ€ã€é”™è¯¯è¯¦æƒ…ã€ä¿®å¤å»ºè®®
});
```

#### éŸ³é¢‘ç³»ç»Ÿè¯Šæ–­
```javascript
// éŸ³é¢‘é…ç½®å®Œæ•´æ€§æ£€æŸ¥
var audioConfig = require('../../utils/audio-config.js');
var report = audioConfig.diagnoseSystem();
console.log('éŸ³é¢‘ç³»ç»ŸçŠ¶æ€:', report);
/*
è¾“å‡ºç¤ºä¾‹ï¼š
{
  regions: 13,           // æ”¯æŒçš„å›½å®¶æ•°é‡
  totalAudios: 337,      // éŸ³é¢‘æ–‡ä»¶æ€»æ•°
  loadedPackages: 13,    // å·²åŠ è½½çš„éŸ³é¢‘åˆ†åŒ…
  brokenLinks: [],       // æŸåçš„éŸ³é¢‘é“¾æ¥
  status: 'healthy'      // ç³»ç»ŸçŠ¶æ€
}
*/
```

#### ç¦»çº¿åŠŸèƒ½éªŒè¯å·¥å…·
```bash
# ä¸€é”®ç¦»çº¿åŠŸèƒ½æµ‹è¯•è„šæœ¬
./scripts/offline-test.sh
# è‡ªåŠ¨æ‰§è¡Œï¼š
# 1. å¼€å¯é£è¡Œæ¨¡å¼æ¨¡æ‹Ÿ
# 2. æµ‹è¯•æ ¸å¿ƒåŠŸèƒ½è·¯å¾„
# 3. éªŒè¯æ•°æ®åŠ è½½
# 4. æ£€æŸ¥éŸ³é¢‘æ’­æ”¾
# 5. ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
```

### âš¡ å¿«é€Ÿä¿®å¤æŒ‡å—

#### åˆ†åŒ…åŠ è½½å¤±è´¥ â†’ 3æ­¥ä¿®å¤
```javascript
// æ­¥éª¤1ï¼šæ£€æŸ¥é¢„åŠ è½½è§„åˆ™
grep -A 5 -B 5 "preloadRule" miniprogram/app.json

// æ­¥éª¤2ï¼šéªŒè¯åˆ†åŒ…è·¯å¾„
find package* -name "index.js" | wc -l  // åº”è¯¥æ˜¾ç¤º24ä¸ª

// æ­¥éª¤3ï¼šä½¿ç”¨å¼‚æ­¥åŠ è½½
// âŒ é”™è¯¯æ–¹å¼
var data = require('../../packageA/data.js');

// âœ… æ­£ç¡®æ–¹å¼  
require('../../packageA/data.js', function(data) {
  // å¤„ç†æ•°æ®
}, function(error) {
  // é”™è¯¯å¤„ç†
});
```

#### éŸ³é¢‘æ’­æ”¾å¼‚å¸¸ â†’ 2æ­¥ä¿®å¤
```javascript
// æ­¥éª¤1ï¼šéªŒè¯éŸ³é¢‘æ–‡ä»¶è·¯å¾„
find package* -name "*.mp3" | head -5  // æ£€æŸ¥å‰5ä¸ªéŸ³é¢‘æ–‡ä»¶

// æ­¥éª¤2ï¼šæ£€æŸ¥éŸ³é¢‘é…ç½®
var audioConfig = require('../../utils/audio-config.js');
var regionData = audioConfig.getRegionData('japan');
console.log('æ—¥æœ¬éŸ³é¢‘é…ç½®:', regionData);
```

#### æ•°æ®åŠ è½½ç¼“æ…¢ â†’ å¯ç”¨ç¼“å­˜ç­–ç•¥
```javascript
// ä¸ºå¤§æ•°æ®åŠ è½½å¯ç”¨ç¼“å­˜
this.loadDataWithLoading(loadFunction, {
  enableCache: true,
  cacheKey: 'large_dataset_cache',
  maxCacheAge: 24 * 60 * 60 * 1000 // 24å°æ—¶ç¼“å­˜
});
```

#### å†…å­˜å ç”¨è¿‡é«˜ â†’ èµ„æºæ¸…ç†
```javascript
// ç¡®ä¿é¡µé¢ä½¿ç”¨BasePageåŸºç±»ï¼Œè‡ªåŠ¨æ¸…ç†èµ„æº
// BasePageä¼šåœ¨onUnloadæ—¶è‡ªåŠ¨ï¼š
// - æ¸…ç†å®šæ—¶å™¨
// - åœæ­¢éŸ³é¢‘æ’­æ”¾
// - æ¸…ç†äº‹ä»¶ç›‘å¬å™¨
// - é‡Šæ”¾å¤§å¯¹è±¡å¼•ç”¨
```

### ğŸš¨ ç´§æ€¥æ•…éšœå¤„ç†

#### ç”Ÿäº§ç¯å¢ƒåˆ†åŒ…åŠ è½½å¤±è´¥
```bash
# 1. ç«‹å³å›æ»šåˆ°ç¨³å®šç‰ˆæœ¬
git checkout last-stable-version

# 2. å¿«é€Ÿå®šä½é—®é¢˜
grep -r "require.*package" miniprogram/ | grep -v callback

# 3. æ‰¹é‡ä¿®å¤è·¨åˆ†åŒ…å¼•ç”¨
# ä½¿ç”¨é¡¹ç›®æä¾›çš„ä¿®å¤è„šæœ¬
./scripts/fix-subpackage-requires.sh
```

#### éŸ³é¢‘æ’­æ”¾å…¨é¢å¼‚å¸¸
```javascript
// 1. é‡ç½®éŸ³é¢‘é…ç½®
var audioConfig = require('../../utils/audio-config.js');
audioConfig.resetToDefaults();

// 2. æ¸…é™¤éŸ³é¢‘ç¼“å­˜
wx.removeStorage({
  key: 'audio_cache',
  success: function() {
    console.log('éŸ³é¢‘ç¼“å­˜å·²æ¸…é™¤');
  }
});

// 3. é‡æ–°åŠ è½½éŸ³é¢‘åˆ†åŒ…
audioConfig.preloadAllAudioPackages();
```

### ğŸ“Š æ•…éšœç»Ÿè®¡å’Œé¢„é˜²

#### å¸¸è§æ•…éšœæ’è¡Œ
```bash
1. è·¨åˆ†åŒ…requireè­¦å‘Š (å·²ä¿®å¤) - 23ä¸ªæ–‡ä»¶
2. éŸ³é¢‘è·¯å¾„é”™è¯¯ (å·²ä¼˜åŒ–) - 15ä¸ªæ–‡ä»¶  
3. å†…å­˜æ³„æ¼é—®é¢˜ (BasePageè§£å†³) - 48ä¸ªæ–‡ä»¶
4. æœç´¢æ€§èƒ½é—®é¢˜ (ç»„ä»¶åŒ–è§£å†³) - 6ä¸ªæ–‡ä»¶
5. é”™è¯¯å¤„ç†ä¸ç»Ÿä¸€ (åŸºç±»è§£å†³) - 74ä¸ªæ–‡ä»¶
```

#### é¢„é˜²æ€§ç›‘æ§
```javascript
// åœ¨é¡µé¢ä¸­æ·»åŠ æ€§èƒ½ç›‘æ§
customOnShow: function() {
  // ç›‘æ§é¡µé¢åŠ è½½æ—¶é—´
  var startTime = Date.now();
  this.loadData().then(function() {
    var loadTime = Date.now() - startTime;
    if (loadTime > 3000) {
      console.warn('é¡µé¢åŠ è½½æ—¶é—´è¿‡é•¿:', loadTime + 'ms');
    }
  });
}
```

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **åˆ†åŒ…é¢„åŠ è½½**ï¼šåˆ©ç”¨ `preloadRule` é…ç½®å…³é”®åˆ†åŒ…é¢„åŠ è½½
2. **æ•°æ®ç¼“å­˜**ï¼šä½¿ç”¨ `DataLoader` çš„ç¼“å­˜æœºåˆ¶é¿å…é‡å¤åŠ è½½
3. **éŸ³é¢‘é¢„åŠ è½½**ï¼šä½¿ç”¨ `AudioPackageLoader` é¢„åŠ è½½éŸ³é¢‘æ–‡ä»¶
4. **é”™è¯¯å¤„ç†**ï¼šä½¿ç”¨ç»Ÿä¸€çš„ `ErrorHandler` å’Œ `BasePage.handleError()`

## ğŸ“º å¹¿å‘Šç®¡ç†ç³»ç»Ÿ

### ğŸ¯ å¹¿å‘Šæ•´åˆåŸåˆ™

1. **ç®€çº¦è®¾è®¡**ï¼šä½¿ç”¨åŸºç¡€å¹¿å‘Šç»„ä»¶ï¼Œé¿å…å¤æ‚è‡ªå®šä¹‰æ ·å¼
2. **è§„èŒƒä½¿ç”¨**ï¼šä¸¥æ ¼æŒ‰ç…§æŒ‡å®šçš„å¹¿å‘Šä½IDä½¿ç”¨ï¼Œç¦æ­¢æ··ç”¨å…¶ä»–å¹¿å‘Šä½ID
3. **æ€§èƒ½ä¼˜å…ˆ**ï¼šç¡®ä¿å¹¿å‘Šä¸å½±å“æ ¸å¿ƒé£è¡ŒåŠŸèƒ½çš„æ€§èƒ½
4. **åŸºç¡€é›†æˆ**ï¼šä½¿ç”¨å°ç¨‹åºåŸç”Ÿå¹¿å‘ŠAPIï¼Œæ— éœ€é¢å¤–å°è£…
5. **å¹¿å‘Šé€‰æ‹©**ï¼šæ­£å¸¸æƒ…å†µä¸‹ä¼˜å…ˆä½¿ç”¨æ¨ªå¹…å¹¿å‘Šï¼Œä»…åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ä½¿ç”¨æ ¼å­å¹¿å‘Š

### ğŸï¸ æ¨ªå¹…å¹¿å‘Š

#### ä½¿ç”¨ç¤ºä¾‹
```javascript
// wxmlæ–‡ä»¶
<ad-custom unit-id="adunit-4e68875624a88762" bindload="adLoad" binderror="adError" bindclose="adClose"></ad-custom>

// jsæ–‡ä»¶ - åŸºç¡€äº‹ä»¶ç›‘å¬ï¼ˆæ— éœ€AdManagerï¼‰
Page({
  adLoad() {
    console.log('æ¨ªå¹…å¹¿å‘ŠåŠ è½½æˆåŠŸ');
  },
  adError(err) {
    console.error('æ¨ªå¹…å¹¿å‘ŠåŠ è½½å¤±è´¥', err);
  },
  adClose() {
    console.log('æ¨ªå¹…å¹¿å‘Šå…³é—­');
  }
});
```

#### å¯ç”¨æ¨ªå¹…å¹¿å‘Šä½ID
```
adunit-4e68875624a88762    // é€šç”¨æ¨ªå¹…å¹¿å‘Šä½
adunit-3b2e78fbdab16389    // é€šç”¨æ¨ªå¹…å¹¿å‘Šä½
adunit-2f5afef0d27dc863    // é€šç”¨æ¨ªå¹…å¹¿å‘Šä½
adunit-d6c8a55bd3cb4fd1    // é€šç”¨æ¨ªå¹…å¹¿å‘Šä½
adunit-d7a3b71f5ce0afca    // é€šç”¨æ¨ªå¹…å¹¿å‘Šä½
adunit-3a1bf3800fa937a2    // é€šç”¨æ¨ªå¹…å¹¿å‘Šä½
```

**æ³¨æ„è¦ç‚¹**ï¼šæ¨ªå¹…å¹¿å‘Šå¯è·¨é¡µé¢ä½¿ç”¨åŒä¸€ä¸ªå¹¿å‘Šä½ID

### ğŸ“± æ ¼å­å¹¿å‘Šï¼ˆåŸç”Ÿæ¨¡æ¿å¹¿å‘Šï¼‰

#### ä½¿ç”¨åœºæ™¯
âš ï¸ **ä»…åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ä½¿ç”¨**ï¼š
- å½“ä¸€ä¸ªé¡µé¢ä¸Šè¿ç»­è¿‡å¤šæ¨ªå¹…å¹¿å‘Šæ—¶ä½¿ç”¨æ ¼å­å¹¿å‘Šæ›¿æ¢
- é¿å…å¹¿å‘Šä¸éŸ³é¢‘æ’­æ”¾ç­‰åŠŸèƒ½å†²çª
- æ­£å¸¸æƒ…å†µä¸‹åº”ä¼˜å…ˆä½¿ç”¨æ¨ªå¹…å¹¿å‘Š

#### ä½¿ç”¨ç¤ºä¾‹
```javascript
// wxmlæ–‡ä»¶
<ad-custom unit-id="adunit-735d7d24032d4ca8" bindload="adLoad" binderror="adError" bindclose="adClose"></ad-custom>

// jsæ–‡ä»¶ - åŸç”Ÿæ¨¡æ¿å¹¿å‘Šäº‹ä»¶ç›‘å¬
Page({
  adLoad() {
    console.log('åŸç”Ÿæ¨¡æ¿å¹¿å‘ŠåŠ è½½æˆåŠŸ');
  },
  adError(err) {
    console.error('åŸç”Ÿæ¨¡æ¿å¹¿å‘ŠåŠ è½½å¤±è´¥', err);
  },
  adClose() {
    console.log('åŸç”Ÿæ¨¡æ¿å¹¿å‘Šå…³é—­');
  }
});
```

#### æ ¼å­å¹¿å‘Šä½ID
```
adunit-735d7d24032d4ca8    // ç»Ÿä¸€æ ¼å­å¹¿å‘Šä½ID
```

#### æ ¼å­å¹¿å‘Šæ³¨æ„è¦ç‚¹
- **ç‰¹æ®Šæƒ…å†µä½¿ç”¨**ï¼šä»…åœ¨é¡µé¢æ¨ªå¹…å¹¿å‘Šè¿‡å¤šå¯¼è‡´å†²çªæ—¶ä½¿ç”¨
- **ç»Ÿä¸€å¹¿å‘Šä½**ï¼šæ‰€æœ‰æ ¼å­å¹¿å‘Šä½¿ç”¨åŒä¸€ä¸ªå¹¿å‘Šä½ID
- **å…¼å®¹æ€§æ›´å¥½**ï¼šæ ¼å­å¹¿å‘Šå½¢å¼æ›´çµæ´»ï¼Œé¿å…ä¸éŸ³é¢‘ç­‰åŠŸèƒ½å†²çª
- **åº”ç”¨å®ä¾‹**ï¼šèˆªçº¿å½•éŸ³é¡µé¢å› åŒ…å«éŸ³é¢‘æ’­æ”¾åŠŸèƒ½ä¸”æœ‰7ä¸ªå¹¿å‘Šä½ï¼Œä½¿ç”¨æ ¼å­å¹¿å‘Š

### ğŸ¬ æ¿€åŠ±è§†é¢‘å¹¿å‘Š

#### ä½¿ç”¨ç¤ºä¾‹
```javascript
// è‹¥åœ¨å¼€å‘è€…å·¥å…·ä¸­æ— æ³•é¢„è§ˆå¹¿å‘Šï¼Œè¯·åˆ‡æ¢å¼€å‘è€…å·¥å…·ä¸­çš„åŸºç¡€åº“ç‰ˆæœ¬
var BasePage = require('../../utils/base-page.js');

var pageConfig = {
  data: {
    videoAd: null
  },

  customOnLoad: function() {
    // åœ¨é¡µé¢åŠ è½½æ—¶åˆ›å»ºæ¿€åŠ±è§†é¢‘å¹¿å‘Šå®ä¾‹
    var self = this;
    if (wx.createRewardedVideoAd) {
      this.data.videoAd = wx.createRewardedVideoAd({
        adUnitId: 'adunit-316c5630d7a1f9ef'
      });
      
      this.data.videoAd.onLoad(function() {
        console.log('æ¿€åŠ±è§†é¢‘å¹¿å‘ŠåŠ è½½æˆåŠŸ');
      });
      
      this.data.videoAd.onError(function(err) {
        console.error('æ¿€åŠ±è§†é¢‘å¹¿å‘ŠåŠ è½½å¤±è´¥', err);
      });
      
      this.data.videoAd.onClose(function(res) {
        // ç”¨æˆ·ç‚¹å‡»äº†ã€å…³é—­å¹¿å‘Šã€‘æŒ‰é’®
        if (res && res.isEnded) {
          // æ­£å¸¸æ’­æ”¾ç»“æŸï¼Œå¯ä»¥ç»™äºˆå¥–åŠ±
          console.log('å¹¿å‘Šæ’­æ”¾å®Œæˆï¼Œè·å¾—å¥–åŠ±');
          self.giveReward();
        } else {
          // æ’­æ”¾ä¸­é€”é€€å‡ºï¼Œä¸äºˆå¥–åŠ±
          console.log('å¹¿å‘Šæ’­æ”¾æœªå®Œæˆï¼Œä¸ç»™äºˆå¥–åŠ±');
        }
      });
    }
  },

  // æ˜¾ç¤ºæ¿€åŠ±è§†é¢‘å¹¿å‘Š
  showRewardedAd: function() {
    var self = this;
    if (this.data.videoAd) {
      this.data.videoAd.show().catch(function() {
        // å¤±è´¥é‡è¯•
        self.data.videoAd.load()
          .then(function() {
            return self.data.videoAd.show();
          })
          .catch(function(err) {
            console.error('æ¿€åŠ±è§†é¢‘å¹¿å‘Šæ˜¾ç¤ºå¤±è´¥', err);
          });
      });
    }
  },

  // ç»™äºˆå¥–åŠ±
  giveReward: function() {
    // è¿™é‡Œå®ç°å…·ä½“çš„å¥–åŠ±é€»è¾‘
    console.log('âœ… è·å¾—ç§¯åˆ†å¥–åŠ±');
    // æ·»åŠ ç§¯åˆ†é€»è¾‘
    this.addPoints(10);
  }
};

Page(BasePage.createPage(pageConfig));
```

#### æ¿€åŠ±å¹¿å‘Šä½ID
```
adunit-316c5630d7a1f9ef  // ç»Ÿä¸€æ¿€åŠ±å¹¿å‘Šä½ID
```

#### æ¿€åŠ±å¹¿å‘Šæ³¨æ„è¦ç‚¹

- **ç»Ÿä¸€å¹¿å‘Šä½**ï¼šæ¿€åŠ±å¹¿å‘Šåªæœ‰ä¸€ä¸ªå¹¿å‘Šä½IDï¼Œç¦æ­¢å¢åŠ æˆ–ä¿®æ”¹
- **ä¸å¯å˜æ›´**ï¼šä¸è¦å¢åŠ ï¼Œä¹Ÿä¸è¦æ”¹å˜ç›¸å…³ä»£ç 
- **å¥–åŠ±æœºåˆ¶**ï¼šåªæœ‰å®Œæ•´è§‚çœ‹å¹¿å‘Šæ‰èƒ½è·å¾—å¥–åŠ±
- **é”™è¯¯å¤„ç†**ï¼šå¿…é¡»æ·»åŠ å¤±è´¥é‡è¯•æœºåˆ¶
- **åŸºç¡€åº“ç‰ˆæœ¬**ï¼šåœ¨å¼€å‘è€…å·¥å…·ä¸­å¯èƒ½éœ€è¦åˆ‡æ¢åŸºç¡€åº“ç‰ˆæœ¬è¿›è¡Œæµ‹è¯•

### ğŸ“‹ å¹¿å‘Šé›†æˆæ¸…å•

å¼€å‘æ—¶å¿…é¡»éµå¾ªçš„å¹¿å‘Šé›†æˆè§„èŒƒï¼š

```bash
âœ… æ˜¯å¦ä½¿ç”¨äº†æ­£ç¡®çš„å¹¿å‘Šä½IDï¼Ÿ
âœ… æ¨ªå¹…å¹¿å‘Šæ˜¯å¦é€‰æ‹©äº†åˆé€‚çš„å¹¿å‘Šä½IDï¼Ÿ
âœ… æ ¼å­å¹¿å‘Šæ˜¯å¦ä»…åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ä½¿ç”¨ï¼Ÿ
âœ… æ ¼å­å¹¿å‘Šæ˜¯å¦ä½¿ç”¨ç»Ÿä¸€çš„å¹¿å‘Šä½IDï¼Ÿ
âœ… æ¿€åŠ±å¹¿å‘Šæ˜¯å¦ä½¿ç”¨ç»Ÿä¸€çš„å¹¿å‘Šä½IDï¼Ÿ
âœ… æ¿€åŠ±å¹¿å‘Šæ˜¯å¦æ·»åŠ äº†å¤±è´¥é‡è¯•æœºåˆ¶ï¼Ÿ
âœ… æ¿€åŠ±å¹¿å‘Šæ˜¯å¦æ­£ç¡®åˆ¤æ–­å¥–åŠ±æ¡ä»¶ï¼Ÿ
âœ… æ˜¯å¦æ·»åŠ äº†é€‚å½“çš„å¹¿å‘Šäº‹ä»¶å¤„ç†ï¼Ÿ
âœ… æ˜¯å¦æµ‹è¯•äº†å¹¿å‘Šåœ¨ç¦»çº¿æ¨¡å¼ä¸‹çš„è¡Œä¸ºï¼Ÿ
âœ… æ˜¯å¦ç¡®ä¿å¹¿å‘Šä¸å½±å“æ ¸å¿ƒé£è¡ŒåŠŸèƒ½ï¼Ÿ
âœ… æ˜¯å¦é¿å…äº†å¹¿å‘Šä¸éŸ³é¢‘æ’­æ”¾ç­‰åŠŸèƒ½å†²çªï¼Ÿ
```

### ğŸš¨ å¹¿å‘Šä½IDä¸¥æ ¼è¦æ±‚

**ç¦æ­¢ä½¿ç”¨çš„æ“ä½œ**ï¼š
- âŒ è‡ªå®šä¹‰å¤æ‚çš„å¹¿å‘Šæ ·å¼
- âŒ ä½¿ç”¨æ–‡æ¡£å¤–çš„å¹¿å‘Šä½ID
- âŒ å¢åŠ æˆ–ä¿®æ”¹æ¿€åŠ±å¹¿å‘Šä½ID
- âŒ æ”¹å˜æ¿€åŠ±å¹¿å‘Šç›¸å…³ä»£ç 
- âŒ åœ¨ä¸å¿…è¦çš„æƒ…å†µä¸‹ä½¿ç”¨æ ¼å­å¹¿å‘Š

**å¿…é¡»éµå¾ªçš„è§„åˆ™**ï¼š
- âœ… ä¸¥æ ¼æŒ‰ç…§æŒ‡å®šçš„å¹¿å‘Šä½IDä½¿ç”¨
- âœ… æ¨ªå¹…å¹¿å‘Šå¯è·¨é¡µé¢ä½¿ç”¨åŒä¸€ä¸ªå¹¿å‘Šä½ID
- âœ… æ ¼å­å¹¿å‘Šä»…åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ä½¿ç”¨ (adunit-735d7d24032d4ca8)
- âœ… æ ¼å­å¹¿å‘Šç”¨äºé¿å…ä¸éŸ³é¢‘æ’­æ”¾ç­‰åŠŸèƒ½å†²çª
- âœ… æ¿€åŠ±å¹¿å‘Šä½¿ç”¨ç»Ÿä¸€å¹¿å‘Šä½ID (adunit-316c5630d7a1f9ef)
- âœ… æ¿€åŠ±å¹¿å‘Šå¿…é¡»æ·»åŠ å¤±è´¥é‡è¯•æœºåˆ¶
- âœ… æ¿€åŠ±å¹¿å‘Šå¿…é¡»æ­£ç¡®åˆ¤æ–­å¥–åŠ±æ¡ä»¶
- âœ… ä½¿ç”¨å°ç¨‹åºåŸç”Ÿå¹¿å‘ŠAPIï¼Œæ— éœ€é¢å¤–å°è£…
- âœ… åœ¨ç¦»çº¿æ¨¡å¼ä¸‹ç¡®ä¿å¹¿å‘Šé”™è¯¯ä¸å½±å“åŠŸèƒ½

## ğŸ“š å‚è€ƒæ–‡æ¡£

### é‡æ„æ¶æ„ç›¸å…³

- é‡æ„åçš„å·¥å…·ç»„ä»¶ä½¿ç”¨æŒ‡å—: `miniprogram/utils/README.md`
  - åŒ…å«BasePageã€SearchComponentã€PickerComponentç­‰å®Œæ•´ä½¿ç”¨è¯´æ˜
  - è¯¦ç»†çš„ES5è¯­æ³•å…¼å®¹æ€§æŒ‡å—
  - ç¦»çº¿ä¼˜å…ˆè®¾è®¡åŸåˆ™

### éŸ³é¢‘é…ç½®æ¶æ„ç›¸å…³

- éŸ³é¢‘åˆ†åŒ…é…ç½®å’Œç®¡ç†: `docs/audio-config-architecture.md`
- éŸ³é¢‘åˆ†åŒ…ä¼˜åŒ–ç­–ç•¥: `docs/audio-subpackage-optimization.md`

### å¹¿å‘Šç®¡ç†ç›¸å…³

- å¹¿å‘Šç³»ç»Ÿä½¿ç”¨æŒ‡å—: `docs/å¹¿å‘Š.md`
  - å®Œæ•´çš„å¹¿å‘Šä½IDåˆ—è¡¨å’Œä½¿ç”¨è§„èŒƒ
  - æ¨ªå¹…å¹¿å‘Šã€æ ¼å­å¹¿å‘Šã€æ’å±å¹¿å‘Šçš„å…·ä½“å®ç°
  - å¹¿å‘Šé”™è¯¯å¤„ç†å’Œæ€§èƒ½ä¼˜åŒ–å»ºè®®

### è¯­æ³•é”™è¯¯ä¿®å¤ç›¸å…³

- å¾®ä¿¡å°ç¨‹åºè¯­æ³•éªŒè¯ä¸é”™è¯¯ä¿®å¤: `docs/miniprogram-syntax-validation.md`
  - é€‚ç”¨äºè§£å†³"Unexpected token: punc (.)"ç­‰è¯­æ³•é”™è¯¯
  - åŒ…å«ES6+è¯­æ³•å…¼å®¹æ€§å¤„ç†æ–¹æ¡ˆ
  - æä¾›ç³»ç»Ÿæ€§çš„ä¿®å¤æµç¨‹å’Œé¢„é˜²æªæ–½

### åˆ†åŒ…è°ƒè¯•ä¸ä¿®å¤ç›¸å…³

- åˆ†åŒ…è·¨åŒ…requireä¿®å¤è¯´æ˜: `åˆ†åŒ…è·¨åŒ…requireä¿®å¤è¯´æ˜.md`
  - è§£å†³è·¨åˆ†åŒ…requireè­¦å‘Šé—®é¢˜
  - æä¾›å¼‚æ­¥requireä¿®å¤æ–¹æ¡ˆ
  - åŒ…å«æµ‹è¯•éªŒè¯æ–¹æ³•å’ŒæŠ€æœ¯ç»†èŠ‚

## ğŸ“Š é¡¹ç›®ç»Ÿè®¡

### ä»£ç è§„æ¨¡

- æ€»éŸ³é¢‘æ•°é‡: **337æ¡** çœŸå®æœºåœºå½•éŸ³
- è¦†ç›–å›½å®¶: **13ä¸ª** ä¸»è¦èˆªç©ºå›½å®¶
- åˆ†åŒ…æ•°é‡: **24ä¸ª** åŠŸèƒ½å’ŒéŸ³é¢‘åˆ†åŒ…
- æ ¸å¿ƒé¡µé¢: **27ä¸ª** ä¸»è¦åŠŸèƒ½é¡µé¢
- å·¥å…·ç»„ä»¶: **25ä¸ª** é‡æ„åçš„ç»Ÿä¸€ç»„ä»¶

### æ•°æ®è§„æ¨¡

- ICAOä»£ç : **30ä¸‡æ¡** å…¨çƒæœºåœºä»£ç 
- ç¼©å†™è¯å…¸: **2ä¸‡æ¡** èˆªç©ºç¼©å†™
- æœºåœºæ•°æ®: **5åƒæ¡** æœºåœºä¿¡æ¯
- å®šä¹‰è¯å…¸: **3åƒæ¡** ä¸“ä¸šæœ¯è¯­

## ğŸ› ï¸ å¼€å‘å·¥å…·é›†æˆ

### VS Code æ¨èé…ç½®

#### æ¨èæ‰©å±•æ’ä»¶
```json
{
  "recommendations": [
    "ms-vscode.vscode-typescript-next",
    "formulahendry.auto-rename-tag", 
    "bradlc.vscode-tailwindcss",
    "ms-vscode.vscode-json",
    "yzhang.markdown-all-in-one",
    "shd101wyy.markdown-preview-enhanced"
  ]
}
```

#### å·¥ä½œåŒºé…ç½® (.vscode/settings.json)
```json
{
  "files.associations": {
    "*.wxml": "html",
    "*.wxss": "css",
    "*.wxs": "javascript"
  },
  "emmet.includeLanguages": {
    "wxml": "html"
  },
  "search.exclude": {
    "**/node_modules": true,
    "**/miniprogram_npm": true,
    "**/*.mp3": true
  },
  "files.exclude": {
    "**/miniprogram_npm": true
  },
  "typescript.preferences.includePackageJsonAutoImports": "off"
}
```

#### ä»£ç ç‰‡æ®µ (.vscode/snippets/javascript.json)
```json
{
  "FlightToolbox BasePage": {
    "prefix": "ftpage",
    "body": [
      "var BasePage = require('../../utils/base-page.js');",
      "",
      "var pageConfig = {",
      "  data: {",
      "    $1",
      "  },",
      "  ",
      "  customOnLoad: function(options) {",
      "    console.log('é¡µé¢åŠ è½½:', options);",
      "    $2",
      "  }",
      "};",
      "",
      "Page(BasePage.createPage(pageConfig));"
    ],
    "description": "åˆ›å»ºFlightToolboxé¡µé¢æ¨¡æ¿"
  },
  
  "FlightToolbox Subpackage Load": {
    "prefix": "ftload",
    "body": [
      "this.loadSubpackageData('$1', '../../$1/data.js', {",
      "  context: '$2',",
      "  fallbackData: []",
      "});"
    ],
    "description": "åˆ†åŒ…æ•°æ®åŠ è½½æ¨¡æ¿"
  }
}
```

### è°ƒè¯•æŠ€å·§

#### å¾®ä¿¡å¼€å‘è€…å·¥å…·è°ƒè¯•
```javascript
// 1. æ§åˆ¶å°è°ƒè¯•åˆ†åŒ…çŠ¶æ€
console.log('å½“å‰é¡µé¢:', getCurrentPages());
console.log('åˆ†åŒ…ä¿¡æ¯:', wx.getSystemInfoSync());

// 2. æ€§èƒ½ç›‘æ§
var startTime = Date.now();
// ... æ‰§è¡Œæ“ä½œ
console.log('æ“ä½œè€—æ—¶:', Date.now() - startTime + 'ms');

// 3. éŸ³é¢‘è°ƒè¯•
wx.getBackgroundAudioManager().onError(function(error) {
  console.error('éŸ³é¢‘æ’­æ”¾é”™è¯¯:', error);
});
```

#### åˆ†åŒ…åŠ è½½è°ƒè¯•
```javascript
// ä½¿ç”¨é¡¹ç›®å†…ç½®çš„è°ƒè¯•å·¥å…·
var debugTool = require('../../utils/subpackage-debug.js');

// æ£€æŸ¥å•ä¸ªåˆ†åŒ…
debugTool.checkSubpackage('packageA').then(function(result) {
  console.log('packageAçŠ¶æ€:', result);
});

// æ£€æŸ¥æ‰€æœ‰åˆ†åŒ…
debugTool.checkAllSubpackages().then(function(report) {
  console.table(report); // è¡¨æ ¼å½¢å¼æ˜¾ç¤ºæ‰€æœ‰åˆ†åŒ…çŠ¶æ€
});
```

#### ç¦»çº¿åŠŸèƒ½è°ƒè¯•
```javascript
// æ¨¡æ‹Ÿç¦»çº¿ç¯å¢ƒ
wx.onNetworkStatusChange(function(res) {
  if (!res.isConnected) {
    console.log('ğŸ“± è¿›å…¥ç¦»çº¿æ¨¡å¼ï¼Œå¼€å§‹ç¦»çº¿åŠŸèƒ½æµ‹è¯•');
    // æµ‹è¯•æ ¸å¿ƒåŠŸèƒ½
    testOfflineFeatures();
  }
});

function testOfflineFeatures() {
  // æµ‹è¯•æ•°æ®åŠ è½½
  dataLoader.loadSubpackageData(this, 'packageA', './data.js', {
    context: 'ç¦»çº¿æµ‹è¯•',
    fallbackData: []
  });
  
  // æµ‹è¯•éŸ³é¢‘æ’­æ”¾
  var audioConfig = require('../../utils/audio-config.js');
  audioConfig.testOfflineAudio('japan');
}
```

### å‘½ä»¤è¡Œå·¥å…·

#### å¿«é€Ÿè¯Šæ–­è„šæœ¬
```bash
#!/bin/bash
# flight-toolbox-diagnose.sh

echo "ğŸ” FlightToolbox é¡¹ç›®è¯Šæ–­å¼€å§‹..."

# 1. æ£€æŸ¥è¯­æ³•
echo "ğŸ“ æ£€æŸ¥JavaScriptè¯­æ³•..."
find miniprogram -name "*.js" -exec node -c {} \; && echo "âœ… è¯­æ³•æ£€æŸ¥é€šè¿‡"

# 2. æ£€æŸ¥åˆ†åŒ…æ•°é‡
SUBPACKAGE_COUNT=$(grep -c "\"root\":" miniprogram/app.json)
echo "ğŸ“¦ åˆ†åŒ…æ•°é‡: $SUBPACKAGE_COUNT (é¢„æœŸ: 24)"

# 3. æ£€æŸ¥éŸ³é¢‘æ–‡ä»¶
AUDIO_COUNT=$(find package* -name "*.mp3" 2>/dev/null | wc -l)
echo "ğŸµ éŸ³é¢‘æ–‡ä»¶: $AUDIO_COUNT (é¢„æœŸ: 337)"

# 4. æ£€æŸ¥é¡¹ç›®é…ç½®
ES6_ENABLED=$(grep '"es6": true' project.config.json)
if [ -n "$ES6_ENABLED" ]; then
  echo "âœ… ES6è½¬æ¢å·²å¯ç”¨"
else
  echo "âŒ ES6è½¬æ¢æœªå¯ç”¨"
fi

echo "ğŸ‰ è¯Šæ–­å®Œæˆï¼"
```

#### æ€§èƒ½ç›‘æ§è„šæœ¬
```bash
#!/bin/bash
# performance-monitor.sh

echo "ğŸ“Š æ€§èƒ½ç›‘æ§å¼€å§‹..."

# æ£€æŸ¥åŒ…å¤§å°
echo "ğŸ“¦ ä¸»åŒ…å¤§å°:"
du -sh miniprogram/ 2>/dev/null

echo "ğŸ“¦ å„åˆ†åŒ…å¤§å°:"
for package in package*; do
  if [ -d "$package" ]; then
    size=$(du -sh "$package" 2>/dev/null | cut -f1)
    echo "  $package: $size"
  fi
done

# æ£€æŸ¥éŸ³é¢‘æ–‡ä»¶æ€»å¤§å°
echo "ğŸµ éŸ³é¢‘æ–‡ä»¶æ€»å¤§å°:"
find package* -name "*.mp3" -exec du -ch {} + 2>/dev/null | tail -1
```

### Git Hooks é…ç½®

#### æäº¤å‰æ£€æŸ¥ (.git/hooks/pre-commit)
```bash
#!/bin/sh
# FlightToolbox pre-commit hook

echo "ğŸ” æ‰§è¡Œæäº¤å‰æ£€æŸ¥..."

# æ£€æŸ¥JavaScriptè¯­æ³•
echo "ğŸ“ æ£€æŸ¥è¯­æ³•..."
git diff --cached --name-only --diff-filter=ACM | grep '\.js$' | while read file; do
  if [ -f "$file" ]; then
    node -c "$file" || {
      echo "âŒ è¯­æ³•é”™è¯¯: $file"
      exit 1
    }
  fi
done

# æ£€æŸ¥æ˜¯å¦ä½¿ç”¨BasePage
echo "ğŸ“„ æ£€æŸ¥BasePageä½¿ç”¨..."
git diff --cached --name-only --diff-filter=ACM | grep 'pages/.*/index\.js$' | while read file; do
  if [ -f "$file" ]; then
    if ! grep -q "BasePage" "$file"; then
      echo "âš ï¸  è­¦å‘Š: $file æœªä½¿ç”¨BasePageåŸºç±»"
    fi
  fi
done

echo "âœ… æäº¤å‰æ£€æŸ¥é€šè¿‡"
```

### è‡ªåŠ¨åŒ–å·¥å…·

#### æ‰¹é‡ä¿®å¤è„šæœ¬
```bash
#!/bin/bash
# fix-subpackage-requires.sh
# æ‰¹é‡ä¿®å¤è·¨åˆ†åŒ…requireè­¦å‘Š

echo "ğŸ”§ å¼€å§‹ä¿®å¤è·¨åˆ†åŒ…require..."

# æŸ¥æ‰¾æ‰€æœ‰è·¨åˆ†åŒ…require
grep -r "require.*package" miniprogram/ --include="*.js" | grep -v callback | while IFS=':' read file line; do
  echo "ä¿®å¤æ–‡ä»¶: $file"
  # è¿™é‡Œå¯ä»¥æ·»åŠ è‡ªåŠ¨ä¿®å¤é€»è¾‘
done

echo "âœ… ä¿®å¤å®Œæˆ"
```

#### é¡¹ç›®å¥åº·æ£€æŸ¥
```javascript
// health-check.js - é¡¹ç›®å¥åº·çŠ¶æ€æ£€æŸ¥
const fs = require('fs');
const path = require('path');

class FlightToolboxHealthChecker {
  check() {
    console.log('ğŸ¥ FlightToolbox å¥åº·æ£€æŸ¥å¼€å§‹...\n');
    
    this.checkSubpackages();
    this.checkAudioFiles();
    this.checkBasePage();
    this.checkProjectConfig();
    
    console.log('\nğŸ‰ å¥åº·æ£€æŸ¥å®Œæˆï¼');
  }
  
  checkSubpackages() {
    console.log('ğŸ“¦ æ£€æŸ¥åˆ†åŒ…é…ç½®...');
    // åˆ†åŒ…æ£€æŸ¥é€»è¾‘
  }
  
  checkAudioFiles() {
    console.log('ğŸµ æ£€æŸ¥éŸ³é¢‘æ–‡ä»¶...');
    // éŸ³é¢‘æ–‡ä»¶æ£€æŸ¥é€»è¾‘
  }
  
  checkBasePage() {
    console.log('ğŸ“„ æ£€æŸ¥BasePageä½¿ç”¨æƒ…å†µ...');
    // BasePageæ£€æŸ¥é€»è¾‘
  }
  
  checkProjectConfig() {
    console.log('âš™ï¸ æ£€æŸ¥é¡¹ç›®é…ç½®...');
    // é¡¹ç›®é…ç½®æ£€æŸ¥é€»è¾‘
  }
}

new FlightToolboxHealthChecker().check();
```

é€šè¿‡è¿™äº›å¼€å‘å·¥å…·å’Œé…ç½®ï¼Œå¯ä»¥æ˜¾è‘—æå‡FlightToolboxé¡¹ç›®çš„å¼€å‘æ•ˆç‡å’Œä»£ç è´¨é‡ã€‚

# important-instruction-reminders

Do what has been asked; nothing more, nothing less.
NEVER create files unless they're absolutely necessary for achieving your goal.
ALWAYS prefer editing an existing file to creating a new one.
NEVER proactively create documentation files (*.md) or README files. Only create documentation files if explicitly requested by the User.
