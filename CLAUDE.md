# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

è¯·ç”¨ä¸­æ–‡å›å¤

## ğŸ“± é¡¹ç›®æ¦‚è¿°

FlightToolbox æ˜¯ä¸€ä¸ªä¸“ä¸ºèˆªç©ºé£è¡Œå‘˜è®¾è®¡çš„å¾®ä¿¡å°ç¨‹åºï¼Œä¸“æ³¨äºèˆªç©ºé£è¡Œå·¥å…·å’Œèˆªçº¿å½•éŸ³åŠŸèƒ½ã€‚ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š

- **ğŸ›« èˆªçº¿é£è¡Œæ¨¡å—**ï¼šçœŸå®æœºåœºèˆªçº¿å½•éŸ³æ’­æ”¾å’Œå­¦ä¹ 
- **ğŸ” ä¸‡èƒ½æŸ¥è¯¢**ï¼šICAOä»£ç ã€ç¼©å†™ã€å®šä¹‰ã€æœºåœºä¿¡æ¯æŸ¥è¯¢
- **ğŸ§® é£è¡Œè®¡ç®—**ï¼šå„ç§èˆªç©ºè®¡ç®—å™¨å’Œå·¥å…·
- **ğŸ“» é€šä¿¡å¤±æ•ˆç¨‹åº**ï¼šå„åœ°åŒºé€šä¿¡å¤±æ•ˆå¤„ç†å·®å¼‚ç¨‹åº
- **ğŸ› ï¸ å…¶ä»–å·¥å…·**ï¼šä¸ªäººæ£€æŸ¥å•ã€èµ„è´¨ç®¡ç†ã€äº‹ä»¶æŠ¥å‘Šç­‰

## ğŸš¨ CRITICAL - å¿…é¡»ç¦»çº¿è¿è¡Œ

æœ¬å°ç¨‹åºä¸“ä¸ºèˆªç©ºé£è¡Œå‘˜è®¾è®¡ï¼Œ**å¿…é¡»èƒ½å¤Ÿåœ¨å®Œå…¨ç¦»çº¿ç¯å¢ƒä¸‹æ­£å¸¸è¿è¡Œ**ã€‚

### ä¸ºä»€ä¹ˆå¿…é¡»ç¦»çº¿ï¼Ÿ

1. **é£è¡Œå®‰å…¨è¦æ±‚**ï¼šé£è¡Œå‘˜åœ¨ç©ºä¸­æ‰§è¡Œä»»åŠ¡æ—¶ï¼Œæ‰‹æœºå¿…é¡»å¼€å¯é£è¡Œæ¨¡å¼
2. **é«˜ç©ºç½‘ç»œé™åˆ¶**ï¼šä¸‡ç±³é«˜ç©ºä¸­æ— æ³•ä½¿ç”¨ç§»åŠ¨ç½‘ç»œæˆ–WiFi
3. **ç´§æ€¥æƒ…å†µå¤„ç†**ï¼šé€šä¿¡å¤±æ•ˆç­‰ç´§æ€¥æƒ…å†µä¸‹ï¼Œé£è¡Œå‘˜éœ€è¦ç«‹å³è®¿é—®ç¨‹åºå’Œæ•°æ®
4. **æ³•è§„éµå¾ª**ï¼šæ°‘èˆªæ³•è§„è¦æ±‚é£è¡Œè¿‡ç¨‹ä¸­å…³é—­æ— çº¿é€šä¿¡åŠŸèƒ½

### è®¾è®¡è¦æ±‚

- âœ… **æ‰€æœ‰æ ¸å¿ƒæ•°æ®å¿…é¡»æœ¬åœ°å­˜å‚¨**ï¼šICAOä»£ç ã€æœºåœºæ•°æ®ã€é€šä¿¡ç¨‹åºç­‰
- âœ… **éŸ³é¢‘æ–‡ä»¶å¿…é¡»æœ¬åœ°ç¼“å­˜**ï¼šèˆªçº¿å½•éŸ³ã€å‘éŸ³ç¤ºä¾‹ç­‰
- âœ… **åˆ†åŒ…é¢„åŠ è½½ç­–ç•¥**ï¼šç¡®ä¿å…³é”®æ•°æ®åœ¨ç¦»çº¿æ—¶å¯ç”¨
- âœ… **æ— ç½‘ç»œä¾èµ–åŠŸèƒ½**ï¼šè®¡ç®—å™¨ã€æ£€æŸ¥å•ã€ç¨‹åºæŸ¥è¯¢ç­‰
- âŒ **ç¦æ­¢åœ¨çº¿APIè°ƒç”¨**ï¼šä¸èƒ½ä¾èµ–å®æ—¶ç½‘ç»œæ•°æ®
- âŒ **ç¦æ­¢äº‘ç«¯å­˜å‚¨ä¾èµ–**ï¼šç”¨æˆ·æ•°æ®å¿…é¡»æœ¬åœ°å­˜å‚¨

### æµ‹è¯•éªŒè¯

å¼€å‘æ—¶å¿…é¡»éªŒè¯ï¼š

1. å¼€å¯é£è¡Œæ¨¡å¼åæ‰€æœ‰åŠŸèƒ½æ­£å¸¸
2. åˆ†åŒ…æ•°æ®åœ¨æ— ç½‘ç»œæ—¶å¯æ­£å¸¸åŠ è½½
3. éŸ³é¢‘æ’­æ”¾åœ¨ç¦»çº¿çŠ¶æ€ä¸‹æ­£å¸¸
4. è®¡ç®—å’ŒæŸ¥è¯¢åŠŸèƒ½å®Œå…¨ç¦»çº¿å¯ç”¨

## ğŸš¨ JavaScript è¯­æ³•å…¼å®¹æ€§æŒ‡å—

### ç°çŠ¶ç¡®è®¤

é¡¹ç›®é…ç½®ä¸­å·²å¯ç”¨ES6è½¬æ¢ï¼ˆ`"es6": true`ï¼‰ï¼Œå¾®ä¿¡å¼€å‘è€…å·¥å…·ä¼šè‡ªåŠ¨å¤„ç†ES6+è¯­æ³•çš„å…¼å®¹æ€§è½¬æ¢ã€‚

### JavaScript æ”¯æŒæƒ…å†µ

#### è¿è¡Œé™åˆ¶

åŸºäºå®‰å…¨è€ƒè™‘ï¼Œå°ç¨‹åºä¸­ä¸æ”¯æŒåŠ¨æ€æ‰§è¡Œ JS ä»£ç ï¼Œå³ï¼š

- âŒ ä¸æ”¯æŒä½¿ç”¨ `eval` æ‰§è¡Œ JS ä»£ç 
- âŒ ä¸æ”¯æŒä½¿ç”¨ `new Function` åˆ›å»ºå‡½æ•°ï¼ˆ`new Function('return this')` é™¤å¤–ï¼‰

#### æ ‡å‡† ECMAScript æ”¯æŒ

å°ç¨‹åºçš„ JS æ‰§è¡Œç¯å¢ƒåœ¨ä¸åŒå¹³å°ä¸Šå­˜åœ¨å·®å¼‚ï¼Œå› æ­¤å¯¼è‡´ä¸åŒå¹³å°å¯¹ ECMAScript æ ‡å‡†çš„æ”¯æŒå­˜åœ¨å·®å¼‚ã€‚

å°ç¨‹åºåŸºç¡€åº“å†…ç½®äº†ä¸€ä»½ **core-js Polyfill** æ¥å°½é‡æŠ¹å¹³è¿™äº›å·®å¼‚ï¼Œå¯ä»¥å°†å¹³å°ç¯å¢ƒç¼ºå¤±çš„æ ‡å‡† API è¡¥é½ã€‚

âš ï¸ **æ³¨æ„**ï¼šå¹³å°å¯¹ ECMAScript è¯­æ³•çš„æ”¯æŒå·®å¼‚æ— æ³•æŠ¹å¹³ï¼Œå½“ä½¿ç”¨é«˜çº§è¯­æ³•ï¼ˆå¦‚ `async/await`ï¼‰æ—¶ï¼Œéœ€è¦å€ŸåŠ©ä»£ç è½¬æ¢å·¥å…·æ¥æ”¯æŒè¿™äº›è¯­æ³•ã€‚

#### æ— æ³•è¢« Polyfill çš„ API

ä»¥ä¸‹ API åœ¨éƒ¨åˆ†ä½ç‰ˆæœ¬å®¢æˆ·ç«¯ä¸­æ— æ³•ä½¿ç”¨ï¼Œè¯·æ³¨æ„å°½é‡é¿å…ä½¿ç”¨ï¼š

- âŒ `Proxy` å¯¹è±¡

#### ä¸æ ‡å‡†çš„å·®å¼‚

**Promise æ—¶åºå·®å¼‚**ï¼š
ç”±äº iOS JavaScriptCore çš„é™åˆ¶ï¼ŒiOS 15 åŠä»¥ä¸‹çš„ Promise æ˜¯ä¸€ä¸ªä½¿ç”¨ setTimeout æ¨¡æ‹Ÿçš„ Polyfillã€‚è¿™æ„å‘³ç€ Promise è§¦å‘çš„ä»»åŠ¡ä¸ºæ™®é€šä»»åŠ¡ï¼Œè€Œéå¾®ä»»åŠ¡ï¼Œè¿›è€Œå¯¼è‡´åœ¨ iOS15 åŠä»¥ä¸‹çš„ Promise æ—¶åºä¼šå’Œæ ‡å‡†å­˜åœ¨å·®å¼‚ã€‚

```javascript
var arr = []

setTimeout(() => arr.push(6), 0)
arr.push(1)
const p = new Promise(resolve => {
  arr.push(2)
  resolve()
})
arr.push(3)
p.then(() => arr.push(5))
arr.push(4)
setTimeout(() => arr.push(7), 0)

setTimeout(() => {
  // æ ‡å‡†åº”è¯¥è¾“å‡º [1,2,3,4,5,6,7]
  // åœ¨ iOS15 å°ç¨‹åºç¯å¢ƒï¼Œè¿™é‡Œä¼šè¾“å‡º [1,2,3,4,6,5,7]
  console.log(arr)
}, 1000)
```

iOS 16 åŠä»¥ä¸Šä¸å­˜åœ¨æ­¤å·®å¼‚ã€‚

### è¯­æ³•é”™è¯¯æ’æŸ¥æŒ‡å—

#### å¦‚æœé‡åˆ° "Unexpected token: punc (.)" é”™è¯¯

1. **æ£€æŸ¥é¡¹ç›®é…ç½®**ï¼šç¡®è®¤ `project.config.json` ä¸­ `"es6": true` å·²å¯ç”¨
2. **æ£€æŸ¥åŸºç¡€åº“ç‰ˆæœ¬**ï¼šç¡®è®¤ä½¿ç”¨çš„åŸºç¡€åº“ç‰ˆæœ¬æ”¯æŒæ‰€éœ€è¯­æ³•
3. **çœŸæœºæµ‹è¯•**ï¼šåœ¨çœŸæœºä¸ŠéªŒè¯åŠŸèƒ½æ˜¯å¦æ­£å¸¸
4. **é™çº§å¤„ç†**ï¼šå¦‚é‡å…¼å®¹æ€§é—®é¢˜ï¼Œè€ƒè™‘ä½¿ç”¨æ›´å…¼å®¹çš„è¯­æ³•

#### æ¨èçš„å…¼å®¹æ€§ç­–ç•¥

1. **ä¼˜å…ˆä½¿ç”¨ES6+è¯­æ³•**ï¼šåˆ©ç”¨å·¥å…·è‡ªåŠ¨è½¬æ¢
2. **å…³é”®åŠŸèƒ½å…¼å®¹æ€§æµ‹è¯•**ï¼šç¡®ä¿æ ¸å¿ƒåŠŸèƒ½åœ¨ç›®æ ‡è®¾å¤‡ä¸Šæ­£å¸¸è¿è¡Œ
3. **Polyfillä½¿ç”¨**ï¼šåˆç†ä½¿ç”¨å†…ç½®çš„core-js Polyfill
4. **é¿å…ä½¿ç”¨ä¸æ”¯æŒçš„API**ï¼šå¦‚Proxyç­‰

### å¼€å‘å»ºè®®

1. **ç°ä»£è¯­æ³•**ï¼šå¯ä»¥ä½¿ç”¨ES6+è¯­æ³•ï¼Œå·¥å…·ä¼šè‡ªåŠ¨å¤„ç†å…¼å®¹æ€§
2. **æµ‹è¯•éªŒè¯**ï¼šé‡ç‚¹åœ¨çœŸæœºä¸Šæµ‹è¯•ï¼Œç‰¹åˆ«æ˜¯ä½ç‰ˆæœ¬iOSè®¾å¤‡
3. **é”™è¯¯å¤„ç†**ï¼šé‡åˆ°å…¼å®¹æ€§é—®é¢˜æ—¶ï¼Œé‡‡ç”¨æ›´ä¿å®ˆçš„è¯­æ³•å®ç°

## ğŸ“¦ é‡æ„åçš„ç»Ÿä¸€ç»„ä»¶æ¶æ„ï¼ˆ2025å¹´7æœˆï¼‰

### ğŸ¯ æ ¸å¿ƒç»„ä»¶ä½¿ç”¨

é‡æ„åé¡¹ç›®æä¾›ç»Ÿä¸€çš„åŸºç±»å’Œç»„ä»¶ï¼Œ**æ‰€æœ‰æ–°é¡µé¢å¿…é¡»ä½¿ç”¨ä»¥ä¸‹ç»„ä»¶**ï¼š

#### 1. BasePage ç»Ÿä¸€é¡µé¢åŸºç±»

```javascript
// æ–°é¡µé¢å¿…é¡»ä½¿ç”¨BasePageåŸºç±»
var BasePage = require('../../utils/base-page.js');

var pageConfig = {
  data: {
    // é¡µé¢æ•°æ®
  },
  
  customOnLoad: function(options) {
    // è‡ªå®šä¹‰åŠ è½½é€»è¾‘ï¼ˆä¸»é¢˜ç®¡ç†è‡ªåŠ¨å¤„ç†ï¼‰
  },
  
  // ä½¿ç”¨åŸºç±»æä¾›çš„æ–¹æ³•
  myMethod: function() {
    this.loadDataWithLoading(loadFunction, options);
    this.showSuccess('æ“ä½œæˆåŠŸ');
    this.handleError(error, 'æ“ä½œå¤±è´¥');
  }
};

Page(BasePage.createPage(pageConfig));
```

#### 2. SearchComponent ç»Ÿä¸€æœç´¢ç»„ä»¶

```javascript
var SearchComponent = require('../../utils/search-component.js');
var searchComponent = SearchComponent.createSearchComponent();

// åœ¨é¡µé¢ä¸­ä½¿ç”¨
performSearch: function(keyword) {
  var results = searchComponent.search(keyword, this.data.originalData, {
    searchFields: ['name', 'description']
  });
  this.setData({ filteredData: results });
}
```

#### 3. PickerComponent ç»Ÿä¸€é€‰æ‹©å™¨ç»„ä»¶

```javascript
var PickerComponent = require('../../utils/picker-component.js');
var pickerComponent = PickerComponent.createPickerComponent();

// åˆ›å»ºé€‰æ‹©å™¨æ··å…¥
var pickerMixin = pickerComponent.createPickerMixin({
  onConfirm: function(event) {
    // å¤„ç†é€‰æ‹©ç»“æœ
  }
});
```

#### 4. DataLoader ç»Ÿä¸€æ•°æ®åŠ è½½

```javascript
var dataLoader = require('../../utils/data-loader.js');

// åˆ†åŒ…æ•°æ®åŠ è½½
dataLoader.loadSubpackageData(this, 'packageA', '../../packageA/data.js', {
  fallbackData: [],
  context: 'åˆ†åŒ…æ•°æ®'
});
```

### ğŸš¨ é‡è¦çº¦å®š

1. **JavaScriptè¯­æ³•**ï¼šæ”¯æŒES6+è¯­æ³•ï¼ŒåŒ…æ‹¬classã€ç®­å¤´å‡½æ•°ã€æ¨¡æ¿å­—ç¬¦ä¸²ç­‰
2. **ç”Ÿå‘½å‘¨æœŸ**ï¼šä½¿ç”¨ `customOnLoad`ã€`customOnShow` ç­‰è‡ªå®šä¹‰ç”Ÿå‘½å‘¨æœŸ
3. **é”™è¯¯å¤„ç†**ï¼šä¼˜å…ˆä½¿ç”¨åŸºç±»çš„ `handleError()` æ–¹æ³•
4. **æ•°æ®åŠ è½½**ï¼šä¼˜å…ˆä½¿ç”¨åŸºç±»çš„ `loadDataWithLoading()` æ–¹æ³•
5. **ä¸»é¢˜ç®¡ç†**ï¼šåŸºç±»è‡ªåŠ¨å¤„ç†ï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç†

### ğŸ“‹ é‡æ„å®ŒæˆçŠ¶æ€

- âœ… **BasePageåŸºç±»**ï¼šå·²å®Œæˆï¼Œè§£å†³48ä¸ªæ–‡ä»¶çš„ä¸»é¢˜ç®¡ç†é‡å¤
- âœ… **æœç´¢ç»„ä»¶**ï¼šå·²å®Œæˆï¼Œè§£å†³6ä¸ªæ–‡ä»¶çš„æœç´¢åŠŸèƒ½é‡å¤
- âœ… **Pickerç»„ä»¶**ï¼šå·²å®Œæˆï¼Œè§£å†³14ä¸ªæ–‡ä»¶çš„é€‰æ‹©å™¨é‡å¤
- âœ… **æ•°æ®åŠ è½½å™¨**ï¼šå·²å®Œæˆï¼Œæ”¯æŒåˆ†åŒ…å¼‚æ­¥åŒ–å’Œç¦»çº¿ç¼“å­˜
- âœ… **é”™è¯¯å¤„ç†ç³»ç»Ÿ**ï¼šå·²å®Œæˆï¼Œè§£å†³74ä¸ªæ–‡ä»¶çš„é”™è¯¯å¤„ç†é‡å¤

### ğŸ“– è¯¦ç»†æ–‡æ¡£

å‚è€ƒ `miniprogram/utils/README.md` è·å–å®Œæ•´çš„ç»„ä»¶ä½¿ç”¨æŒ‡å—ã€‚

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### å°ç¨‹åºæ¶æ„

- **æ¡†æ¶**ï¼šå¾®ä¿¡å°ç¨‹åºåŸç”Ÿæ¡†æ¶
- **ç»„ä»¶åº“**ï¼šVant Weapp UIç»„ä»¶åº“  
- **å¼€å‘è¯­è¨€**ï¼šJavaScript (ES6+è¯­æ³•å®Œå…¨æ”¯æŒ)
- **ç¼–è¯‘å™¨**ï¼šå¯ç”¨ES6è½¬æ¢å’ŒSWCç¼–è¯‘å™¨ï¼Œè‡ªåŠ¨å¤„ç†å…¼å®¹æ€§

### ğŸ“¦ åˆ†åŒ…ç»“æ„

é¡¹ç›®é‡‡ç”¨åˆ†åŒ…æ¶æ„ï¼ŒæŒ‰åŠŸèƒ½å’Œåœ°åŒºåˆ†åŒ…ï¼š

#### åŠŸèƒ½åˆ†åŒ…

- `packageA` - ICAOä»£ç æ•°æ® (30ä¸‡æ¡è®°å½•)
- `packageB` - ç¼©å†™æ•°æ® (2ä¸‡æ¡è®°å½•)
- `packageC` - æœºåœºæ•°æ® (5åƒæ¡è®°å½•)
- `packageD` - å®šä¹‰æ•°æ® (3åƒæ¡è®°å½•)
- `packageF` - ACRæ•°æ® (è·‘é“ç³»æ•°)
- `packageG` - å±é™©å“æ•°æ® (è¿è¾“è§„èŒƒ)
- `packageH` - åŒå‘å¤é£æ•°æ® (æ¢¯åº¦è®¡ç®—)
- `packageO` - å…¶ä»–é¡µé¢åŠŸèƒ½ (å·¥å…·é›†åˆ)
- `packagePerformance` - æ€§èƒ½å‚æ•°æ•°æ® (é£æœºæ€§èƒ½)
- `packageHealth` - èˆªåŒ»å¥åº·æ•°æ® (åŒ»å­¦æ ‡å‡†)
- `packageCCAR` - CAACè§„ç« æ•°æ® (æ³•è§„æ–‡ä»¶)

#### éŸ³é¢‘åˆ†åŒ…ï¼ˆæŒ‰å›½å®¶åœ°åŒºï¼‰

- `packageJapan` - æ—¥æœ¬æˆç”°æœºåœºå½•éŸ³ (24æ¡)
- `packagePhilippines` - è²å¾‹å®¾é©¬å°¼æ‹‰æœºåœºå½•éŸ³ (27æ¡)
- `packageKorean` - éŸ©å›½ä»å·æœºåœºå½•éŸ³ (19æ¡)
- `packageSingapore` - æ–°åŠ å¡æ¨Ÿå®œæœºåœºå½•éŸ³ (8æ¡)
- `packageThailand` - æ³°å›½æ›¼è°·æœºåœºå½•éŸ³ (22æ¡)
- `packageRussia` - ä¿„ç½—æ–¯è«æ–¯ç§‘æœºåœºå½•éŸ³ (23æ¡)
- `packageSrilanka` - æ–¯é‡Œå…°å¡ç§‘ä¼¦å¡æœºåœºå½•éŸ³ (22æ¡)
- `packageAustralia` - æ¾³å¤§åˆ©äºšæ‚‰å°¼æœºåœºå½•éŸ³ (20æ¡)
- `packageTurkey` - åœŸè€³å…¶ä¼Šæ–¯å¦å¸ƒå°”æœºåœºå½•éŸ³ (28æ¡)
- `packageFrance` - æ³•å›½æˆ´é«˜ä¹æœºåœºå½•éŸ³ (19æ¡)
- `packageAmerica` - ç¾å›½æ—§é‡‘å±±æœºåœºå½•éŸ³ (52æ¡)
- `packageItaly` - æ„å¤§åˆ©ç½—é©¬æœºåœºå½•éŸ³ (29æ¡)
- `packageUAE` - é˜¿è”é…‹è¿ªæ‹œæœºåœºå½•éŸ³ (37æ¡)

### ğŸš¨ è·¨åˆ†åŒ…æ¨¡å—å¼•ç”¨è§„èŒƒ

**è·¨åˆ†åŒ…æ¨¡å—å¼•ç”¨å¿…é¡»ä½¿ç”¨å¼‚æ­¥æ–¹å¼ï¼Œé¿å…ç”Ÿäº§ç¯å¢ƒåŠ è½½å¤±è´¥**

#### æ ¸å¿ƒè¦æ±‚

- âœ… **å¼‚æ­¥require**ï¼šè·¨åˆ†åŒ…å¼•ç”¨å¿…é¡»ä½¿ç”¨å›è°ƒå‡½æ•°
- âŒ **åŒæ­¥require**ï¼šç¦æ­¢ç›´æ¥åŒæ­¥å¼•ç”¨å…¶ä»–åˆ†åŒ…æ¨¡å—
- ğŸ”§ **ç”Ÿäº§å…¼å®¹**ï¼šç¡®ä¿ç”Ÿäº§ç¯å¢ƒä¸‹åˆ†åŒ…æ­£å¸¸åŠ è½½

#### æ­£ç¡®ç¤ºä¾‹

```javascript
// âœ… æ­£ç¡®ï¼šå¼‚æ­¥require with å›è°ƒ
require('../../packageA/data.js', function(data) {
  // æˆåŠŸåŠ è½½å¤„ç†
  console.log('æ•°æ®åŠ è½½æˆåŠŸ', data);
}, function(error) {
  // å¤±è´¥å¤„ç†
  console.error('æ•°æ®åŠ è½½å¤±è´¥', error);
});

// âŒ é”™è¯¯ï¼šåŒæ­¥require
var data = require('../../packageA/data.js'); // ç”Ÿäº§ç¯å¢ƒå¯èƒ½å¤±è´¥
```

#### æŠ€æœ¯åŸç†

å¾®ä¿¡å°ç¨‹åºç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œè·¨åˆ†åŒ…çš„åŒæ­¥ `require`å¯èƒ½å› åˆ†åŒ…æœªé¢„åŠ è½½è€Œå¤±è´¥ï¼Œå¿…é¡»ä½¿ç”¨å¼‚æ­¥æ–¹å¼ç¡®ä¿å…¼å®¹æ€§ã€‚

### ğŸµ éŸ³é¢‘é…ç½®æ¶æ„

éŸ³é¢‘ç³»ç»Ÿé‡‡ç”¨ä¸‰å±‚æ¶æ„ï¼š

1. **æ•°æ®å±‚**ï¼š`miniprogram/data/regions/*.js` - å„å›½å½•éŸ³æ•°æ®å’Œå…ƒä¿¡æ¯
2. **é…ç½®å±‚**ï¼š`miniprogram/utils/audio-config.js` - ç»Ÿä¸€é…ç½®ç®¡ç†å™¨
3. **åˆ†åŒ…å±‚**ï¼š`package*/` - éŸ³é¢‘èµ„æºåˆ†åŒ…å­˜å‚¨

## ğŸ”§ å¼€å‘å‘½ä»¤

### å¾®ä¿¡å°ç¨‹åºå¼€å‘æµç¨‹

```bash
# 1. å®‰è£…ä¾èµ–
cd miniprogram && npm install

# 2. æ„å»ºnpmåŒ… (å¾®ä¿¡å¼€å‘è€…å·¥å…·)
# å·¥å…· -> æ„å»ºnpm -> ç¡®è®¤æ„å»º

# 3. ç¼–è¯‘æ„å»º
# å¾®ä¿¡å¼€å‘è€…å·¥å…· -> ç¼–è¯‘

# 4. çœŸæœºè°ƒè¯•
# å¾®ä¿¡å¼€å‘è€…å·¥å…· -> é¢„è§ˆ -> æ‰«ç çœŸæœºæµ‹è¯•

# 5. åˆ†åŒ…é¢„ä¸‹è½½æµ‹è¯• (é‡è¦)
# ç¡®ä¿æ‰€æœ‰åˆ†åŒ…åœ¨ç¦»çº¿çŠ¶æ€ä¸‹å¯æ­£å¸¸åŠ è½½
```

### å¸¸ç”¨å¼€å‘ä»»åŠ¡

#### æ·»åŠ æ–°é¡µé¢

```javascript
// 1. åœ¨app.jsonä¸­æ·»åŠ é¡µé¢è·¯å¾„
// 2. ä½¿ç”¨BasePageåŸºç±»åˆ›å»ºé¡µé¢
var BasePage = require('../../utils/base-page.js');

var pageConfig = {
  customOnLoad: function(options) {
    // é¡µé¢é€»è¾‘
  }
};

Page(BasePage.createPage(pageConfig));
```

#### æ·»åŠ æ–°åˆ†åŒ…

```javascript
// 1. åœ¨app.jsonçš„subPackagesä¸­æ·»åŠ é…ç½®
// 2. ä½¿ç”¨DataLoaderåŠ è½½åˆ†åŒ…æ•°æ®
var dataLoader = require('../../utils/data-loader.js');

dataLoader.loadSubpackageData(this, 'packageName', './data.js', {
  fallbackData: [],
  context: 'åˆ†åŒ…æè¿°'
});
```

#### éŸ³é¢‘åˆ†åŒ…å¼€å‘

```javascript
// 1. åœ¨miniprogram/data/regions/åˆ›å»ºåœ°åŒºæ•°æ®æ–‡ä»¶
// 2. ä½¿ç”¨audio-config.jsç®¡ç†éŸ³é¢‘é…ç½®
var audioConfig = require('../../utils/audio-config.js');
var audioData = audioConfig.getRegionData('regionName');
```

### ä»£ç æ£€æŸ¥

```bash
# JavaScriptè¯­æ³•æ£€æŸ¥
node -c miniprogram/utils/[filename].js

# æ‰¹é‡è¯­æ³•éªŒè¯
find miniprogram/ -name "*.js" -exec node -c {} \;
```

### æµ‹è¯•éªŒè¯æµç¨‹

#### å¼€å‘é˜¶æ®µæµ‹è¯•

```bash
# JavaScriptè¯­æ³•éªŒè¯
find miniprogram -name "*.js" -exec node -c {} \;

# æ£€æŸ¥éŸ³é¢‘æ–‡ä»¶è·¯å¾„
find package* -name "*.mp3" | wc -l  # åº”è¯¥æ˜¾ç¤º330æ¡å½•éŸ³

# éªŒè¯åˆ†åŒ…é…ç½®
grep -r "subPackages" miniprogram/app.json | wc -l

# æµ‹è¯•åˆ†åŒ…è°ƒè¯•å·¥å…·
node -e "console.log('æµ‹è¯•subpackage-debug.jsè¯­æ³•')" && node -c miniprogram/utils/subpackage-debug.js
```

#### å‘å¸ƒå‰æ£€æŸ¥æ¸…å• âœ…

1. **è¯­æ³•æ£€æŸ¥**ï¼š`node -c` éªŒè¯æ‰€æœ‰JSæ–‡ä»¶è¯­æ³•æ­£ç¡®
2. **å¾®ä¿¡å¼€å‘è€…å·¥å…·ç¼–è¯‘**ï¼šç¡®ä¿æ— ç¼–è¯‘é”™è¯¯å’Œè­¦å‘Š
3. **çœŸæœºé¢„è§ˆæµ‹è¯•**ï¼šé€šè¿‡å¾®ä¿¡å¼€å‘è€…å·¥å…·çœŸæœºé¢„è§ˆåŠŸèƒ½
4. **ç¦»çº¿åŠŸèƒ½æµ‹è¯•**ï¼šå¼€å¯é£è¡Œæ¨¡å¼éªŒè¯æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½
5. **åˆ†åŒ…éªŒè¯**ï¼šç¡®ä¿24ä¸ªåˆ†åŒ…å¼‚æ­¥åŠ è½½æ­£å¸¸
6. **éŸ³é¢‘æµ‹è¯•**ï¼šéªŒè¯330æ¡å½•éŸ³æ’­æ”¾åŠŸèƒ½
7. **ä»£ç ä½“ç§¯æ£€æŸ¥**ï¼šç¡®ä¿ä¸»åŒ…<2MBï¼Œå„åˆ†åŒ…<2MB
8. **BasePageé›†æˆæ£€æŸ¥**ï¼šç¡®ä¿æ‰€æœ‰é¡µé¢ä½¿ç”¨ç»Ÿä¸€åŸºç±»
9. **æ•°æ®å®Œæ•´æ€§æ£€æŸ¥**ï¼šéªŒè¯30ä¸‡ICAOä»£ç ã€2ä¸‡ç¼©å†™ç­‰æ•°æ®å®Œæ•´æ€§
10. **åˆ†åŒ…è°ƒè¯•æµ‹è¯•**ï¼šä½¿ç”¨ `pages/test-subpackage/index` éªŒè¯åˆ†åŒ…åŠ è½½æ­£å¸¸

## ğŸ“ é‡è¦æ–‡ä»¶è¯´æ˜

### æ ¸å¿ƒé…ç½®æ–‡ä»¶

- `project.config.json` - å°ç¨‹åºé¡¹ç›®é…ç½® (ES6: trueï¼Œä½†å®é™…å¼€å‘éœ€ä½¿ç”¨ES5)
- `miniprogram/app.json` - å°ç¨‹åºå…¨å±€é…ç½® (é¡µé¢ã€åˆ†åŒ…ã€é¢„åŠ è½½)

### é‡æ„åçš„æ ¸å¿ƒå·¥å…·æ–‡ä»¶

- `miniprogram/utils/base-page.js` - ç»Ÿä¸€é¡µé¢åŸºç±» (è§£å†³48ä¸ªæ–‡ä»¶çš„ä¸»é¢˜ç®¡ç†é‡å¤)
- `miniprogram/utils/data-loader.js` - ç»Ÿä¸€æ•°æ®åŠ è½½ç®¡ç†å™¨ (æ”¯æŒåˆ†åŒ…å¼‚æ­¥åŒ–)
- `miniprogram/utils/search-component.js` - ç»Ÿä¸€æœç´¢ç»„ä»¶ (è§£å†³6ä¸ªæ–‡ä»¶çš„æœç´¢é‡å¤)
- `miniprogram/utils/picker-component.js` - ç»Ÿä¸€é€‰æ‹©å™¨ç»„ä»¶ (è§£å†³14ä¸ªæ–‡ä»¶çš„é€‰æ‹©å™¨é‡å¤)
- `miniprogram/utils/error-handler.js` - æ‰©å±•é”™è¯¯å¤„ç†ç³»ç»Ÿ (è§£å†³74ä¸ªæ–‡ä»¶çš„é”™è¯¯å¤„ç†é‡å¤)
- `miniprogram/utils/subpackage-debug.js` - åˆ†åŒ…è°ƒè¯•å·¥å…· (è·¨åˆ†åŒ…requireä¿®å¤)

### éŸ³é¢‘ç³»ç»Ÿæ ¸å¿ƒæ–‡ä»¶

- `miniprogram/utils/audio-config.js` - éŸ³é¢‘é…ç½®ç®¡ç†å™¨ (æ”¯æŒ13ä¸ªå›½å®¶åœ°åŒº)
- `miniprogram/data/regions/*.js` - å„å›½å½•éŸ³æ•°æ®æ–‡ä»¶ (åŒ…å«å…ƒä¿¡æ¯å’Œæ–‡ä»¶è·¯å¾„)

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

#### è¯­æ³•é”™è¯¯

- **é—®é¢˜**ï¼š`Unexpected token: punc (.)`
- **åŸå› **ï¼šå¯èƒ½æ˜¯è¯­æ³•é”™è¯¯æˆ–IDEé…ç½®é—®é¢˜
- **è§£å†³**ï¼šæ£€æŸ¥è¯­æ³•é”™è¯¯ï¼Œç¡®ä¿ES6è½¬æ¢å·²å¯ç”¨ï¼ˆé¡¹ç›®å·²é…ç½®ES6æ”¯æŒï¼‰

#### åˆ†åŒ…åŠ è½½å¤±è´¥

- **é—®é¢˜**ï¼šåˆ†åŒ…æ•°æ®æ— æ³•åŠ è½½
- **æ’æŸ¥**ï¼šæ£€æŸ¥ `app.json` ä¸­çš„ `preloadRule` é…ç½®
- **è§£å†³**ï¼šä½¿ç”¨ `dataLoader.loadSubpackageData()` æ–¹æ³•

#### è·¨åˆ†åŒ…requireè­¦å‘Š

- **é—®é¢˜**ï¼š`Requires "xxx" without a callback may fail in production`
- **åŸå› **ï¼šä½¿ç”¨åŒæ­¥requireè·¨åˆ†åŒ…å¼•ç”¨
- **è§£å†³**ï¼šæ”¹ä¸ºå¼‚æ­¥requireï¼Œå‚è€ƒ `åˆ†åŒ…è·¨åŒ…requireä¿®å¤è¯´æ˜.md`
- **æµ‹è¯•**ï¼šä½¿ç”¨ `pages/test-subpackage/index` æµ‹è¯•é¡µé¢éªŒè¯ä¿®å¤æ•ˆæœ

#### éŸ³é¢‘æ’­æ”¾é—®é¢˜

- **é—®é¢˜**ï¼šéŸ³é¢‘æ— æ³•æ’­æ”¾æˆ–è·¯å¾„é”™è¯¯
- **æ’æŸ¥**ï¼šæ£€æŸ¥ `miniprogram/data/regions/` ä¸­çš„æ•°æ®æ–‡ä»¶
- **è§£å†³**ï¼šä½¿ç”¨ `audio-config.js` ç»Ÿä¸€ç®¡ç†éŸ³é¢‘è·¯å¾„

#### çœŸæœºå…¼å®¹æ€§é—®é¢˜

- **é—®é¢˜**ï¼šå¼€å‘è€…å·¥å…·æ­£å¸¸ï¼ŒçœŸæœºå‡ºé”™
- **åŸå› **ï¼šåŸºç¡€åº“ç‰ˆæœ¬è¿‡ä½æˆ–ç‰¹å®šAPIå…¼å®¹æ€§é—®é¢˜
- **è§£å†³**ï¼šæ£€æŸ¥åŸºç¡€åº“ç‰ˆæœ¬ï¼Œä½¿ç”¨Polyfillæˆ–é™çº§å¤„ç†ç‰¹å®šåŠŸèƒ½

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **åˆ†åŒ…é¢„åŠ è½½**ï¼šåˆ©ç”¨ `preloadRule` é…ç½®å…³é”®åˆ†åŒ…é¢„åŠ è½½
2. **æ•°æ®ç¼“å­˜**ï¼šä½¿ç”¨ `DataLoader` çš„ç¼“å­˜æœºåˆ¶é¿å…é‡å¤åŠ è½½
3. **éŸ³é¢‘é¢„åŠ è½½**ï¼šä½¿ç”¨ `AudioPackageLoader` é¢„åŠ è½½éŸ³é¢‘æ–‡ä»¶
4. **é”™è¯¯å¤„ç†**ï¼šä½¿ç”¨ç»Ÿä¸€çš„ `ErrorHandler` å’Œ `BasePage.handleError()`

## ğŸ“š å‚è€ƒæ–‡æ¡£

### é‡æ„æ¶æ„ç›¸å…³

- é‡æ„åçš„å·¥å…·ç»„ä»¶ä½¿ç”¨æŒ‡å—: `miniprogram/utils/README.md`
  - åŒ…å«BasePageã€SearchComponentã€PickerComponentç­‰å®Œæ•´ä½¿ç”¨è¯´æ˜
  - è¯¦ç»†çš„ES5è¯­æ³•å…¼å®¹æ€§æŒ‡å—
  - ç¦»çº¿ä¼˜å…ˆè®¾è®¡åŸåˆ™

### éŸ³é¢‘é…ç½®æ¶æ„ç›¸å…³

- éŸ³é¢‘åˆ†åŒ…é…ç½®å’Œç®¡ç†: `docs/audio-config-architecture.md`
- éŸ³é¢‘åˆ†åŒ…ä¼˜åŒ–ç­–ç•¥: `docs/audio-subpackage-optimization.md`

### è¯­æ³•é”™è¯¯ä¿®å¤ç›¸å…³

- å¾®ä¿¡å°ç¨‹åºè¯­æ³•éªŒè¯ä¸é”™è¯¯ä¿®å¤: `docs/miniprogram-syntax-validation.md`
  - é€‚ç”¨äºè§£å†³"Unexpected token: punc (.)"ç­‰è¯­æ³•é”™è¯¯
  - åŒ…å«ES6+è¯­æ³•å…¼å®¹æ€§å¤„ç†æ–¹æ¡ˆ
  - æä¾›ç³»ç»Ÿæ€§çš„ä¿®å¤æµç¨‹å’Œé¢„é˜²æªæ–½

### åˆ†åŒ…è°ƒè¯•ä¸ä¿®å¤ç›¸å…³

- åˆ†åŒ…è·¨åŒ…requireä¿®å¤è¯´æ˜: `åˆ†åŒ…è·¨åŒ…requireä¿®å¤è¯´æ˜.md`
  - è§£å†³è·¨åˆ†åŒ…requireè­¦å‘Šé—®é¢˜
  - æä¾›å¼‚æ­¥requireä¿®å¤æ–¹æ¡ˆ
  - åŒ…å«æµ‹è¯•éªŒè¯æ–¹æ³•å’ŒæŠ€æœ¯ç»†èŠ‚

## ğŸ“Š é¡¹ç›®ç»Ÿè®¡

### ä»£ç è§„æ¨¡

- æ€»éŸ³é¢‘æ•°é‡: **330æ¡** çœŸå®æœºåœºå½•éŸ³
- è¦†ç›–å›½å®¶: **13ä¸ª** ä¸»è¦èˆªç©ºå›½å®¶
- åˆ†åŒ…æ•°é‡: **24ä¸ª** åŠŸèƒ½å’ŒéŸ³é¢‘åˆ†åŒ…
- æ ¸å¿ƒé¡µé¢: **27ä¸ª** ä¸»è¦åŠŸèƒ½é¡µé¢
- å·¥å…·ç»„ä»¶: **25ä¸ª** é‡æ„åçš„ç»Ÿä¸€ç»„ä»¶

### æ•°æ®è§„æ¨¡

- ICAOä»£ç : **30ä¸‡æ¡** å…¨çƒæœºåœºä»£ç 
- ç¼©å†™è¯å…¸: **2ä¸‡æ¡** èˆªç©ºç¼©å†™
- æœºåœºæ•°æ®: **5åƒæ¡** æœºåœºä¿¡æ¯
- å®šä¹‰è¯å…¸: **3åƒæ¡** ä¸“ä¸šæœ¯è¯­

# important-instruction-reminders

Do what has been asked; nothing more, nothing less.
NEVER create files unless they're absolutely necessary for achieving your goal.
ALWAYS prefer editing an existing file to creating a new one.
NEVER proactively create documentation files (*.md) or README files. Only create documentation files if explicitly requested by the User.
