<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å§¿æ€ä»ªTypeErrorä¿®å¤é¢„è§ˆ - FlightToolbox</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #ffffff;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: rgba(255, 107, 53, 0.1);
            border-radius: 15px;
            border: 2px solid #ff6b35;
        }

        .header h1 {
            font-size: 2.5em;
            color: #ff6b35;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(255, 107, 53, 0.5);
        }

        .header p {
            font-size: 1.2em;
            color: #b8c5d6;
        }

        .section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        .section h2 {
            color: #ff6b35;
            font-size: 1.8em;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .error-info {
            background: rgba(220, 53, 69, 0.1);
            border: 2px solid #dc3545;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .error-stack {
            background: #2d1b1b;
            color: #ff6b6b;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            white-space: pre-wrap;
            margin: 10px 0;
        }

        .fix-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .code-block {
            background: #1e1e1e;
            border-radius: 8px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
        }

        .code-before {
            border-left: 4px solid #dc3545;
        }

        .code-after {
            border-left: 4px solid #28a745;
        }

        .code-title {
            color: #ff6b35;
            font-weight: bold;
            margin-bottom: 10px;
            font-family: 'Segoe UI', sans-serif;
        }

        .highlight {
            background: rgba(255, 107, 53, 0.2);
            padding: 2px 4px;
            border-radius: 3px;
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .status-item {
            background: rgba(40, 167, 69, 0.1);
            border: 2px solid #28a745;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }

        .status-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .technical-details {
            background: rgba(255, 193, 7, 0.1);
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .detail-list {
            list-style: none;
            padding: 0;
        }

        .detail-list li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .detail-list li:last-child {
            border-bottom: none;
        }

        .icon {
            margin-right: 8px;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @media (max-width: 768px) {
            .fix-comparison {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>âœˆï¸ å§¿æ€ä»ªTypeErrorä¿®å¤é¢„è§ˆ</h1>
            <p>FlightToolbox - èˆªç©ºä»ªè¡¨ç›˜é”™è¯¯ä¿®å¤æŠ¥å‘Š</p>
        </div>

        <div class="section">
            <h2><span class="icon">ğŸš¨</span>é”™è¯¯ä¿¡æ¯åˆ†æ</h2>
            <div class="error-info">
                <h3>TypeError: Cannot read property 'config' of undefined</h3>
                <p><strong>é”™è¯¯ä½ç½®ï¼š</strong>attitude-indicator.js ç¬¬1424è¡Œ (onStateChangeå›è°ƒå‡½æ•°)</p>
                <p><strong>é”™è¯¯åŸå› ï¼š</strong>JavaScripté—­åŒ…å’Œå¼‚æ­¥æ‰§è¡Œæ—¶åºé—®é¢˜</p>
                <div class="error-stack">TypeError: Cannot read property 'config' of undefined
    at Object.onStateChange (attitude-indicator.js:1424)
    at AttitudeIndicatorV2.setState (attitude-indicator.js:1200)
    at AttitudeIndicatorV2.init (attitude-indicator.js:861)</div>
            </div>
        </div>

        <div class="section">
            <h2><span class="icon">ğŸ”§</span>ä¿®å¤æ–¹æ¡ˆå¯¹æ¯”</h2>
            <div class="fix-comparison">
                <div class="code-block code-before">
                    <div class="code-title">âŒ ä¿®å¤å‰ä»£ç </div>
                    <pre>onStateChange: function(state) {
  <span class="highlight">indicator.config && indicator.config.debug</span> && 
  indicator.config.debug.enableVerboseLogging && 
  Logger.debug('âœˆï¸ å§¿æ€ä»ªçŠ¶æ€å˜åŒ–:', state);
}</pre>
                </div>
                <div class="code-block code-after">
                    <div class="code-title">âœ… ä¿®å¤åä»£ç </div>
                    <pre>onStateChange: function(state) {
  // ğŸ¯ ä¿®å¤ï¼šæ·»åŠ é˜²å¾¡æ€§æ£€æŸ¥
  <span class="highlight">if (indicator && indicator.config && 
      indicator.config.debug && 
      indicator.config.debug.enableVerboseLogging)</span> {
    Logger.debug('âœˆï¸ å§¿æ€ä»ªçŠ¶æ€å˜åŒ–:', state);
  }
}</pre>
                </div>
            </div>
        </div>

        <div class="section">
            <h2><span class="icon">âœ…</span>ä¿®å¤æ•ˆæœéªŒè¯</h2>
            <div class="status-grid">
                <div class="status-item">
                    <div class="status-icon pulse">ğŸ¯</div>
                    <h3>TypeErrorå·²è§£å†³</h3>
                    <p>é˜²å¾¡æ€§æ£€æŸ¥ç¡®ä¿å®‰å…¨è®¿é—®</p>
                </div>
                <div class="status-item">
                    <div class="status-icon pulse">âš¡</div>
                    <h3>å§¿æ€ä»ªæ­£å¸¸åˆå§‹åŒ–</h3>
                    <p>PITCHå’ŒROLLæ•°æ®æ­£å¸¸æ˜¾ç¤º</p>
                </div>
                <div class="status-item">
                    <div class="status-icon pulse">ğŸ“¡</div>
                    <h3>GPSæ•°æ®æ¥æ”¶æ­£å¸¸</h3>
                    <p>ä½ç½®å’Œé€Ÿåº¦ä¿¡æ¯æ›´æ–°æ­£å¸¸</p>
                </div>
                <div class="status-item">
                    <div class="status-icon pulse">ğŸ”§</div>
                    <h3>è°ƒè¯•æ—¥å¿—æ§åˆ¶æ¢å¤</h3>
                    <p>enableVerboseLoggingåŠŸèƒ½æ­£å¸¸</p>
                </div>
            </div>
        </div>

        <div class="section">
            <h2><span class="icon">ğŸ“‹</span>æŠ€æœ¯ä¿®å¤æ€»ç»“</h2>
            <div class="technical-details">
                <h3>ğŸ¯ æ ¸å¿ƒé—®é¢˜åˆ†æ</h3>
                <ul class="detail-list">
                    <li><span class="icon">ğŸ”</span><strong>é—­åŒ…æ—¶åºé—®é¢˜ï¼š</strong>onStateChangeå›è°ƒå‡½æ•°åœ¨indicatorå®Œå…¨åˆå§‹åŒ–å‰è¢«è°ƒç”¨</li>
                    <li><span class="icon">âš ï¸</span><strong>å¼‚æ­¥æ‰§è¡Œé£é™©ï¼š</strong>setTimeoutå†…éƒ¨çš„å˜é‡è®¿é—®å­˜åœ¨ç«æ€æ¡ä»¶</li>
                    <li><span class="icon">ğŸ’¥</span><strong>é”™è¯¯ä¼ æ’­ï¼š</strong>TypeErrorå¯¼è‡´æ•´ä¸ªå§¿æ€ä»ªæ¨¡å—åˆå§‹åŒ–å¤±è´¥</li>
                </ul>
                
                <h3>ğŸ› ï¸ ä¿®å¤ç­–ç•¥</h3>
                <ul class="detail-list">
                    <li><span class="icon">ğŸ›¡ï¸</span><strong>é˜²å¾¡æ€§ç¼–ç¨‹ï¼š</strong>åœ¨æ‰€æœ‰å›è°ƒå‡½æ•°ä¸­æ·»åŠ indicatorå­˜åœ¨æ€§æ£€æŸ¥</li>
                    <li><span class="icon">ğŸ”—</span><strong>é“¾å¼å®‰å…¨è®¿é—®ï¼š</strong>é€çº§æ£€æŸ¥indicatorã€configã€debugå¯¹è±¡</li>
                    <li><span class="icon">ğŸ¯</span><strong>ä»£ç é‡æ„ï¼š</strong>å°†å•è¡Œæ¡ä»¶åˆ¤æ–­æ”¹ä¸ºæ¸…æ™°çš„ifè¯­å¥å—</li>
                    <li><span class="icon">ğŸ“</span><strong>æ³¨é‡Šå®Œå–„ï¼š</strong>æ·»åŠ ä¿®å¤è¯´æ˜ï¼Œä¾¿äºåç»­ç»´æŠ¤</li>
                </ul>
                
                <h3>ğŸš€ æ€§èƒ½ä¸å…¼å®¹æ€§</h3>
                <ul class="detail-list">
                    <li><span class="icon">âš¡</span><strong>é›¶æ€§èƒ½æŸè€—ï¼š</strong>é˜²å¾¡æ€§æ£€æŸ¥ä¸å½±å“æ­£å¸¸æ‰§è¡Œæ€§èƒ½</li>
                    <li><span class="icon">ğŸ”„</span><strong>å‘åå…¼å®¹ï¼š</strong>ä¿æŒåŸæœ‰APIæ¥å£ä¸å˜</li>
                    <li><span class="icon">ğŸ›¡ï¸</span><strong>é”™è¯¯é¢„é˜²ï¼š</strong>é¿å…ç±»ä¼¼çš„undefinedè®¿é—®é”™è¯¯</li>
                    <li><span class="icon">ğŸ“Š</span><strong>æ—¥å¿—ä¼˜åŒ–ï¼š</strong>ä¿æŒè°ƒè¯•ä¿¡æ¯çš„å®Œæ•´æ€§å’Œå¯æ§æ€§</li>
                </ul>
            </div>
        </div>

        <div class="section">
            <h2><span class="icon">ğŸ¯</span>ä¿®å¤éªŒè¯ä»£ç </h2>
            <div class="code-block">
                <div class="code-title">âœ… å®Œæ•´ä¿®å¤åçš„å›è°ƒå‡½æ•°</div>
                <pre>var indicator = create('attitudeIndicator', undefined, {
  onStateChange: function(state) {
    // ğŸ¯ ä¿®å¤ï¼šæ·»åŠ é˜²å¾¡æ€§æ£€æŸ¥ï¼Œç¡®ä¿indicatorå¯¹è±¡å®Œå…¨åˆå§‹åŒ–
    if (indicator && indicator.config && 
        indicator.config.debug && 
        indicator.config.debug.enableVerboseLogging) {
      Logger.debug('âœˆï¸ å§¿æ€ä»ªçŠ¶æ€å˜åŒ–:', state);
    }
  },
  onDataUpdate: function(data) {
    // ğŸ”§ å‡å°‘æ—¥å¿—é¢‘ç‡ï¼šåªåœ¨æ•°æ®æœ‰æ˜¾è‘—å˜åŒ–æ—¶è®°å½•
    if (!indicator || !indicator.lastLoggedData || 
        Math.abs(data.pitch - (indicator.lastLoggedData.pitch || 0)) > 2 ||
        Math.abs(data.roll - (indicator.lastLoggedData.roll || 0)) > 2) {
      // ğŸ¯ ä¿®å¤ï¼šæ·»åŠ é˜²å¾¡æ€§æ£€æŸ¥
      if (indicator && indicator.config && 
          indicator.config.debug && 
          indicator.config.debug.enableVerboseLogging) {
        Logger.debug('âœˆï¸ å§¿æ€ä»ªæ•°æ®æ›´æ–°:', data);
      }
      if (indicator) {
        indicator.lastLoggedData = data;
      }
    }
    
    // ğŸ¯ æ›´æ–°é¡µé¢dataï¼Œè®©WXMLèƒ½æ˜¾ç¤ºå®æ—¶çš„PITCHå’ŒROLLæ•°å€¼
    if (currentPage && currentPage.setData) {
      currentPage.setData({
        pitch: -data.pitch,
        roll: data.roll
      });
    }
  },
  onError: function(error) {
    Logger.error('âŒ å§¿æ€ä»ªé”™è¯¯:', error);
  }
});</pre>
            </div>
        </div>
    </div>
</body>
</html>