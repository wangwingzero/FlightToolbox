---
inclusion: always
---

# Google AI 搜索规范（避坑优先）

> 道家思维：知道什么不能做，比知道什么能做更重要。

## 核心原则

**不搜"最佳实践"，搜"常见错误"**

- 避开所有的坑，剩下的就是正确的路
- 失败案例比成功案例更有教育意义
- 先知其不可为，方能有所为

## 搜索查询格式

### ✅ 避坑查询（推荐）

```
「{技术} 常见错误和反模式，有哪些坑要避免？」
「{功能} 失败案例，什么情况会出问题？」
「{问题} 不要这样做，有哪些 bad practices？」
「微信小程序 {功能} 常见问题和解决方案」
```

### ❌ 普通查询（避免）

```
「{技术} 最佳实践」
「{功能} 教程」
「{问题} 怎么做」
```

## 触发场景

| 场景 | 避坑查询示例 |
|------|-------------|
| UI/UX 设计 | 「微信小程序 {组件} 常见 UI 问题和用户投诉」 |
| 架构设计 | 「{模式} 常见的设计错误和反模式」 |
| 小程序性能 | 「微信小程序 {功能} 性能问题和内存泄漏原因」 |
| 分包策略 | 「微信小程序分包加载失败的常见原因」 |
| 离线存储 | 「微信小程序离线缓存数据丢失的原因」 |
| 音频处理 | 「微信小程序 InnerAudioContext 常见 bug 和 iOS 兼容问题」 |
| 代码模式 | 「JavaScript ES5 {功能} 常见错误」 |
| Bug 排查 | 「{错误信息} 常见原因和解决方案」 |
| Vant 组件 | 「Vant Weapp {组件} 常见问题和坑」 |

## 示例对比

| 场景 | 避坑查询 ✅ | 普通查询 ❌ |
|------|-----------|-----------|
| 分包预加载 | 「微信小程序分包预加载失败有哪些常见原因？」 | 「微信小程序分包预加载最佳实践」 |
| 音频播放 | 「微信小程序 InnerAudioContext 在 iOS 上有哪些已知 bug？」 | 「微信小程序音频播放教程」 |
| 离线缓存 | 「微信小程序 Storage 数据丢失的常见原因？」 | 「微信小程序离线缓存最佳实践」 |
| setData | 「微信小程序 setData 性能问题和常见错误」 | 「微信小程序 setData 优化」 |

## 工作流程

1. **开始前**：识别技术决策点 → 搜索常见错误和反模式
2. **实现中**：遇到问题 → 搜索失败案例和解决方案
3. **完成后**：回顾是否踩了已知的坑

## 项目特定避坑要点

### 离线优先
- **必须考虑**：网络请求失败时的降级方案
- **常见错误**：假设网络总是可用

### ES5 兼容性
- **禁止使用**：let/const、箭头函数、模板字符串、async/await
- **常见错误**：忘记转换 ES6 语法

### 音频功能
- **iOS 特有问题**：自动播放限制、后台播放中断
- **常见错误**：不在 onUnload 中 destroy() InnerAudioContext

### 内存管理
- **必须清理**：定时器、事件监听、音频实例
- **常见错误**：onUnload 中遗漏资源清理

## 搜索技巧

1. **使用自然语言提问**，像和人对话一样
2. **加上"常见错误"、"反模式"、"坑"**等关键词
3. **说明具体场景**让搜索结果更精准
4. **针对小程序特性**，搜索时加上「微信小程序」限定
