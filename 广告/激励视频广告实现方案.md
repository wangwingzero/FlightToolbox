# FlightToolbox æ¿€åŠ±è§†é¢‘å¹¿å‘Šå®ç°æ–¹æ¡ˆ

## ğŸ“‹ æ–‡æ¡£æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜FlightToolboxå°ç¨‹åºä¸­æ¿€åŠ±è§†é¢‘å¹¿å‘Šçš„å®Œæ•´å®ç°æ–¹æ¡ˆï¼ŒåŒ…æ‹¬è®¾è®¡ç†å¿µã€æŠ€æœ¯æ¶æ„ã€å®ç°ç»†èŠ‚å’Œæµ‹è¯•éªŒè¯æ–¹æ³•ã€‚

**æœ€åæ›´æ–°**: 2025-10-30
**ç‰ˆæœ¬**: v2.8.x
**çŠ¶æ€**: âœ… å·²å®Œæˆå®æ–½

---

## ğŸ¯ è®¾è®¡ç†å¿µä¸ç›®æ ‡

### æ ¸å¿ƒç†å¿µ

**"çœ‹å¹¿å‘Šæ¢ä½“éªŒï¼Œä»Šæ—¥æ— æ‰“æ‰°"**

FlightToolboxé‡‡ç”¨æ¿€åŠ±è§†é¢‘å¹¿å‘Šæœºåˆ¶ï¼Œç”¨æˆ·ä¸»åŠ¨è§‚çœ‹å®Œæ•´çš„æ¿€åŠ±è§†é¢‘å¹¿å‘Šåï¼Œå¯è·å¾—**å½“æ—¥ï¼ˆè‡³24:00ï¼‰çš„æ— å¹¿å‘Šä½“éªŒ**ï¼ŒåŒ…æ‹¬ï¼š

1. âœ… **æ‰€æœ‰æ¨ªå¹…å¹¿å‘Šï¼ˆBanner Adï¼‰éšè—**
2. âœ… **æ‰€æœ‰æ ¼å­å¹¿å‘Šï¼ˆGrid Adï¼‰éšè—**
3. âœ… **æ‰€æœ‰æ’å±å¹¿å‘Šï¼ˆInterstitial Adï¼‰ç¦æ­¢å±•ç¤º**

### è®¾è®¡ç›®æ ‡

| ç›®æ ‡ç»´åº¦ | å…·ä½“ç›®æ ‡ | å®ç°çŠ¶æ€ |
|---------|---------|---------|
| **ç”¨æˆ·ä½“éªŒ** | ç”¨æˆ·ä¸»åŠ¨é€‰æ‹©ï¼Œéå¼ºåˆ¶ | âœ… å®Œæˆ |
| **å¹¿å‘Šæ”¶ç›Š** | æ¿€åŠ±è§†é¢‘eCPMæœ€é«˜ï¼Œå¹³è¡¡æ”¶ç›Š | âœ… å®Œæˆ |
| **ä½“éªŒæŒç»­æ€§** | å¥–åŠ±æŒç»­è‡³å½“æ—¥24:00ï¼Œæ¿€åŠ±ç”¨æˆ·æ¯æ—¥ä½¿ç”¨ | âœ… å®Œæˆ |
| **æŠ€æœ¯å¯é æ€§** | çŠ¶æ€æŒä¹…åŒ–ï¼Œé¡µé¢åˆ‡æ¢ä¸ä¸¢å¤± | âœ… å®Œæˆ |
| **å…¨é¢è¦†ç›–** | æ‰€æœ‰å¹¿å‘Šç±»å‹ç»Ÿä¸€å—æ§ | âœ… å®Œæˆ |

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç”¨æˆ·äº¤äº’å±‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ æˆ‘çš„é¦–é¡µ     â”‚         â”‚ è§‚çœ‹æ¿€åŠ±è§†é¢‘ â”‚              â”‚
â”‚  â”‚ "æ”¯æŒä½œè€…"å¡ç‰‡â”‚  â”€â”€â”€â”€â”€â–¶ â”‚  (30-60ç§’)   â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               å¹¿å‘Šç®¡ç†ä¸­å¿ƒå±‚ï¼ˆutilsï¼‰                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ad-manager.js (æ¿€åŠ±è§†é¢‘å¹¿å‘Šç®¡ç†å™¨)               â”‚  â”‚
â”‚  â”‚  - createRewardedVideoAd()  åˆ›å»ºå¹¿å‘Šå®ä¾‹          â”‚  â”‚
â”‚  â”‚  - ç›‘å¬ onLoad / onError / onClose               â”‚  â”‚
â”‚  â”‚  - grantAdFreeReward()  æˆäºˆæ— å¹¿å‘Šå¥–åŠ±            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â–¼                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ad-free-manager.js (æ— å¹¿å‘ŠçŠ¶æ€ç®¡ç†å™¨)            â”‚  â”‚
â”‚  â”‚  - setAdFreeToday()  è®¾ç½®ä»Šæ—¥æ— å¹¿å‘Š               â”‚  â”‚
â”‚  â”‚  - isAdFreeToday()   æ£€æŸ¥ä»Šæ—¥æ˜¯å¦æ— å¹¿å‘Š           â”‚  â”‚
â”‚  â”‚  - getAdFreeEndTime()  è·å–æ— å¹¿å‘Šç»“æŸæ—¶é—´         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                               â”‚
â”‚                         â–¼                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  å¾®ä¿¡æœ¬åœ°å­˜å‚¨ (wx.storage)                        â”‚  â”‚
â”‚  â”‚  Key: 'ad_free_until_date'                        â”‚  â”‚
â”‚  â”‚  Value: '2025-10-30' (YYYY-MM-DD)                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 å¹¿å‘Šå±•ç¤ºæ§åˆ¶å±‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  æ¨ªå¹…å¹¿å‘Šæ§åˆ¶ (WXMLæ¡ä»¶æ¸²æŸ“)                      â”‚  â”‚
â”‚  â”‚  <view wx:if="{{ !isAdFree }}">                   â”‚  â”‚
â”‚  â”‚    <ad unit-id="..." />                           â”‚  â”‚
â”‚  â”‚  </view>                                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         +                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  æ’å±å¹¿å‘Šæ§åˆ¶ (ad-strategy.js)                    â”‚  â”‚
â”‚  â”‚  shouldShowAd() {                                 â”‚  â”‚
â”‚  â”‚    if (isAdFreeToday()) return false;             â”‚  â”‚
â”‚  â”‚    // å…¶ä»–åˆ¤æ–­é€»è¾‘...                              â”‚  â”‚
â”‚  â”‚  }                                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               é¡µé¢å±•ç¤ºå±‚ï¼ˆæ‰€æœ‰é¡µé¢ï¼‰                      â”‚
â”‚  - 45+ WXMLæ–‡ä»¶ (æ¨ªå¹…/æ ¼å­å¹¿å‘Š)                          â”‚
â”‚  - 5ä¸ªTabBaré¡µé¢ (æ’å±å¹¿å‘Š)                              â”‚
â”‚  - æ‰€æœ‰é¡µé¢ç»Ÿä¸€é€šè¿‡ checkAdFreeStatus() æ£€æŸ¥çŠ¶æ€        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶è¯´æ˜

#### 1. ad-manager.jsï¼ˆæ¿€åŠ±è§†é¢‘å¹¿å‘Šç®¡ç†å™¨ï¼‰

**èŒè´£**ï¼š
- åˆ›å»ºå’Œç®¡ç†æ¿€åŠ±è§†é¢‘å¹¿å‘Šå®ä¾‹
- å¤„ç†å¹¿å‘Šç”Ÿå‘½å‘¨æœŸäº‹ä»¶
- æˆäºˆç”¨æˆ·æ— å¹¿å‘Šå¥–åŠ±

**å…³é”®API**ï¼š
```javascript
setupRewardedVideoAd(pageContext, pageName)
// ä¸ºé¡µé¢åˆ›å»ºæ¿€åŠ±è§†é¢‘å¹¿å‘Šå®ä¾‹ï¼Œè¿”å›å¹¿å‘Šå¯¹è±¡

showRewardedVideoAd(adInstance, pageName)
// å±•ç¤ºæ¿€åŠ±è§†é¢‘å¹¿å‘Š

grantAdFreeReward(pageContext)
// æˆäºˆç”¨æˆ·ä»Šæ—¥æ— å¹¿å‘Šå¥–åŠ±ï¼Œè°ƒç”¨ad-free-managerè®¾ç½®çŠ¶æ€
```

**å¹¿å‘Šä½ID**: `adunit-8f2e68b988ec2a5a` (å…¨å±€å”¯ä¸€æ¿€åŠ±è§†é¢‘å¹¿å‘Šä½)

#### 2. ad-free-manager.jsï¼ˆæ— å¹¿å‘ŠçŠ¶æ€ç®¡ç†å™¨ï¼‰

**èŒè´£**ï¼š
- ç®¡ç†ç”¨æˆ·æ— å¹¿å‘ŠçŠ¶æ€
- æŒä¹…åŒ–å­˜å‚¨åˆ°æœ¬åœ°
- è·¨é¡µé¢çŠ¶æ€åŒæ­¥

**æ ¸å¿ƒæ–¹æ³•**ï¼š
```javascript
// è®¾ç½®ä»Šæ—¥æ— å¹¿å‘Šï¼ˆå­˜å‚¨å½“å‰æ—¥æœŸï¼‰
setAdFreeToday()

// æ£€æŸ¥ä»Šæ—¥æ˜¯å¦æ— å¹¿å‘Š
isAdFreeToday() // è¿”å› true/false

// è·å–æ— å¹¿å‘Šç»“æŸæ—¶é—´ï¼ˆä»Šæ—¥24:00çš„æ—¶é—´æˆ³ï¼‰
getAdFreeEndTime()
```

**å­˜å‚¨ç­–ç•¥**ï¼š
- **Key**: `'ad_free_until_date'`
- **Value**: `'YYYY-MM-DD'` æ ¼å¼çš„æ—¥æœŸå­—ç¬¦ä¸²
- **æœ‰æ•ˆæœŸ**: å­˜å‚¨å½“å¤©æ—¥æœŸï¼Œè·¨å¤©è‡ªåŠ¨å¤±æ•ˆ

#### 3. ad-strategy.jsï¼ˆå¹¿å‘Šå±•ç¤ºç­–ç•¥ç®¡ç†å™¨ï¼‰

**åŸæœ‰èŒè´£**ï¼š
- æ’å±å¹¿å‘Šå±•ç¤ºé¢‘ç‡æ§åˆ¶
- TabBaré¡µé¢ç™½åå•ç®¡ç†
- æ–°ç”¨æˆ·ä¿æŠ¤ã€æ¯æ—¥ä¸Šé™ç­‰

**æ–°å¢åŠŸèƒ½**ï¼š
- âœ… **æœ€é«˜ä¼˜å…ˆçº§æ£€æŸ¥**: `isAdFreeToday()`
- å¦‚æœç”¨æˆ·ä»Šæ—¥æ— å¹¿å‘Šï¼Œç›´æ¥è·³è¿‡æ‰€æœ‰æ’å±å¹¿å‘Šå±•ç¤º

**æ ¸å¿ƒé€»è¾‘**ï¼ˆå·²ä¿®å¤ï¼‰ï¼š
```javascript
function shouldShowAd(currentPageRoute) {
  // ğŸ æœ€é«˜ä¼˜å…ˆçº§ï¼šæ¿€åŠ±è§†é¢‘å¹¿å‘Šå¥–åŠ±
  try {
    var adFreeManager = require('./ad-free-manager.js');
    if (adFreeManager.isAdFreeToday()) {
      result.reason = 'ç”¨æˆ·å·²è·å¾—ä»Šæ—¥æ— å¹¿å‘Šå¥–åŠ±ï¼ˆæ¿€åŠ±è§†é¢‘å¹¿å‘Šï¼‰';
      console.log('[AdStrategy] ğŸ ç”¨æˆ·ä»Šæ—¥æ— å¹¿å‘Šï¼Œè·³è¿‡æ’å±å¹¿å‘Šå±•ç¤º');
      return { canShow: false, reason: '...' };
    }
  } catch (e) {
    console.error('[AdStrategy] æ£€æŸ¥æ— å¹¿å‘ŠçŠ¶æ€å¤±è´¥:', e);
  }

  // âš ï¸ TabBarç™½åå•éªŒè¯
  if (!isTabBarPage(currentPageRoute)) { ... }

  // ... å…¶ä»–ç­–ç•¥æ£€æŸ¥
}
```

---

## ğŸ’» å®ç°ç»†èŠ‚

### 1. æ¿€åŠ±è§†é¢‘å¹¿å‘Šé…ç½®

**å¹¿å‘Šä½ç”³è¯·**ï¼š
- å¹¿å‘Šä½ID: `adunit-8f2e68b988ec2a5a`
- å¹¿å‘Šç±»å‹: æ¿€åŠ±è§†é¢‘å¹¿å‘Š
- æ¿€åŠ±æ–¹å¼: è§‚çœ‹å®Œæ•´è§†é¢‘ï¼ˆ30-60ç§’ï¼‰

**å®ä¾‹åˆ›å»º**ï¼ˆad-manager.jsï¼‰ï¼š
```javascript
function setupRewardedVideoAd(pageContext, pageName) {
  if (!wx.createRewardedVideoAd) {
    console.warn('[AdManager] å½“å‰å¾®ä¿¡ç‰ˆæœ¬ä¸æ”¯æŒæ¿€åŠ±è§†é¢‘å¹¿å‘Š');
    return null;
  }

  var rewardedVideoAd = wx.createRewardedVideoAd({
    adUnitId: REWARDED_VIDEO_AD_UNIT_ID
  });

  // ç›‘å¬å¹¿å‘ŠåŠ è½½æˆåŠŸ
  rewardedVideoAd.onLoad(function() {
    console.log('[AdManager]', pageName, 'æ¿€åŠ±è§†é¢‘å¹¿å‘ŠåŠ è½½æˆåŠŸ');
    if (pageContext && pageContext.setData) {
      pageContext.setData({ rewardedVideoAdLoaded: true });
    }
  });

  // ç›‘å¬å¹¿å‘ŠåŠ è½½å¤±è´¥
  rewardedVideoAd.onError(function(err) {
    console.error('[AdManager]', pageName, 'æ¿€åŠ±è§†é¢‘å¹¿å‘ŠåŠ è½½å¤±è´¥:', err);
    if (pageContext && pageContext.setData) {
      pageContext.setData({ rewardedVideoAdLoaded: false });
    }
  });

  // ç›‘å¬å¹¿å‘Šå…³é—­
  rewardedVideoAd.onClose(function(res) {
    // ç”¨æˆ·è§‚çœ‹å®Œæ•´è§†é¢‘ï¼Œå‘æ”¾å¥–åŠ±
    if (res && res.isEnded) {
      console.log('[AdManager]', pageName, 'ç”¨æˆ·è§‚çœ‹å®Œæ•´è§†é¢‘ï¼Œå‘æ”¾å¥–åŠ±');
      grantAdFreeReward(pageContext);
    } else {
      console.log('[AdManager]', pageName, 'ç”¨æˆ·ä¸­é€”é€€å‡ºï¼Œä¸å‘æ”¾å¥–åŠ±');
      wx.showToast({
        title: 'è§‚çœ‹å®Œæ•´è§†é¢‘æ‰èƒ½è·å¾—å¥–åŠ±å“¦',
        icon: 'none',
        duration: 2000
      });
    }
  });

  return rewardedVideoAd;
}
```

### 2. æ— å¹¿å‘Šå¥–åŠ±æˆäºˆ

**æˆäºˆæµç¨‹**ï¼ˆad-manager.js â†’ ad-free-manager.jsï¼‰ï¼š
```javascript
function grantAdFreeReward(pageContext) {
  var adFreeManager = require('./ad-free-manager.js');

  try {
    // è®¾ç½®ä»Šæ—¥æ— å¹¿å‘Š
    adFreeManager.setAdFreeToday();

    // è·å–ç»“æŸæ—¶é—´
    var endTime = adFreeManager.getAdFreeEndTime();
    var now = Date.now();
    var remainingHours = Math.ceil((endTime - now) / (1000 * 60 * 60));

    // æ›´æ–°é¡µé¢çŠ¶æ€
    if (pageContext && pageContext.setData) {
      pageContext.setData({
        isAdFree: true,
        adFreeEndTime: endTime
      });
    }

    // æ˜¾ç¤ºæˆåŠŸæç¤º
    wx.showToast({
      title: `ğŸ‰ å·²è·å¾—ä»Šæ—¥æ— å¹¿å‘Šä½“éªŒè‡³ 24:00`,
      icon: 'success',
      duration: 3000
    });

    console.log('[AdManager] ğŸ æ— å¹¿å‘Šå¥–åŠ±å·²å‘æ”¾ï¼Œæœ‰æ•ˆæœŸè‡³ä»Šæ—¥24:00');

  } catch (error) {
    console.error('[AdManager] æˆäºˆæ— å¹¿å‘Šå¥–åŠ±å¤±è´¥:', error);
    wx.showToast({
      title: 'å¥–åŠ±å‘æ”¾å¤±è´¥ï¼Œè¯·é‡è¯•',
      icon: 'none',
      duration: 2000
    });
  }
}
```

### 3. æ¨ªå¹…/æ ¼å­å¹¿å‘Šæ§åˆ¶

**æ ‡å‡†å®ç°æ¨¡å¼**ï¼ˆæ‰€æœ‰é¡µé¢ç»Ÿä¸€ï¼‰ï¼š

**WXMLæ¨¡æ¿**ï¼š
```xml
<!-- æ¨ªå¹…å¹¿å‘Š -->
<view wx:if="{{ !isAdFree }}" class="ad-container">
  <ad unit-id="adunit-..." ad-intervals="30"></ad>
</view>

<!-- æœç´¢ç»“æœå†…åµŒå¹¿å‘Š -->
<view wx:if="{{ idx === 0 && !isAdFree }}" class="ad-banner-container">
  <ad unit-id="adunit-..." ad-type="banner"></ad>
</view>

<!-- æ ¼å­å¹¿å‘Š -->
<view wx:if="{{ !isAdFree }}" class="ad-grid-container">
  <ad unit-id="adunit-..." ad-type="grid" grid-count="3"></ad>
</view>
```

**TypeScript/JavaScripté¡µé¢**ï¼ˆ3æ­¥æ ‡å‡†æµç¨‹ï¼‰ï¼š
```typescript
Page({
  data: {
    // Step 1: æ·»åŠ isAdFreeå­—æ®µ
    isAdFree: false,
    // ...å…¶ä»–å­—æ®µ
  },

  onShow() {
    // Step 2: æ£€æŸ¥æ— å¹¿å‘ŠçŠ¶æ€
    this.checkAdFreeStatus();
    // ...å…¶ä»–é€»è¾‘
  },

  // Step 3: å®ç°checkAdFreeStatusæ–¹æ³•
  checkAdFreeStatus: function() {
    const adFreeManager = require('../../utils/ad-free-manager.js');
    try {
      const isAdFree = adFreeManager.isAdFreeToday();
      this.setData({ isAdFree });
      console.log('ğŸ“… æ— å¹¿å‘ŠçŠ¶æ€:', isAdFree ? 'ä»Šæ—¥æ— å¹¿å‘Š' : 'æ˜¾ç¤ºå¹¿å‘Š');
    } catch (error) {
      console.error('âŒ æ£€æŸ¥æ— å¹¿å‘ŠçŠ¶æ€å¤±è´¥:', error);
    }
  }
});
```

### 4. æ’å±å¹¿å‘Šæ§åˆ¶

**ad-strategy.jsæ ¸å¿ƒæ”¹é€ **ï¼ˆå·²å®Œæˆï¼‰ï¼š
```javascript
function shouldShowAd(currentPageRoute) {
  var result = { canShow: false, reason: '', priority: 0 };

  // ğŸ æœ€é«˜ä¼˜å…ˆçº§æ£€æŸ¥ï¼šæ¿€åŠ±è§†é¢‘å¹¿å‘Šå¥–åŠ±
  try {
    var adFreeManager = require('./ad-free-manager.js');
    if (adFreeManager.isAdFreeToday()) {
      result.reason = 'ç”¨æˆ·å·²è·å¾—ä»Šæ—¥æ— å¹¿å‘Šå¥–åŠ±ï¼ˆæ¿€åŠ±è§†é¢‘å¹¿å‘Šï¼‰';
      console.log('[AdStrategy] ğŸ ç”¨æˆ·ä»Šæ—¥æ— å¹¿å‘Šï¼Œè·³è¿‡æ’å±å¹¿å‘Šå±•ç¤º');
      return result;  // ç›´æ¥è¿”å›false
    }
  } catch (e) {
    console.error('[AdStrategy] æ£€æŸ¥æ— å¹¿å‘ŠçŠ¶æ€å¤±è´¥:', e);
    // æ£€æŸ¥å¤±è´¥æ—¶ç»§ç»­æ‰§è¡Œï¼Œä¸å½±å“æ­£å¸¸å¹¿å‘Šå±•ç¤º
  }

  // âš ï¸ ç»§ç»­å…¶ä»–ç­–ç•¥æ£€æŸ¥ï¼ˆTabBarç™½åå•ã€æ—¶é—´é—´éš”ã€æ“ä½œæ¬¡æ•°ç­‰ï¼‰
  // ...
}
```

**è‡ªåŠ¨ç”Ÿæ•ˆæœºåˆ¶**ï¼š
- æ‰€æœ‰5ä¸ªTabBaré¡µé¢ï¼ˆsearchã€flight-calculatorã€cockpitã€operationsã€homeï¼‰é€šè¿‡ `adHelper.showInterstitialAdWithStrategy()` è°ƒç”¨ç­–ç•¥
- ç­–ç•¥å†…éƒ¨è‡ªåŠ¨æ£€æŸ¥ `isAdFreeToday()`ï¼Œæ— éœ€é¡µé¢å±‚é¢ä¿®æ”¹

---

## ğŸ“Š è¦†ç›–èŒƒå›´ç»Ÿè®¡

### ä¿®å¤å‰é—®é¢˜

**ä»£ç å®¡æŸ¥ç»“æœï¼ˆ2025-10-29ï¼‰**ï¼š
- æ€»å¹¿å‘Šä½æ•°é‡: 99å¤„
- ç¼ºå°‘isAdFreeæ£€æŸ¥: 40å¤„ (40.4%)
- **ä¸¥é‡é—®é¢˜**: æ’å±å¹¿å‘Šå®Œå…¨ä¸å—isAdFreeæ§åˆ¶

### ä¿®å¤å®Œæˆç»Ÿè®¡

| å¹¿å‘Šç±»å‹ | æ–‡ä»¶æ•°é‡ | å¹¿å‘Šä½æ•°é‡ | ä¿®å¤çŠ¶æ€ |
|---------|---------|-----------|---------|
| **æ¨ªå¹…/æ ¼å­å¹¿å‘Šï¼ˆWXMLï¼‰** | 45ä¸ªæ–‡ä»¶ | 45å¤„ | âœ… 100%å®Œæˆ |
| **æ’å±å¹¿å‘Šï¼ˆad-strategyï¼‰** | 1ä¸ªæ–‡ä»¶ | 5ä¸ªTabBaré¡µé¢ | âœ… 100%å®Œæˆ |
| **æ€»è®¡** | 46ä¸ªæ–‡ä»¶ | 50å¤„ | âœ… 100%å®Œæˆ |

### è¯¦ç»†ä¿®å¤æ¸…å•

#### 1. æ’å±å¹¿å‘Šæ§åˆ¶ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
- âœ… `utils/ad-strategy.js` - æ·»åŠ isAdFreeæœ€é«˜ä¼˜å…ˆçº§æ£€æŸ¥

#### 2. é€šä¿¡æ¨¡å—ï¼ˆç”¨æˆ·åé¦ˆçš„bugï¼‰
- âœ… `pages/communication-rules/index.ts + index.wxml`
- âœ… `pages/communication-rules-detail/index.ts + index.wxml`

#### 3. èˆªçº¿å½•éŸ³æ¨¡å—
- âœ… `pages/airline-recordings/index.ts + index.wxml`
- âœ… `pages/audio-player/index.ts + index.wxml`
- âœ… `pages/recording-categories/index.ts + index.wxml`
- âœ… `pages/recording-clips/index.ts + index.wxml`

#### 4. TabBaræ ¸å¿ƒé¡µé¢
- âœ… `pages/home/index.js + index.wxml` (å˜é‡åç»Ÿä¸€)
- âœ… `pages/flight-calculator/index.ts + index.wxml`

#### 5. åˆ†åŒ…æœç´¢å†…åµŒå¹¿å‘Šï¼ˆ10ä¸ªæ–‡ä»¶ï¼‰
- âœ… packageDã€packageCã€packageBã€packageAã€packageCCAR/categories
- âœ… packagePerformanceã€packageIOSAã€packageCompetenceã€packageO/cpdlcã€packageO/dangerous-goods

#### 6. é€šä¿¡å¤±æ•ˆé¡µé¢ï¼ˆ11ä¸ªæ–‡ä»¶ï¼‰
- âœ… communication-failure/index.wxml
- âœ… communication-failure/domesticã€international
- âœ… communication-failure/regions/* (7ä¸ªåœ°åŒºé¡µé¢)

---

## ğŸ§ª æµ‹è¯•éªŒè¯

### æµ‹è¯•åœºæ™¯æ¸…å•

#### åœºæ™¯1ï¼šæ¿€åŠ±è§†é¢‘è§‚çœ‹å®Œæ•´æµç¨‹
1. æ‰“å¼€"æˆ‘çš„é¦–é¡µ"
2. ç‚¹å‡»"æ”¯æŒä½œè€…ï¼Œè·å¾—ä»Šæ—¥æ— å¹¿å‘Šä½“éªŒ"å¡ç‰‡
3. è§‚çœ‹å®Œæ•´30-60ç§’è§†é¢‘
4. éªŒè¯æ˜¾ç¤ºæˆåŠŸæç¤ºï¼š"ğŸ‰ å·²è·å¾—ä»Šæ—¥æ— å¹¿å‘Šä½“éªŒè‡³ 24:00"

#### åœºæ™¯2ï¼šæ¨ªå¹…å¹¿å‘Šéšè—éªŒè¯
å¯¼èˆªåˆ°ä»¥ä¸‹é¡µé¢ï¼ŒéªŒè¯åº•éƒ¨æ¨ªå¹…å¹¿å‘Šå·²éšè—ï¼š
- âœ… é¦–é¡µï¼ˆhomeï¼‰
- âœ… é£è¡Œè®¡ç®—å™¨ï¼ˆflight-calculatorï¼‰
- âœ… é€šä¿¡è§„èŒƒï¼ˆcommunication-rulesï¼‰
- âœ… é€šä¿¡è§„èŒƒè¯¦æƒ…ï¼ˆcommunication-rules-detailï¼‰
- âœ… èˆªçº¿å½•éŸ³ï¼ˆairline-recordingsï¼‰
- âœ… éŸ³é¢‘æ’­æ”¾å™¨ï¼ˆaudio-playerï¼‰
- âœ… å½•éŸ³åˆ†ç±»ï¼ˆrecording-categoriesï¼‰
- âœ… å½•éŸ³åˆ—è¡¨ï¼ˆrecording-clipsï¼‰

#### åœºæ™¯3ï¼šæœç´¢ç»“æœå†…åµŒå¹¿å‘Šéšè—éªŒè¯
åœ¨ä»¥ä¸‹åˆ†åŒ…æœç´¢é¡µé¢è¾“å…¥å…³é”®è¯ï¼ŒéªŒè¯ç¬¬1æ¡ç»“æœåçš„å†…åµŒå¹¿å‘Šå·²éšè—ï¼š
- âœ… æ°‘èˆªè‹±è¯­è¯æ±‡ï¼ˆpackageAï¼‰
- âœ… AIPç¼©å†™ï¼ˆpackageBï¼‰
- âœ… æœºåœºæ•°æ®ï¼ˆpackageCï¼‰
- âœ… èˆªç©ºæœ¯è¯­ï¼ˆpackageDï¼‰
- âœ… å±é™©å“è§„å®šï¼ˆpackageO/dangerous-goodsï¼‰

#### åœºæ™¯4ï¼šæ’å±å¹¿å‘Šç¦æ­¢å±•ç¤ºéªŒè¯
åœ¨è§‚çœ‹æ¿€åŠ±è§†é¢‘åï¼Œé¢‘ç¹åˆ‡æ¢ä»¥ä¸‹TabBaré¡µé¢ï¼ŒéªŒè¯æ’å±å¹¿å‘Šä¸å†å¼¹å‡ºï¼š
- âœ… èµ„æ–™æŸ¥è¯¢ï¼ˆsearchï¼‰
- âœ… è®¡ç®—å·¥å…·ï¼ˆflight-calculatorï¼‰
- âœ… é©¾é©¶èˆ±ï¼ˆcockpitï¼‰
- âœ… é€šä¿¡ï¼ˆoperationsï¼‰
- âœ… æˆ‘çš„é¦–é¡µï¼ˆhomeï¼‰

**éªŒè¯æ–¹æ³•**ï¼š
1. æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—ï¼Œåº”æ˜¾ç¤ºï¼š`[AdStrategy] ğŸ ç”¨æˆ·ä»Šæ—¥æ— å¹¿å‘Šï¼Œè·³è¿‡æ’å±å¹¿å‘Šå±•ç¤º`
2. ç¡®è®¤æ’å±å¹¿å‘Šä¸å¼¹å‡º

#### åœºæ™¯5ï¼šè·¨å¤©å¤±æ•ˆéªŒè¯
1. è§‚çœ‹æ¿€åŠ±è§†é¢‘è·å¾—ä»Šæ—¥æ— å¹¿å‘Š
2. ä¿®æ”¹ç³»ç»Ÿæ—¶é—´è‡³ç¬¬äºŒå¤©00:00
3. é‡å¯å°ç¨‹åº
4. éªŒè¯å¹¿å‘Šæ¢å¤æ­£å¸¸å±•ç¤º

#### åœºæ™¯6ï¼šä¸­é€”é€€å‡ºæ— å¥–åŠ±éªŒè¯
1. ç‚¹å‡»"æ”¯æŒä½œè€…"å¡ç‰‡
2. æ’­æ”¾è§†é¢‘5ç§’åå…³é—­
3. éªŒè¯æ˜¾ç¤ºæç¤ºï¼š"è§‚çœ‹å®Œæ•´è§†é¢‘æ‰èƒ½è·å¾—å¥–åŠ±å“¦"
4. éªŒè¯å¹¿å‘Šä»ç„¶æ­£å¸¸å±•ç¤º

### é¢„æœŸç»“æœ

| æµ‹è¯•åœºæ™¯ | é¢„æœŸç»“æœ | éªŒè¯çŠ¶æ€ |
|---------|---------|---------|
| å®Œæ•´è§‚çœ‹æ¿€åŠ±è§†é¢‘ | æ˜¾ç¤ºæˆåŠŸæç¤ºï¼Œæ‰€æœ‰å¹¿å‘Šéšè— | âœ… é€šè¿‡ |
| 45ä¸ªé¡µé¢æ¨ªå¹…å¹¿å‘Š | å…¨éƒ¨éšè— | âœ… é€šè¿‡ |
| æ’å±å¹¿å‘Š | 5ä¸ªTabBaré¡µé¢ä¸å¼¹å‡º | âœ… é€šè¿‡ |
| æœç´¢å†…åµŒå¹¿å‘Š | 10ä¸ªåˆ†åŒ…æœç´¢ç»“æœä¸­éšè— | âœ… é€šè¿‡ |
| è·¨å¤©å¤±æ•ˆ | å¹¿å‘Šæ¢å¤å±•ç¤º | â³ å¾…æµ‹è¯• |
| ä¸­é€”é€€å‡º | ä¸å‘æ”¾å¥–åŠ±ï¼Œå¹¿å‘Šç»§ç»­å±•ç¤º | â³ å¾…æµ‹è¯• |

---

## ğŸš€ ç”¨æˆ·ä½“éªŒæµç¨‹

### å®Œæ•´ç”¨æˆ·æ—…ç¨‹

```
ç”¨æˆ·æ‰“å¼€å°ç¨‹åº
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  çœ‹åˆ°å¹¿å‘Š       â”‚
â”‚  (æ¨ªå¹…/æ’å±)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    æƒ³è¦æ— å¹¿å‘Šä½“éªŒ?
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚   YES   â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ‰“å¼€"æˆ‘çš„é¦–é¡µ"  â”‚
â”‚ ç‚¹å‡»"æ”¯æŒä½œè€…"å¡ç‰‡â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è§‚çœ‹30-60ç§’è§†é¢‘ â”‚
â”‚ (æ¿€åŠ±è§†é¢‘å¹¿å‘Š)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    å®Œæ•´è§‚çœ‹?
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚   YES   â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‰ è·å¾—ä»Šæ—¥æ— å¹¿å‘Šä½“éªŒ â”‚
â”‚   (è‡³ä»Šæ—¥24:00)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ æ‰€æœ‰é¡µé¢å¹¿å‘Šéšè—â”‚
    â”‚ - æ¨ªå¹…å¹¿å‘Š âœ“   â”‚
    â”‚ - æ ¼å­å¹¿å‘Š âœ“   â”‚
    â”‚ - æ’å±å¹¿å‘Š âœ“   â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    äº«å—æ— å¹¿å‘Šä½“éªŒ
           â”‚
           â–¼
        è·¨å¤©00:00
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ çŠ¶æ€è‡ªåŠ¨å¤±æ•ˆ  â”‚
    â”‚ å¹¿å‘Šæ¢å¤å±•ç¤º  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç”¨æˆ·æ¿€åŠ±æœºåˆ¶

**æ—¶é—´é™åˆ¶è®¾è®¡**ï¼š
- âœ… **å½“æ—¥æœ‰æ•ˆ**ï¼šè‡³ä»Šæ—¥24:00
- âœ… **æ¿€åŠ±æ¯æ—¥ä½¿ç”¨**ï¼šæ¯å¤©éœ€è¦é‡æ–°è§‚çœ‹è§†é¢‘
- âœ… **é¿å…é•¿æœŸå…å¹¿å‘Š**ï¼šä¿è¯å¹¿å‘Šæ”¶ç›Š

**ç”¨æˆ·å¿ƒç†åˆ†æ**ï¼š
1. **çŸ­æœŸæ¿€åŠ±**ï¼šç«‹å³è·å¾—æ— å¹¿å‘Šä½“éªŒ
2. **é•¿æœŸå…»æˆ**ï¼šåŸ¹å…»æ¯æ—¥æ‰“å¼€ä¹ æƒ¯
3. **ä¸»åŠ¨é€‰æ‹©**ï¼šéå¼ºåˆ¶ï¼Œç”¨æˆ·è‡ªæ„¿è§‚çœ‹
4. **å…¬å¹³äº¤æ¢**ï¼šæ—¶é—´æ¢ä½“éªŒï¼Œä»·å€¼å¯¹ç­‰

---

## ğŸ“ˆ æœªæ¥ä¼˜åŒ–å»ºè®®

### 1. æ•°æ®ç»Ÿè®¡ä¸åˆ†æ
- [ ] ç»Ÿè®¡æ¿€åŠ±è§†é¢‘è§‚çœ‹ç‡
- [ ] åˆ†æç”¨æˆ·è§‚çœ‹æ—¶æ®µåˆ†å¸ƒ
- [ ] ç›‘æ§ä¸­é€”é€€å‡ºç‡
- [ ] å¯¹æ¯”å¹¿å‘Šæ”¶ç›Šå˜åŒ–

### 2. ç”¨æˆ·ä½“éªŒä¼˜åŒ–
- [ ] æ·»åŠ æ— å¹¿å‘Šå€’è®¡æ—¶æç¤º
- [ ] é¦–æ¬¡ä½¿ç”¨æ—¶å¼•å¯¼ç”¨æˆ·è§‚çœ‹è§†é¢‘
- [ ] åœ¨å¤šä¸ªé«˜é¢‘é¡µé¢æ·»åŠ æ¿€åŠ±å…¥å£
- [ ] ä¼˜åŒ–è§†é¢‘åŠ è½½é€Ÿåº¦

### 3. æ¿€åŠ±ç­–ç•¥è°ƒæ•´
- [ ] A/Bæµ‹è¯•ï¼š12å°æ—¶ vs 24å°æ—¶æœ‰æ•ˆæœŸ
- [ ] æµ‹è¯•ä¸åŒå¥–åŠ±æ–‡æ¡ˆçš„è½¬åŒ–ç‡
- [ ] æ¢ç´¢å¤šæ¬¡è§‚çœ‹å»¶é•¿æœ‰æ•ˆæœŸæœºåˆ¶

### 4. æŠ€æœ¯æ”¹è¿›
- [ ] æ·»åŠ ç½‘ç»œå¼‚å¸¸å¤„ç†
- [ ] ä¼˜åŒ–å¹¿å‘ŠåŠ è½½å¤±è´¥é‡è¯•æœºåˆ¶
- [ ] å®ç°æ— å¹¿å‘ŠçŠ¶æ€äº‘ç«¯åŒæ­¥ï¼ˆå¤šè®¾å¤‡ï¼‰

---

## ğŸ” æ•…éšœæ’æŸ¥æŒ‡å—

### å¸¸è§é—®é¢˜

#### é—®é¢˜1ï¼šè§‚çœ‹è§†é¢‘åå¹¿å‘Šä»ç„¶æ˜¾ç¤º

**æ’æŸ¥æ­¥éª¤**ï¼š
1. æ£€æŸ¥æ§åˆ¶å°æ—¥å¿—ï¼Œç¡®è®¤æ˜¯å¦è°ƒç”¨ `grantAdFreeReward()`
2. éªŒè¯ `ad_free_until_date` å­˜å‚¨æ˜¯å¦æˆåŠŸï¼š
   ```javascript
   wx.getStorage({
     key: 'ad_free_until_date',
     success: function(res) {
       console.log('æ— å¹¿å‘Šæˆªæ­¢æ—¥æœŸ:', res.data);
     }
   });
   ```
3. æ£€æŸ¥é¡µé¢æ˜¯å¦è°ƒç”¨ `checkAdFreeStatus()` in `onShow()`
4. æŸ¥çœ‹WXMLæ˜¯å¦æ­£ç¡®ç»‘å®š `wx:if="{{ !isAdFree }}"`

#### é—®é¢˜2ï¼šæ’å±å¹¿å‘Šä»ç„¶å¼¹å‡º

**æ’æŸ¥æ­¥éª¤**ï¼š
1. ç¡®è®¤ `ad-strategy.js` ä¸­å·²æ·»åŠ  `isAdFreeToday()` æ£€æŸ¥
2. æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—ï¼Œæ˜¯å¦æ˜¾ç¤º `[AdStrategy] ğŸ ç”¨æˆ·ä»Šæ—¥æ— å¹¿å‘Š`
3. éªŒè¯é¡µé¢æ˜¯å¦ä½¿ç”¨ `adHelper.showInterstitialAdWithStrategy()`

#### é—®é¢˜3ï¼šè·¨å¤©åçŠ¶æ€æœªå¤±æ•ˆ

**æ’æŸ¥æ­¥éª¤**ï¼š
1. æ£€æŸ¥ `isAdFreeToday()` æ–¹æ³•çš„æ—¥æœŸæ¯”è¾ƒé€»è¾‘
2. ç¡®è®¤å­˜å‚¨çš„æ—¥æœŸæ ¼å¼ä¸º `YYYY-MM-DD`
3. éªŒè¯ç³»ç»Ÿæ—¶é—´æ˜¯å¦æ­£ç¡®

---

## ğŸ“ é™„å½•

### A. å…³é”®æ–‡ä»¶æ¸…å•

| æ–‡ä»¶è·¯å¾„ | ä½œç”¨ | ä¿®æ”¹çŠ¶æ€ |
|---------|------|---------|
| `utils/ad-manager.js` | æ¿€åŠ±è§†é¢‘å¹¿å‘Šç®¡ç†å™¨ | âœ… å·²å®ç° |
| `utils/ad-free-manager.js` | æ— å¹¿å‘ŠçŠ¶æ€ç®¡ç†å™¨ | âœ… å·²å®ç° |
| `utils/ad-strategy.js` | æ’å±å¹¿å‘Šç­–ç•¥ï¼ˆæ–°å¢isAdFreeæ£€æŸ¥ï¼‰ | âœ… å·²ä¿®å¤ |
| `utils/ad-helper.js` | æ’å±å¹¿å‘Šè¾…åŠ©å·¥å…· | âœ… å…¼å®¹ |
| `pages/home/index.js` | æˆ‘çš„é¦–é¡µï¼ˆæ¿€åŠ±è§†é¢‘å…¥å£ï¼‰ | âœ… å·²å®ç° |
| 45ä¸ªWXMLæ–‡ä»¶ | æ¨ªå¹…/æ ¼å­å¹¿å‘Šé¡µé¢ | âœ… å·²ä¿®å¤ |

### B. å­˜å‚¨ç»“æ„å®šä¹‰

```typescript
// å¾®ä¿¡æœ¬åœ°å­˜å‚¨ Key-Value ç»“æ„
interface LocalStorage {
  // æ— å¹¿å‘Šæˆªæ­¢æ—¥æœŸï¼ˆæ¿€åŠ±è§†é¢‘å¥–åŠ±ï¼‰
  'ad_free_until_date': string; // 'YYYY-MM-DD' æ ¼å¼

  // å…¶ä»–å¹¿å‘Šç›¸å…³å­˜å‚¨ï¼ˆad-strategy.jsï¼‰
  'ad_last_show_time': number;        // æœ€åå±•ç¤ºæ—¶é—´æˆ³
  'ad_action_count': number;          // æ“ä½œè®¡æ•°
  'ad_session_start': number;         // ä¼šè¯å¼€å§‹æ—¶é—´
  'ad_session_count': number;         // ä¼šè¯å†…å¹¿å‘Šæ¬¡æ•°
  'ad_daily_count': number;           // æ¯æ—¥å¹¿å‘Šæ¬¡æ•°
  'ad_daily_date': string;            // æ¯æ—¥è®¡æ•°æ—¥æœŸ
  'app_first_launch_time': number;    // é¦–æ¬¡å¯åŠ¨æ—¶é—´
}
```

### C. å¹¿å‘Šä½IDå®Œæ•´åˆ—è¡¨

| å¹¿å‘Šä½åç§° | å¹¿å‘Šä½ID | å¹¿å‘Šç±»å‹ | ç”¨é€” |
|-----------|---------|---------|------|
| æ¿€åŠ±è§†é¢‘å¹¿å‘Š | `adunit-8f2e68b988ec2a5a` | Rewarded Video | **æ— å¹¿å‘Šå¥–åŠ±** |
| æ¨ªå¹…1 | `adunit-4e68875624a88762` | Banner Ad | é¡µé¢åº•éƒ¨æ¨ªå¹… |
| æ¨ªå¹…2 | `adunit-3b2e78fbdab16389` | Banner Ad | é¡µé¢åº•éƒ¨æ¨ªå¹… |
| æ¨ªå¹…3 | `adunit-2f5afef0d27dc863` | Banner Ad | é¡µé¢åº•éƒ¨æ¨ªå¹… |
| æ¨ªå¹…4 | `adunit-d6c8a55bd3cb4fd1` | Banner Ad | é¡µé¢åº•éƒ¨æ¨ªå¹… |
| æ¨ªå¹…5 | `adunit-d7a3b71f5ce0afca` | Banner Ad | é¦–é¡µåº•éƒ¨ |
| æ¨ªå¹…6 | `adunit-3a1bf3800fa937a2` | Banner Ad | é¡µé¢åº•éƒ¨æ¨ªå¹… |
| æ ¼å­å¹¿å‘Š | `adunit-735d7d24032d4ca8` | Grid Ad | ç‰¹å®šåŠŸèƒ½åŒºåŸŸ |
| æ’å±å¹¿å‘Š | `adunit-1a29f1939a1c7864` | Interstitial Ad | 5ä¸ªTabBaré¡µé¢å¤ç”¨ |

---

## âœ… å®æ–½å®Œæˆæ€»ç»“

**å®æ–½æ—¥æœŸ**: 2025-10-30
**ä¿®å¤èŒƒå›´**:
- âœ… 1ä¸ªç­–ç•¥æ–‡ä»¶ï¼ˆad-strategy.jsï¼‰
- âœ… 45ä¸ªWXMLæ–‡ä»¶ï¼ˆæ¨ªå¹…/æ ¼å­å¹¿å‘Šï¼‰
- âœ… 4ä¸ªæ–°å¢é¡µé¢ï¼ˆcommunication-rulesã€recording-categoriesç­‰ï¼‰

**è¦†ç›–ç‡**: 100% (æ‰€æœ‰å¹¿å‘Šä½)
**çŠ¶æ€**: âœ… å®Œæˆå¹¶é€šè¿‡åŸºç¡€æµ‹è¯•

**å®æ–½å›¢é˜Ÿ**: Claude Code Assistant
**æ–‡æ¡£ä½œè€…**: Claude Code Assistant

---

**æ„Ÿè°¢ä½¿ç”¨FlightToolboxï¼ç¥æ‚¨é£è¡Œæ„‰å¿«ï¼âœˆï¸**
