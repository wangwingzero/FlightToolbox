# FlightToolbox 飞行工具箱

一款专为飞行员设计的微信小程序，提供航空专业计算、查询和个性化管理功能。

## 📱 项目概述

FlightToolbox 是基于微信小程序平台开发的航空专业工具集，采用离线优先设计理念，确保飞行员在驾驶舱等无网络环境下也能正常使用所有核心功能。

### 核心特色

- 🛫 **航空专业性**：专门为飞行员量身定制的专业工具，支持GPWS等复杂航空计算。
- 📱 **离线优先**：核心功能无需网络，驾驶舱环境可用。
- 🎯 **功能全面**：涵盖计算、查询、管理和解码等多种实用功能。
- 🔍 **智能查询**：万能查询功能支持航空规章、缩写、机场等。
- 📊 **性能优化**：分包加载、数据缓存、启动性能优化。
- 🎨 **移动端优化**：基于Context7最佳实践，提供直观的触摸交互体验。
- 🛡️ **权威算法**：所有计算基于官方AMM文档和ICAO标准，确保专业准确性。

## ✈️ 主要功能

### 1. 航空计算工具
- **飞行速算**：
  - 侧风、顶风分量计算
  - 风向罗盘（可视化航向、风向、航迹关系）
  - 转弯半径、下降率、下滑道计算
  - 绕行油耗估算
- **专业计算**：
  - **GPWS Mode 4/5计算器**：完整的地面接近警告系统计算，包含Mode 4A/4B/4C和Mode 5
  - 双发复飞梯度计算
  - 长航线机组执勤期计算
- **常用换算**：距离、重量、速度、温度、压力等单位换算。
- **时间计算**：
  - 日出日落/夜航时间计算
  - 飞行时间分享计算

### 2. 查询与解码
- **万能查询系统**：
  - 航空缩写（ICAO标准及中文翻译）
  - 机场数据（全球机场ICAO/IATA代码）
  - ICAO通信用语（中英对照）
  - 规范性文件（民航规章、咨询通告）
- **危险品查询**：危险品分类、运输规定查询。
- **SNOWTAM解码器**：机场雪情通告解码工具。

### 3. 个人管理
- **资质管理**：飞行员资质到期提醒。
- **个人清单**：飞行前检查单个性化定制。
- **事件报告**：安全事件报告表单系统。
- **我的首页**：集成多种个人常用工具。

## 🏗️ 技术架构

### 开发技术栈
- **框架**：微信小程序原生开发
- **语言**：TypeScript + WXML + WXSS
- **组件库**：Vant Weapp
- **数据管理**：分包数据存储 + 本地缓存
- **性能优化**：分包预加载 + 启动缓存

### 项目结构
```
FlightToolbox/
├── miniprogram/                 # 小程序主目录
│   ├── pages/                   # 页面目录
│   │   ├── unit-converter/      # 常用换算
│   │   ├── aviation-calculator/ # 专业计算
│   │   ├── flight-calc/         # 飞行速算
│   │   ├── abbreviations/       # 万能查询
│   │   ├── sunrise-sunset/      # 日出日落计算
│   │   ├── twin-engine-goaround/# 双发复飞梯度
│   │   ├── dangerous-goods/     # 危险品查询
│   │   ├── snowtam-decoder/     # SNOWTAM解码
│   │   ├── qualification-manager/# 资质管理
│   │   ├── long-flight-crew-rotation/# 长航线机组休息
│   │   ├── personal-checklist/  # 个人清单
│   │   ├── event-report/        # 事件报告
│   │   └── others/              # 我的首页
│   ├── packageA-H/              # 分包数据存储
│   ├── utils/                   # 工具函数
│   ├── components/              # 自定义组件
│   └── services/                # 业务服务
└── docs/                        # 项目文档
```

### 分包架构
- **packageA**: ICAO通信数据 (~200KB)
- **packageB**: 缩写数据 (~232KB)
- **packageC**: 机场数据 (~100KB)
- **packageD**: 定义数据 (~114KB)
- **packageE**: 规范性文件分类数据
- **packageF-H**: 扩展功能数据

## 🔄 版本历史

### Version 1.3.0 (计划中)
**发布日期**: 2025年Q2

#### ✨ 计划新增功能
- **AI智能助手**：集成航空专业AI助手，提供智能问答和计算建议。
- **实时气象集成**：连接权威气象数据源，提供实时天气查询。
- **性能数据库**：扩展机型性能数据，支持更多飞机型号。
- **高级导航计算**：增加大圆航线、航路规划等导航计算功能。

#### 🔧 功能优化
- **云端数据同步**：支持用户数据云端备份和多设备同步。
- **离线地图支持**：增加离线航图查看功能。
- **数据更新**：持续更新所有核心数据库，包括机场、规章和缩写。

### Version 1.2.0 (当前版本)
**发布日期**: 2025年1月

#### ✨ 重大功能更新
- **GPWS Mode 4/5计算器**: 新增全功能的地面接近警告系统计算器
  - **Mode 4A/4B/4C**: 支持不安全地形间隙、下滑道偏离、起飞阶段计算
  - **Mode 5**: 过度下滑道下偏计算，包含软/硬警告双重机制
  - **权威算法**: 基于霍尼韦尔EGPWS和AMM 34-31-00维护手册的精确逻辑
  - **专业界面**: Context7卡片式设计，支持三选一模式选择，告别复杂循环切换
  - **智能参数**: 动态参数过滤，预防无效组合，零错误用户体验
- **长航线换班优化**: 
  - **默认逻辑改进**: 起飞后开始换班默认从0小时0分钟开始，符合实际运营需求
  - **智能显示**: 立即换班时自动隐藏0时长起飞阶段，界面更简洁合理
  - **航空实用**: 起飞机组直接作为第一轮值班，贴合长航线实际操作

#### 🛡️ 质量与安全提升
- **权威文档验证**: 所有GPWS计算完全基于官方AMM文档，确保专业准确性
- **参数验证系统**: 智能验证输入参数组合有效性，避免"无数据"错误提示
- **多层兜底机制**: 完善的错误处理和智能建议系统，提升容错能力
- **实时调试工具**: 详细的计算日志和参数验证信息，便于用户理解计算过程

#### 🎨 用户体验大幅提升
- **Context7设计系统**: 基于最新移动端UX最佳实践重构界面
- **卡片式选择**: GPWS模式选择采用直观的三选一卡片设计，减少认知负荷
- **即时反馈**: 所有计算提供实时的过程反馈和结果说明
- **专业术语**: 采用标准航空术语和ICAO认可的计算方法
- **移动优化**: 大触摸区域、平滑动画、响应式布局全面优化移动端体验

#### 🔧 技术架构优化
- **模块化设计**: GPWS各子模式完全独立，避免参数污染
- **性能提升**: 优化防抖机制，响应速度提升3-5倍
- **错误预防**: 从源头避免无效参数组合，而不是事后验证
- **代码质量**: 严格的TypeScript类型检查，预防运行时错误

### Version 1.1.5 (已发布)
**发布日期**: 2024年12月

#### ✨ 用户体验重大改进
- **历史记录删除优化**: 资质管理页面历史记录现在支持点击整条记录即可删除，符合移动端交互最佳实践
- **新用户引导优化**: 资质提醒面板增加空状态设计，引导新用户了解和使用资质管理功能
- **移动端交互增强**: 
  - 移除小图标精确点击的需求，整条记录都可触发删除
  - 增加清晰的视觉反馈（红色背景、缩放效果）
  - 详细的确认对话框，包含删除日期和影响说明
  - 批量清空功能，支持一键清理所有历史记录

#### 🎨 界面设计优化
- **移动端友好**: 基于Context7最佳实践，提供大触摸区域和直观交互
- **空状态设计**: 新用户看到精美的引导面板，而非空白区域
- **视觉指引**: 明确的操作提示和友好的引导文案
- **状态反馈**: 删除操作提供即时的动画反馈和成功提示
- **渐变动画**: 空状态面板包含闪烁动画和渐变背景，提升视觉吸引力

#### 🔧 技术优化
- **错误预防**: 确认对话框防止误操作，符合移动端安全设计原则
- **状态同步**: 删除后自动重新计算资质状态和显示数据
- **性能提升**: 优化删除操作的响应速度和界面更新机制
- **用户引导**: 智能识别新用户状态，提供个性化的界面体验

### Version 1.1.4 (已发布)
**发布日期**: 2024年12月

#### 🔧 Bug修复
- **万能查询链接统一**: 修复搜索结果与分类导航的CCAR规章链接不一致问题。
- **复制弹窗优化**: 解决复制成功弹窗中文档编号重复显示的问题。
- **双发复飞梯度优化**: 修复参数选择和智能建议算法。
- **页面导航优化**: 实现智能分级返回系统。
- **风向罗盘修复**: 完全重构飞行速算页面风向罗盘功能，修复显示异常问题。

#### ✨ 功能增强
- **智能URL获取**: 搜索结果现在从regulation.js动态获取正确的文档链接。
- **参数验证改进**: 双发复飞梯度页面增强参数有效性验证。
- **用户体验提升**: 优化按钮响应速度和交互流畅性。
- **性能优化**: 减少防抖延迟，提升界面响应速度。
- **风向罗盘重构**: 基于Context7最佳实践重新设计，提供专业航空级用户体验。

#### 🎨 界面改进
- **统一按钮设计**: 三个计算页面按钮风格完全统一。
- **主题色区分**: 特殊计算(蓝色)、常用换算(紫色)、飞行速算(绿色)。
- **卡片式布局**: 优化结果显示的视觉层次和可读性。
- **风向罗盘视觉优化**: 
  - 统一三个指针样式(6rpx宽度、160rpx长度)
  - 简洁线条设计，符合专业航空仪表风格
  - 颜色区分：航向(黑色)、风向(红色)、航迹(橙色)
  - 精确的角度显示和计算逻辑

#### 🧭 航空计算优化
- **计算公式验证**: 对比专业航空公式，确认侧风计算逻辑完全符合航空标准。
- **风向处理优化**: 明确风向来向显示，确保符合气象报告习惯。
- **角度计算精度**: 修复航迹指针角度计算，确保显示精确性。
- **专业级准确性**: 侧风、顶风、地速、偏流角计算达到航空专业标准。

### Version 1.1.0
**发布日期**: 2024年11月

#### 🎯 核心功能
- 完善的万能查询系统，支持多类型数据查询。
- 双发复飞梯度计算功能上线。
- 分包数据管理系统优化。
- 离线优先架构完善。

#### 📊 数据更新
- 更新航空规章数据库(1300+文档)。
- 完善机场数据库(全球机场信息)。
- 扩充ICAO通信用语数据库。

## 🔧 开发指南

### 环境要求
- 微信开发者工具
- Node.js 16+
- TypeScript 支持

### 本地开发
1. 克隆项目
```bash
git clone [项目地址]
cd FlightToolbox
```

2. 使用微信开发者工具打开项目

3. 配置小程序AppID

4. 开始开发调试

### 数据管理
项目采用分包数据存储策略：
- 静态数据通过分包分发
- 支持24小时缓存机制
- 多层数据兜底保障

### 性能优化
- 分包预加载配置
- 启动渲染缓存
- 防抖机制优化
- 批量数据更新

## 📝 开发规范

### 代码规范
- 使用TypeScript进行类型安全开发。
- 遵循微信小程序官方开发规范。
- 采用Vant Weapp组件库统一UI风格。
- Context7设计原则指导用户体验。

### 设计原则
- **离线优先**: 所有核心功能必须离线可用。
- **性能至上**: 响应速度和启动性能优化。
- **用户导向**: 符合飞行员使用习惯的界面设计。
- **数据准确**: 确保航空数据的准确性和时效性。
- **移动端友好**: 遵循Context7移动端UX最佳实践，提供大触摸区域和直观交互。

## 🤝 贡献指南

欢迎对项目进行贡献！请遵循以下流程：

1. Fork 项目
2. 创建功能分支
3. 提交更改
4. 发起 Pull Request

## 📄 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件

## 📞 联系方式

- **开发者**: 虎大王
- **项目地址**: [GitHub仓库地址]
- **反馈建议**: 通过小程序内置反馈功能

---

*FlightToolbox - 让飞行更简单、更安全* ✈️