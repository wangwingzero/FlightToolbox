# 验证和回滚指南

**文档版本**: v1.0
**创建日期**: 2025-11-01
**适用范围**: 所有优化阶段
**重要等级**: ⭐⭐⭐⭐⭐

---

## 📋 文档概述

本文档提供完整的验证清单和回滚方案，确保每个优化阶段都能安全实施和快速恢复。

**适用场景**：
- ✅ 每个优化阶段完成后的验证
- ✅ 真机测试前的预验证
- ✅ 发现问题时的快速回滚
- ✅ 生产环境部署前的最终验证

---

## 🎯 验证流程总览

每个优化阶段都需要经过以下5级验证：

```
第1级：编译验证（必须）
  ↓
第2级：功能验证（必须）
  ↓
第3级：离线验证（必须）
  ↓
第4级：真机验证（必须）
  ↓
第5级：长期运行验证（可选）
```

**验证原则**：
- 🚨 任何一级验证失败，立即停止，排查或回滚
- 🚨 不能跳过任何验证级别
- 🚨 真机验证必须包含Android和iOS
- 🚨 离线验证是最关键的验证项

---

## 📊 阶段1验证清单

### 第1级：编译验证

```powershell
# 1. 清理编译缓存
cd D:\FlightToolbox
Remove-Item -Recurse -Force miniprogram\.miniprogram -ErrorAction SilentlyContinue

# 2. 微信开发者工具中点击"编译"
# 3. 检查控制台输出

# 4. 验证无错误
# 预期：编译成功，无红色错误

# 5. 检查主包大小
# 微信开发者工具 -> 详情 -> 代码大小分析
# 预期：主包大小 < 2MB（阶段1后约2286-2386KB）
```

**验证通过标准**：
- ✅ 编译成功，无JavaScript语法错误
- ✅ 编译成功，无WXML/WXSS错误
- ✅ 主包大小减少约312-412KB
- ✅ 控制台无warn（可忽略deprecation警告）

### 第2级：功能验证

#### 2.1 GPS功能验证（最关键）

```
测试步骤：
1. 进入驾驶舱页面
2. 观察GPS信息显示区域

验证项：
✅ GPS地速显示为整数（如：235 kt）
✅ GPS高度显示为整数（如：35000 ft）
✅ GPS坐标正常显示（如：39.9042° N, 116.4074° E）
✅ GPS数据实时更新（每秒更新）
✅ 数据无平滑处理（快速晃动设备，数值立即跳变）

❌ 失败标准：
- GPS数据不更新
- GPS数据显示为小数（说明被平滑了）
- GPS坐标为0或异常值
```

#### 2.2 指南针功能验证

```
测试步骤：
1. 进入驾驶舱页面
2. 旋转设备（水平面旋转）

验证项：
✅ 指南针航向实时响应设备旋转
✅ 航向角度准确（0-360°）
✅ Canvas指南针图形正常渲染
✅ 北方标记（N）指向正确

❌ 失败标准：
- 指南针不转动
- 航向角度异常或不变
- Canvas不显示
```

#### 2.3 姿态仪功能验证

```
测试步骤：
1. 进入驾驶舱页面
2. 倾斜设备（前后、左右）

验证项：
✅ 俯仰角实时响应前后倾斜（-90° 到 +90°）
✅ 滚转角实时响应左右倾斜（-180° 到 +180°）
✅ Canvas姿态仪图形正常渲染
✅ 地平线准确显示
✅ 校准功能正常工作

❌ 失败标准：
- 姿态仪不响应设备倾斜
- 角度值异常或不变
- Canvas不显示
- 校准功能失效
```

#### 2.4 通信数据验证（阶段1.2相关）

```
测试步骤：
1. 进入"通信"TabBar页面
2. 点击相关功能入口

验证项：
✅ 通信规则数据正常加载
✅ 标准用语数据正常加载
✅ 数据搜索功能正常
✅ 数据筛选功能正常
✅ 页面显示无异常

❌ 失败标准：
- 数据不显示或加载失败
- 搜索/筛选功能异常
- 页面报错
```

#### 2.5 航线录音验证（阶段1.3相关）

```
测试步骤：
1. 进入"通信" → "航线录音"
2. 点击任意地区（如"日本"）

验证项：
✅ 地区列表快速显示（32个国家/地区）
✅ 点击地区后音频列表正常加载
✅ 音频数量正确
✅ 音频标题、文本、翻译正常显示

❌ 失败标准：
- 地区列表不显示
- 点击地区后无响应或报错
- 音频数量不正确
```

### 第3级：离线验证（最关键）

#### 3.1 开启飞行模式

```
测试步骤：
1. 在微信开发者工具模拟器中
   工具 → 模拟器设置 → 网络 → 离线

2. 或在真机上：
   设置 → 飞行模式 → 开启
```

#### 3.2 离线模式验证清单

```
验证步骤：
1. 重启小程序（完全关闭后重新打开）
2. 逐项验证以下功能

核心功能验证：
✅ 驾驶舱GPS功能正常（使用设备定位）
✅ 驾驶舱指南针功能正常
✅ 驾驶舱姿态仪功能正常
✅ 通信规则数据正常加载（从缓存）
✅ 标准用语数据正常加载（从缓存）
✅ 航线录音地区列表正常显示
✅ 所有TabBar导航正常

❌ 失败标准（任何一项失败都必须修复）：
- 页面白屏或无法访问
- 数据加载失败
- 功能报错
- 提示"网络错误"
```

### 第4级：真机验证

#### 4.1 Android真机验证

**测试设备要求**：至少2台不同品牌

```
推荐测试设备：
- 华为 Mate/P系列
- 小米 或 红米
- OPPO
- vivo

测试流程：
1. 微信开发者工具 → 真机调试
2. 扫码连接Android设备
3. 重复第2级功能验证
4. 重复第3级离线验证

Android特别验证项：
✅ GPS权限申请正常
✅ 传感器权限申请正常
✅ 音频播放正常（无杂音）
✅ 页面渲染正常（无布局错乱）
✅ 触摸交互流畅
```

#### 4.2 iOS真机验证

**测试设备要求**：iPhone 11及以上，iOS 14及以上

```
推荐测试设备：
- iPhone 11 / 12 / 13 / 14
- iOS 14 / 15 / 16 / 17

测试流程：
1. 微信开发者工具 → 真机调试
2. 扫码连接iOS设备
3. 重复第2级功能验证
4. 重复第3级离线验证

iOS特别验证项：
✅ GPS权限申请正常（iOS权限弹窗）
✅ 传感器数据正常（iOS传感器特性）
✅ 音频播放正常（iOS音频兼容性）
✅ 页面渲染正常（SafeArea适配）
✅ 触摸交互流畅
```

### 第5级：长期运行验证（可选）

```
测试目的：
验证长时间运行的稳定性

测试流程：
1. 进入驾驶舱页面
2. 保持页面打开30分钟
3. 观察以下指标

验证项：
✅ GPS数据持续更新，无中断
✅ 指南针持续更新，无延迟
✅ 姿态仪持续更新，无卡顿
✅ 内存占用稳定，无泄漏
✅ CPU占用正常（< 30%）
✅ 无崩溃、无卡死
✅ 电池消耗正常

监控工具：
- 微信开发者工具 → 性能监控
- 真机：设置 → 电池 → 电池使用情况
```

---

## 📊 阶段2验证清单

### 第1级：编译验证

```powershell
# 同阶段1编译验证流程

# 额外检查：
# 1. 验证新增分包
Get-ChildItem D:\FlightToolbox\miniprogram -Directory |
  Where-Object { $_.Name -like 'package*' } |
  Select-Object Name

# 应该包含：
# - packageCommFailure
# - packageAudioPages
# - packageAudioData

# 2. 验证app.json配置
Select-String -Path D:\FlightToolbox\miniprogram\app.json -Pattern "communicationFailurePackage|audioNavigationPackage|audioDataPackage"
```

**验证通过标准**：
- ✅ 编译成功
- ✅ 主包减少约615KB（相比阶段1）
- ✅ 新增3个分包配置正确

### 第2级：功能验证

#### 2.1 通信失效功能验证

```
测试步骤：
1. 进入"通信"TabBar页面
2. 点击"通信失效"
3. 测试所有子页面

验证项：
✅ 通信失效主页面正常显示
✅ "国内"页面正常跳转和显示
✅ "国际"页面正常跳转和显示
✅ 8个地区页面（太平洋、欧洲等）正常跳转
✅ 国家详情页正常显示
✅ 数据加载正常（9个地区数据文件）
✅ 页面间跳转流畅，无延迟

❌ 失败标准：
- 任何页面404或白屏
- 页面跳转失败
- 数据不显示
- 路由错误
```

#### 2.2 航线录音功能验证

```
测试步骤：
1. 进入"通信" → "航线录音"
2. 点击任意地区（如"日本"）
3. 点击任意音频片段
4. 播放音频

验证项：
✅ 地区列表正常显示（32个国家/地区）
✅ 点击地区后音频列表正常加载
✅ 音频片段数量正确
✅ 点击音频后播放器页面正常打开
✅ 音频正常播放
✅ 播放/暂停切换正常
✅ 进度条更新正常
✅ 音频文本和翻译正常显示

❌ 失败标准：
- 地区列表不显示
- 音频列表加载失败
- 音频无法播放
- 播放器报错
```

#### 2.3 预加载机制验证

```javascript
// 在 pages/operations/index.ts 中添加验证代码
customOnLoad: function(options) {
  var self = this;

  // 检查分包预加载状态
  console.log('🔍 检查分包预加载状态...');

  var packagesToCheck = [
    'communicationFailurePackage',
    'audioNavigationPackage',
    'audioDataPackage'
  ];

  packagesToCheck.forEach(function(packageName) {
    wx.loadSubpackage({
      name: packageName,
      success: function() {
        console.log('✅', packageName, '已预加载');
      },
      fail: function() {
        console.log('❌', packageName, '未预加载');
      }
    });
  });
},
```

**验证通过标准**：
- ✅ 进入"通信"页面后，控制台显示3个分包都已预加载
- ✅ 点击功能入口无明显加载延迟

### 第3级：离线验证

```
离线测试流程：
1. 在线模式首次进入"通信"页面（触发预加载）
2. 退出小程序
3. 开启飞行模式
4. 重新进入小程序
5. 测试以下功能

验证项：
✅ 通信失效所有页面离线可访问
✅ 通信失效所有数据离线可用
✅ 航线录音地区列表离线可用
✅ 航线录音音频离线可播放
✅ 无"网络错误"提示
✅ 所有功能与在线模式一致

❌ 失败标准（必须修复）：
- 任何页面离线无法访问
- 数据加载失败
- 音频无法播放
```

### 第4级：真机验证

**Android和iOS真机验证流程同阶段1**

额外验证项：
```
✅ 通信失效所有页面在真机上正常
✅ 航线录音音频在真机上正常播放
✅ 音频播放无杂音、无卡顿
✅ 页面切换流畅
✅ 离线模式完全可用
```

---

## 📊 阶段3验证清单（如果执行）

### 第1级：编译验证

```powershell
# 同阶段1、2编译验证流程

# 额外检查驾驶舱分包
Test-Path D:\FlightToolbox\miniprogram\packageCockpit\modules\config.js
# 应该返回 True

# 检查主包modules目录
Get-ChildItem D:\FlightToolbox\miniprogram\pages\cockpit\modules -ErrorAction SilentlyContinue
# 应该无输出（所有模块已迁移）
```

**验证通过标准**：
- ✅ 编译成功
- ✅ 主包减少约550KB（相比阶段2）
- ✅ packageCockpit分包配置正确

### 第2级：功能验证

#### 2.1 驾驶舱启动时间验证（最关键）

```javascript
// 在 pages/cockpit/index.js 中验证
customOnLoad: function(options) {
  var startTime = Date.now();

  ModuleLoader.loadAllModules(function(modules) {
    var loadTime = Date.now() - startTime;

    console.log('⏱️ 驾驶舱模块加载耗时:', loadTime + 'ms');

    // ⚠️ 验证：必须 < 1000ms
    if (loadTime > 1000) {
      console.error('❌ 启动时间超标:', loadTime + 'ms');
    } else {
      console.log('✅ 启动时间合格:', loadTime + 'ms');
    }

    // ... 初始化驾驶舱
  });
},
```

**验证通过标准**：
- ✅ 首次加载时间 < 1000ms（1秒）
- ✅ 二次加载时间 < 200ms（使用缓存）

#### 2.2 驾驶舱核心功能验证（最关键）

```
⚠️ 这是阶段3最关键的验证项，必须100%通过

GPS功能验证：
✅ GPS地速正常显示（整数，无平滑）
✅ GPS高度正常显示（整数，无平滑）
✅ GPS坐标正常显示
✅ GPS数据实时更新（每秒）
✅ GPS欺骗检测正常工作

指南针功能验证：
✅ 指南针航向正常显示
✅ 指南针实时响应设备旋转
✅ Canvas渲染正常

姿态仪功能验证：
✅ 俯仰角正常显示和更新
✅ 滚转角正常显示和更新
✅ 姿态仪实时响应设备倾斜
✅ 校准功能正常工作
✅ Canvas渲染正常

传感器融合验证：
✅ 加速度计数据正常
✅ 陀螺仪数据正常
✅ 传感器融合算法正常运行
✅ 数据融合无延迟

❌ 失败标准（任何一项失败立即回滚）：
- GPS功能任何异常
- 指南针功能任何异常
- 姿态仪功能任何异常
- 传感器融合任何异常
- 启动时间 > 1秒
```

### 第3级：离线验证

```
离线测试流程（阶段3特别关键）：
1. 在线模式首次进入驾驶舱（预加载分包）
2. 退出小程序
3. 开启飞行模式
4. 重新进入小程序
5. 进入驾驶舱
6. 验证所有功能

验证项：
✅ 驾驶舱能够打开（模块从缓存加载）
✅ 启动时间 < 1秒
✅ GPS功能完全正常
✅ 指南针功能完全正常
✅ 姿态仪功能完全正常
✅ 无模块加载错误
✅ 无网络请求错误

❌ 失败标准（立即回滚）：
- 驾驶舱无法打开
- 模块加载失败
- 任何核心功能异常
```

### 第4级：真机验证

**真机验证是阶段3最关键的验证环节**

```
Android真机测试（必须）：
设备要求：至少3台不同品牌
测试时间：每台设备至少15分钟

测试流程：
1. 安装小程序
2. 首次进入驾驶舱（测试启动时间）
3. 验证所有功能（GPS、指南针、姿态仪）
4. 退出并重新进入（测试缓存机制）
5. 开启飞行模式测试
6. 长时间运行测试（30分钟）

验证项：
✅ 启动时间 < 1秒
✅ GPS地速、高度、坐标正常
✅ 指南针航向正常
✅ 姿态仪俯仰、滚转正常
✅ 离线模式所有功能正常
✅ 长时间运行稳定（无崩溃）
✅ 内存占用正常（无泄漏）

iOS真机测试（必须）：
设备要求：至少2台，iOS 14+
测试流程：同Android
额外验证：iOS传感器兼容性

验证项：
✅ iOS传感器数据正常
✅ iOS音频提示正常（如有）
✅ 其他项同Android
```

### 第5级：长期运行验证（必须）

**阶段3必须完成长期运行验证**

```
测试目的：
验证驾驶舱分包后的长期稳定性

测试流程：
1. Android真机
2. 进入驾驶舱
3. 保持页面打开60分钟
4. 每10分钟记录一次状态

监控指标：
✅ GPS数据持续更新，无中断
✅ 指南针持续更新，无延迟
✅ 姿态仪持续更新，无卡顿
✅ 内存占用稳定 < 150MB
✅ CPU占用 < 30%
✅ 无崩溃、无卡死
✅ 电池消耗正常

记录表格：
| 时间 | GPS | 指南针 | 姿态仪 | 内存(MB) | CPU(%) | 状态 |
|------|-----|-------|--------|---------|--------|------|
| 0分  | ✅  | ✅    | ✅     | 120     | 25     | 正常 |
| 10分 | ✅  | ✅    | ✅     | 125     | 26     | 正常 |
| 20分 | ✅  | ✅    | ✅     | 128     | 27     | 正常 |
| ...  | ... | ...   | ...    | ...     | ...    | ...  |

❌ 失败标准（立即回滚）：
- 任何功能中断
- 内存泄漏（持续增长）
- CPU占用过高（> 50%）
- 崩溃或卡死
```

---

## 🔄 快速回滚方案

### 回滚决策树

```
发现问题
  ↓
问题严重程度评估
  ├─ 轻微问题（不影响核心功能）→ 记录问题，继续测试
  ├─ 中等问题（影响部分功能）→ 尝试修复，如30分钟无法解决→回滚
  └─ 严重问题（核心功能失效）→ 立即回滚
```

### 回滚方案1：回滚到上一个阶段

#### 从阶段1回滚到优化前

```powershell
cd D:\FlightToolbox

# 1. 查看提交历史
git log --oneline

# 2. 找到阶段1之前的commit（backup: 优化前的代码快照）
# 假设commit hash是 abc1234

# 3. 回滚
git reset --hard abc1234

# 4. 重新编译
# 微信开发者工具 -> 编译

# 5. 验证功能正常
```

#### 从阶段2回滚到阶段1

```powershell
cd D:\FlightToolbox

# 1. 回滚到阶段1完成时的标签
git reset --hard v2.8.1-phase1

# 2. 重新编译
# 微信开发者工具 -> 编译

# 3. 验证阶段1功能正常
```

#### 从阶段3回滚到阶段2

```powershell
cd D:\FlightToolbox

# 1. 回滚到阶段2完成时的标签
git reset --hard v2.8.1-phase2

# 2. 重新编译
# 微信开发者工具 -> 编译

# 3. 验证阶段2功能正常
```

### 回滚方案2：选择性回滚（保留部分优化）

#### 仅回滚ND删除

```powershell
cd D:\FlightToolbox

# 1. 找到ND删除的commit
git log --oneline --grep="阶段1.1"

# 2. 回滚该commit
git revert <commit-hash>

# 3. 解决可能的冲突
git status
# 手动解决冲突文件

# 4. 提交回滚
git add .
git commit -m "回滚: 恢复ND模块"

# 5. 重新编译测试
```

#### 仅回滚通信失效分包

```powershell
cd D:\FlightToolbox

# 1. 找到通信失效分包的commit
git log --oneline --grep="阶段2.1"

# 2. 回滚该commit
git revert <commit-hash>

# 3. 解决冲突并提交
git add .
git commit -m "回滚: 恢复通信失效到主包"

# 4. 重新编译测试
```

#### 仅回滚驾驶舱分包

```powershell
cd D:\FlightToolbox

# 1. 找到驾驶舱分包的commit
git log --oneline --grep="阶段3.1"

# 2. 回滚该commit
git revert <commit-hash>

# 3. 解决冲突并提交
git add .
git commit -m "回滚: 恢复驾驶舱模块到主包"

# 4. ⚠️ 重要：验证GPS、姿态仪、指南针功能
```

### 回滚方案3：紧急回滚（生产环境）

**场景**：生产环境发现严重问题，需要立即回滚

```powershell
# 1. 立即切换到稳定分支
git checkout main

# 2. 回滚到最后一个稳定版本标签
git reset --hard v2.8.0  # 或最后一个确认稳定的版本

# 3. 强制推送（⚠️ 谨慎操作）
git push origin main --force

# 4. 重新构建小程序
# 微信开发者工具 -> 上传 -> 提交审核

# 5. 通知团队回滚情况
```

---

## 🔍 常见问题排查

### 问题1：GPS数据不更新

**症状**：
- GPS地速、高度、坐标不更新
- 或GPS数据为0

**排查步骤**：

```powershell
# 1. 检查gps-manager.js是否存在
cd D:\FlightToolbox\miniprogram

# 如果是阶段1-2
Test-Path pages\cockpit\modules\gps-manager.js  # 应该True

# 如果是阶段3
Test-Path packageCockpit\modules\gps-manager.js  # 应该True

# 2. 检查GPS初始化代码
Select-String -Path pages\cockpit\index.js -Pattern "initGPS|gpsManager"

# 3. 检查位置权限配置
Select-String -Path app.json -Pattern "requiredPrivateInfos" -Context 5,5

# 4. 查看控制台错误
# 微信开发者工具 -> 控制台
# 搜索 "GPS" 或 "location" 相关错误
```

**常见原因和解决方案**：

| 原因 | 解决方案 |
|------|---------|
| GPS模块未正确加载 | 检查模块路径，验证异步加载代码 |
| 位置权限未申请 | 检查app.json的requiredPrivateInfos配置 |
| 初始化顺序错误 | 调整模块加载顺序 |
| GPS数据被滤波 | 检查smart-filter.js是否被误启用 |

### 问题2：音频无法播放

**症状**：
- 点击播放按钮无反应
- 播放器报错

**排查步骤**：

```powershell
# 1. 检查3个核心配置文件
cd D:\FlightToolbox\miniprogram

Select-String -Path utils\audio-config.js -Pattern "loadRegionData"
Select-String -Path utils\audio-package-loader.js -Pattern "packageMapping"

# 如果是阶段2
Select-String -Path packageAudioPages\pages\audio-player\index.ts -Pattern "regionPathMap"

# 2. 检查数据文件
# 如果是阶段1
Test-Path data\regions\japan.js

# 如果是阶段2
Test-Path packageAudioData\data\regions\japan.js

# 3. 检查音频文件
Get-ChildItem packageJapan -Filter *.mp3 | Measure-Object
# 应该显示音频文件数量
```

**参考文档**：
`航线录音分包预加载规则记录/故障排查-音频无法播放.md`

### 问题3：分包加载失败

**症状**：
- 控制台显示分包加载失败
- 页面白屏或404

**排查步骤**：

```powershell
# 1. 检查app.json配置
Select-String -Path app.json -Pattern "subPackages" -Context 20,0

# 2. 检查分包目录是否存在
Test-Path packageCommFailure
Test-Path packageAudioPages
Test-Path packageCockpit

# 3. 检查分包页面文件
Get-ChildItem packageCommFailure\pages -Recurse -Filter index.wxml

# 4. 检查预加载规则
Select-String -Path app.json -Pattern "preloadRule" -Context 10,10
```

**常见原因和解决方案**：

| 原因 | 解决方案 |
|------|---------|
| 分包路径配置错误 | 检查app.json中的root和pages配置 |
| 分包文件缺失 | 验证所有页面文件已正确移动 |
| 预加载规则错误 | 检查preloadRule配置，确保页面路径正确 |
| 分包过大 | 检查单个分包是否超过2MB |

### 问题4：姿态仪不响应

**症状**：
- 倾斜设备，姿态仪不动
- 俯仰角、滚转角不变

**排查步骤**：

```powershell
# 1. 检查姿态仪模块
cd D:\FlightToolbox\miniprogram

# 阶段1-2
Test-Path pages\cockpit\modules\attitude-indicator.js
Test-Path pages\cockpit\modules\sensor-fusion-core.js

# 阶段3
Test-Path packageCockpit\modules\attitude-indicator.js
Test-Path packageCockpit\modules\sensor-fusion-core.js

# 2. 检查传感器模块
Test-Path pages\cockpit\modules\accelerometer-manager.js  # 或packageCockpit
Test-Path pages\cockpit\modules\gyroscope-manager.js      # 或packageCockpit

# 3. 查看控制台传感器数据
# 应该看到实时的加速度计和陀螺仪数据
```

**常见原因和解决方案**：

| 原因 | 解决方案 |
|------|---------|
| 传感器模块未加载 | 检查模块加载顺序和依赖 |
| Canvas未初始化 | 检查Canvas ID是否正确 |
| 传感器权限未授予 | 真机测试时授予传感器权限 |
| 模块初始化顺序错误 | 调整初始化顺序（先传感器，后姿态仪） |

---

## 📋 验证记录模板

### 阶段验证记录表

复制以下模板，填写验证结果：

```markdown
# 阶段X验证记录

**验证日期**: YYYY-MM-DD
**验证人员**: [姓名]
**阶段**: 阶段X
**预期收益**: XXX KB

---

## 第1级：编译验证

- [ ] 编译成功，无语法错误
- [ ] 主包大小减少约 XXX KB
- [ ] 实际主包大小: ___ KB
- [ ] 分包配置正确

**结果**: ✅ 通过 / ❌ 失败
**备注**:

---

## 第2级：功能验证

### GPS功能
- [ ] GPS地速正常显示（整数）
- [ ] GPS高度正常显示（整数）
- [ ] GPS坐标正常显示
- [ ] GPS数据实时更新

**结果**: ✅ 通过 / ❌ 失败

### 指南针功能
- [ ] 指南针航向正常显示
- [ ] 实时响应设备旋转

**结果**: ✅ 通过 / ❌ 失败

### 姿态仪功能
- [ ] 俯仰角正常显示和更新
- [ ] 滚转角正常显示和更新
- [ ] 校准功能正常

**结果**: ✅ 通过 / ❌ 失败

### 其他功能（根据阶段填写）
- [ ] 通信数据加载正常
- [ ] 航线录音功能正常
- [ ] 通信失效功能正常

**结果**: ✅ 通过 / ❌ 失败

---

## 第3级：离线验证

- [ ] 飞行模式下驾驶舱功能正常
- [ ] 飞行模式下数据加载正常
- [ ] 飞行模式下音频播放正常
- [ ] 无网络请求错误

**结果**: ✅ 通过 / ❌ 失败
**备注**:

---

## 第4级：真机验证

### Android真机
- 设备1: [品牌型号]
  - [ ] 功能验证通过
  - [ ] 离线验证通过
  - 启动时间: ___ ms

- 设备2: [品牌型号]
  - [ ] 功能验证通过
  - [ ] 离线验证通过
  - 启动时间: ___ ms

**结果**: ✅ 通过 / ❌ 失败

### iOS真机
- 设备1: [型号 iOS版本]
  - [ ] 功能验证通过
  - [ ] 离线验证通过
  - 启动时间: ___ ms

**结果**: ✅ 通过 / ❌ 失败

---

## 第5级：长期运行验证（如需要）

- 测试设备: [品牌型号]
- 测试时长: ___ 分钟
- [ ] GPS持续更新正常
- [ ] 指南针持续更新正常
- [ ] 姿态仪持续更新正常
- [ ] 无内存泄漏
- [ ] 无崩溃

**结果**: ✅ 通过 / ❌ 失败

---

## 总体评估

**本阶段验证结果**: ✅ 全部通过 / ⚠️ 部分通过 / ❌ 失败

**遇到的问题**:
1. [问题描述]
2. [问题描述]

**解决方案**:
1. [解决方法]
2. [解决方法]

**是否需要回滚**: 是 / 否

**下一步行动**:
- [ ] 继续下一阶段
- [ ] 修复问题后重新验证
- [ ] 回滚到上一阶段

**验证人签名**: _____________
**日期**: YYYY-MM-DD
```

---

## 📚 相关文档

- **实施文档**：
  - 阶段1-低风险快速优化.md
  - 阶段2-中等风险优化.md
  - 阶段3-驾驶舱分包(可选).md

- **技术文档**：
  - 技术参考和最佳实践.md
  - 航线录音分包预加载规则记录/

- **工具文档**：
  - 辅助脚本集.md

---

**文档创建时间**: 2025-11-01
**维护者**: FlightToolbox AI Assistant
**版本**: v1.0
